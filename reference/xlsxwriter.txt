================================================================
Directory Structure
================================================================
examples/
  array_formula.py
  autofilter.py
  autofit_manually.py
  autofit.py
  background.py
  cell_indentation.py
  chart_area.py
  chart_bar.py
  chart_clustered.py
  chart_column.py
  chart_combined.py
  chart_data_labels.py
  chart_data_table.py
  chart_data_tools.py
  chart_date_axis.py
  chart_doughnut.py
  chart_gauge.py
  chart_gradient.py
  chart_line.py
  chart_pareto.py
  chart_pattern.py
  chart_pie.py
  chart_radar.py
  chart_scatter.py
  chart_secondary_axis.py
  chart_stock.py
  chart_styles.py
  chart.py
  chartsheet.py
  check_close.py
  checkbox.py
  colors.py
  comments1.py
  comments2.py
  conditional_format.py
  context_manager.py
  data_validate.py
  datetimes.py
  defined_name.py
  demo.py
  diagonal_border.py
  django_simple.py
  doc_properties.py
  dynamic_arrays.py
  embedded_images.py
  headers_footers.py
  hello_world.py
  hide_row_col.py
  hide_sheet.py
  http_server.py
  hyperlink.py
  ignore_errors.py
  images_bytesio.py
  images.py
  inheritance1.py
  inheritance2.py
  lambda.py
  macros.py
  merge_rich_string.py
  merge1.py
  outline_collapsed.py
  outline.py
  pandas_autofilter.py
  pandas_chart_columns.py
  pandas_chart_line.py
  pandas_chart.py
  pandas_column_formats.py
  pandas_conditional_format.py
  pandas_datetime.py
  pandas_header_format.py
  pandas_multiple.py
  pandas_percentage.py
  pandas_positioning.py
  pandas_simple.py
  pandas_table.py
  panes.py
  polars_chart.py
  polars_checkbox.py
  polars_conditional_format.py
  polars_format_custom.py
  polars_format_default.py
  polars_multiple.py
  polars_positioning.py
  polars_simple.py
  polars_sparklines.py
  polars_xlsxwriter.py
  rich_strings.py
  right_to_left.py
  sensitivity_label.py
  sparklines1.py
  sparklines2.py
  tab_colors.py
  tables.py
  text_indent.py
  textbox.py
  tutorial1.py
  tutorial2.py
  tutorial3.py
  unicode_polish_utf8.py
  unicode_shift_jis.py
  unicode.py
  user_types1.py
  user_types2.py
  user_types3.py
  vba_extract.py
  watermark.py
  worksheet_protection.py

================================================================
Files
================================================================

================
File: examples/array_formula.py
================
#######################################################################
#
# Example of how to use Python and the XlsxWriter module to write
# simple array formulas.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create a new workbook and add a worksheet
workbook = xlsxwriter.Workbook("array_formula.xlsx")
worksheet = workbook.add_worksheet()
# Write some test data.
worksheet.write("B1", 500)
worksheet.write("B2", 10)
worksheet.write("B5", 1)
worksheet.write("B6", 2)
worksheet.write("B7", 3)
worksheet.write("C1", 300)
worksheet.write("C2", 15)
worksheet.write("C5", 20234)
worksheet.write("C6", 21003)
worksheet.write("C7", 10000)
# Write an array formula that returns a single value
worksheet.write_formula("A1", "{=SUM(B1:C1*B2:C2)}")
# Same as above but more verbose.
worksheet.write_array_formula("A2:A2", "{=SUM(B1:C1*B2:C2)}")
# Write an array formula that returns a range of values
worksheet.write_array_formula("A5:A7", "{=TREND(C5:C7,B5:B7)}")
workbook.close()

================
File: examples/autofilter.py
================
###############################################################################
#
# An example of how to create autofilters with XlsxWriter.
#
# An autofilter is a way of adding drop down lists to the headers of a 2D
# range of worksheet data. This allows users to filter the data based on
# simple criteria so that some data is shown and some is hidden.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("autofilter.xlsx")
# Add a worksheet for each autofilter example.
worksheet1 = workbook.add_worksheet()
worksheet2 = workbook.add_worksheet()
worksheet3 = workbook.add_worksheet()
worksheet4 = workbook.add_worksheet()
worksheet5 = workbook.add_worksheet()
worksheet6 = workbook.add_worksheet()
worksheet7 = workbook.add_worksheet()
# Add a bold format for the headers.
bold = workbook.add_format({"bold": 1})
# Open a text file with autofilter example data.
textfile = open("autofilter_data.txt", encoding="utf-8")
# Read the headers from the first line of the input file.
headers = textfile.readline().strip("\n").split()
# Read the text file and store the field data.
data = []
for line in textfile:
    # Split the input data based on whitespace.
    row_data = line.strip("\n").split()
    # Convert the number data from the text file.
    for i, item in enumerate(row_data):
        try:
            row_data[i] = float(item)
        except ValueError:
            pass
    data.append(row_data)
# Set up several sheets with the same data.
for worksheet in workbook.worksheets():
    # Make the columns wider.
    worksheet.set_column("A:D", 12)
    # Make the header row larger.
    worksheet.set_row(0, 20, bold)
    # Make the headers bold.
    worksheet.write_row("A1", headers)
###############################################################################
#
# Example 1. Autofilter without conditions.
#
# Set the autofilter.
worksheet1.autofilter("A1:D51")
row = 1
for row_data in data:
    worksheet1.write_row(row, 0, row_data)
    # Move on to the next worksheet row.
    row += 1
###############################################################################
#
#
# Example 2. Autofilter with a filter condition in the first column.
#
# Autofilter range using Row-Column notation.
worksheet2.autofilter(0, 0, 50, 3)
# Add filter criteria. The placeholder "Region" in the filter is
# ignored and can be any string that adds clarity to the expression.
worksheet2.filter_column(0, "Region == East")
# Hide the rows that don't match the filter criteria.
row = 1
for row_data in data:
    region = row_data[0]
    # Check for rows that match the filter.
    if region == "East":
        # Row matches the filter, no further action required.
        pass
    else:
        # We need to hide rows that don't match the filter.
        worksheet2.set_row(row, options={"hidden": True})
    worksheet2.write_row(row, 0, row_data)
    # Move on to the next worksheet row.
    row += 1
###############################################################################
#
#
# Example 3. Autofilter with a dual filter condition in one of the columns.
#
# Set the autofilter.
worksheet3.autofilter("A1:D51")
# Add filter criteria.
worksheet3.filter_column("A", "x == East or x == South")
# Hide the rows that don't match the filter criteria.
row = 1
for row_data in data:
    region = row_data[0]
    # Check for rows that match the filter.
    if region == "East" or region == "South":
        # Row matches the filter, no further action required.
        pass
    else:
        # We need to hide rows that don't match the filter.
        worksheet3.set_row(row, options={"hidden": True})
    worksheet3.write_row(row, 0, row_data)
    # Move on to the next worksheet row.
    row += 1
###############################################################################
#
#
# Example 4. Autofilter with filter conditions in two columns.
#
# Set the autofilter.
worksheet4.autofilter("A1:D51")
# Add filter criteria.
worksheet4.filter_column("A", "x == East")
worksheet4.filter_column("C", "x > 3000 and x < 8000")
# Hide the rows that don't match the filter criteria.
row = 1
for row_data in data:
    region = row_data[0]
    volume = int(row_data[2])
    # Check for rows that match the filter.
    if region == "East" and volume > 3000 and volume < 8000:
        # Row matches the filter, no further action required.
        pass
    else:
        # We need to hide rows that don't match the filter.
        worksheet4.set_row(row, options={"hidden": True})
    worksheet4.write_row(row, 0, row_data)
    # Move on to the next worksheet row.
    row += 1
###############################################################################
#
#
# Example 5. Autofilter with a filter list condition in one of the columns.
#
# Set the autofilter.
worksheet5.autofilter("A1:D51")
# Add filter criteria.
worksheet5.filter_column_list("A", ["East", "North", "South"])
# Hide the rows that don't match the filter criteria.
row = 1
for row_data in data:
    region = row_data[0]
    # Check for rows that match the filter.
    if region == "East" or region == "North" or region == "South":
        # Row matches the filter, no further action required.
        pass
    else:
        # We need to hide rows that don't match the filter.
        worksheet5.set_row(row, options={"hidden": True})
    worksheet5.write_row(row, 0, row_data)
    # Move on to the next worksheet row.
    row += 1
###############################################################################
#
#
# Example 6. Autofilter with filter for blanks.
#
# Create a blank cell in our test data.
# Set the autofilter.
worksheet6.autofilter("A1:D51")
# Add filter criteria.
worksheet6.filter_column("A", "x == Blanks")
# Simulate a blank cell in the data.
data[5][0] = ""
# Hide the rows that don't match the filter criteria.
row = 1
for row_data in data:
    region = row_data[0]
    # Check for rows that match the filter.
    if region == "":
        # Row matches the filter, no further action required.
        pass
    else:
        # We need to hide rows that don't match the filter.
        worksheet6.set_row(row, options={"hidden": True})
    worksheet6.write_row(row, 0, row_data)
    # Move on to the next worksheet row.
    row += 1
###############################################################################
#
#
# Example 7. Autofilter with filter for non-blanks.
#
# Set the autofilter.
worksheet7.autofilter("A1:D51")
# Add filter criteria.
worksheet7.filter_column("A", "x == NonBlanks")
# Hide the rows that don't match the filter criteria.
row = 1
for row_data in data:
    region = row_data[0]
    # Check for rows that match the filter.
    if region != "":
        # Row matches the filter, no further action required.
        pass
    else:
        # We need to hide rows that don't match the filter.
        worksheet7.set_row(row, options={"hidden": True})
    worksheet7.write_row(row, 0, row_data)
    # Move on to the next worksheet row.
    row += 1
workbook.close()

================
File: examples/autofit_manually.py
================
##############################################################################
#
# The following example demonstrates manually auto-fitting the the width of a
# column in Excel based on the maximum string width. The worksheet ``autofit()``
# method will do this automatically but occasionally you may need to control the
# maximum and minimum column widths yourself.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from functools import reduce
import xlsxwriter
from xlsxwriter.utility import cell_autofit_width
workbook = xlsxwriter.Workbook("autofit.xlsx")
worksheet = workbook.add_worksheet()
# Some string data to write.
cities = ["Addis Ababa", "Buenos Aires", "Cairo", "Dhaka"]
# Write the strings:
worksheet.write_column(0, 0, cities)
# Find the maximum column width in pixels.
max_width = reduce(max, map(cell_autofit_width, cities))
# Set the column width as if it was auto-fitted.
worksheet.set_column_pixels(0, 0, max_width)
workbook.close()

================
File: examples/autofit.py
================
#######################################################################
#
# An example of using simulated autofit to automatically adjust the width of
# worksheet columns based on the data in the cells.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from xlsxwriter.workbook import Workbook
workbook = Workbook("autofit.xlsx")
worksheet = workbook.add_worksheet()
# Write some worksheet data to demonstrate autofitting.
worksheet.write(0, 0, "Foo")
worksheet.write(1, 0, "Food")
worksheet.write(2, 0, "Foody")
worksheet.write(3, 0, "Froody")
worksheet.write(0, 1, 12345)
worksheet.write(1, 1, 12345678)
worksheet.write(2, 1, 12345)
worksheet.write(0, 2, "Some longer text")
worksheet.write(0, 3, "http://ww.google.com")
worksheet.write(1, 3, "https://github.com")
# Autofit the worksheet.
worksheet.autofit()
workbook.close()

================
File: examples/background.py
================
##############################################################################
#
# An example of setting a worksheet background image with the XlsxWriter
# Python module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create an new Excel file and add a worksheet.
workbook = xlsxwriter.Workbook("background.xlsx")
worksheet = workbook.add_worksheet()
# Set the background image.
worksheet.set_background("logo.png")
workbook.close()

================
File: examples/cell_indentation.py
================
##############################################################################
#
# A simple formatting example using XlsxWriter.
#
# This program demonstrates the indentation cell format.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("cell_indentation.xlsx")
worksheet = workbook.add_worksheet()
indent1 = workbook.add_format({"indent": 1})
indent2 = workbook.add_format({"indent": 2})
worksheet.set_column("A:A", 40)
worksheet.write("A1", "This text is indented 1 level", indent1)
worksheet.write("A2", "This text is indented 2 levels", indent2)
workbook.close()

================
File: examples/chart_area.py
================
#######################################################################
#
# An example of creating Excel Area charts with Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_area.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Number", "Batch 1", "Batch 2"]
data = [
    [2, 3, 4, 5, 6, 7],
    [40, 40, 50, 30, 25, 50],
    [30, 25, 30, 10, 5, 10],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
worksheet.write_column("C2", data[2])
#######################################################################
#
# Create an area chart.
#
chart1 = workbook.add_chart({"type": "area"})
# Configure the first series.
chart1.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure a second series. Note use of alternative syntax to define ranges.
chart1.add_series(
    {
        "name": ["Sheet1", 0, 2],
        "categories": ["Sheet1", 1, 0, 6, 0],
        "values": ["Sheet1", 1, 2, 6, 2],
    }
)
# Add a chart title and some axis labels.
chart1.set_title({"name": "Results of sample analysis"})
chart1.set_x_axis({"name": "Test number"})
chart1.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart1.set_style(11)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a stacked area chart sub-type.
#
chart2 = workbook.add_chart({"type": "area", "subtype": "stacked"})
# Configure the first series.
chart2.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart2.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title and some axis labels.
chart2.set_title({"name": "Stacked Chart"})
chart2.set_x_axis({"name": "Test number"})
chart2.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart2.set_style(12)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a percent stacked area chart sub-type.
#
chart3 = workbook.add_chart({"type": "area", "subtype": "percent_stacked"})
# Configure the first series.
chart3.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart3.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title and some axis labels.
chart3.set_title({"name": "Percent Stacked Chart"})
chart3.set_x_axis({"name": "Test number"})
chart3.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart3.set_style(13)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
workbook.close()

================
File: examples/chart_bar.py
================
#######################################################################
#
# An example of creating Excel Bar charts with Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_bar.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Number", "Batch 1", "Batch 2"]
data = [
    [2, 3, 4, 5, 6, 7],
    [10, 40, 50, 20, 10, 50],
    [30, 60, 70, 50, 40, 30],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
worksheet.write_column("C2", data[2])
#######################################################################
#
# Create a new bar chart.
#
chart1 = workbook.add_chart({"type": "bar"})
# Configure the first series.
chart1.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure a second series. Note use of alternative syntax to define ranges.
chart1.add_series(
    {
        "name": ["Sheet1", 0, 2],
        "categories": ["Sheet1", 1, 0, 6, 0],
        "values": ["Sheet1", 1, 2, 6, 2],
    }
)
# Add a chart title and some axis labels.
chart1.set_title({"name": "Results of sample analysis"})
chart1.set_x_axis({"name": "Test number"})
chart1.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart1.set_style(11)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a stacked chart sub-type.
#
chart2 = workbook.add_chart({"type": "bar", "subtype": "stacked"})
# Configure the first series.
chart2.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart2.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title and some axis labels.
chart2.set_title({"name": "Stacked Chart"})
chart2.set_x_axis({"name": "Test number"})
chart2.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart2.set_style(12)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a percentage stacked chart sub-type.
#
chart3 = workbook.add_chart({"type": "bar", "subtype": "percent_stacked"})
# Configure the first series.
chart3.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart3.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title and some axis labels.
chart3.set_title({"name": "Percent Stacked Chart"})
chart3.set_x_axis({"name": "Test number"})
chart3.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart3.set_style(13)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
workbook.close()

================
File: examples/chart_clustered.py
================
#######################################################################
#
# A demo of a clustered category chart in XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from xlsxwriter.workbook import Workbook
workbook = Workbook("chart_clustered.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Types", "Sub Type", "Value 1", "Value 2", "Value 3"]
data = [
    ["Type 1", "Sub Type A", 5000, 8000, 6000],
    ["", "Sub Type B", 2000, 3000, 4000],
    ["", "Sub Type C", 250, 1000, 2000],
    ["Type 2", "Sub Type D", 6000, 6000, 6500],
    ["", "Sub Type E", 500, 300, 200],
]
worksheet.write_row("A1", headings, bold)
for row_num, row_data in enumerate(data):
    worksheet.write_row(row_num + 1, 0, row_data)
# Create a new chart object. In this case an embedded chart.
chart = workbook.add_chart({"type": "column"})
# Configure the series. Note, that the categories are 2D ranges (from column A
# to column B). This creates the clusters. The series are shown as formula
# strings for clarity but you can also use the list syntax. See the docs.
chart.add_series(
    {
        "categories": "=Sheet1!$A$2:$B$6",
        "values": "=Sheet1!$C$2:$C$6",
    }
)
chart.add_series(
    {
        "categories": "=Sheet1!$A$2:$B$6",
        "values": "=Sheet1!$D$2:$D$6",
    }
)
chart.add_series(
    {
        "categories": "=Sheet1!$A$2:$B$6",
        "values": "=Sheet1!$E$2:$E$6",
    }
)
# Set the Excel chart style.
chart.set_style(37)
# Turn off the legend.
chart.set_legend({"position": "none"})
# Insert the chart into the worksheet.
worksheet.insert_chart("G3", chart)
workbook.close()

================
File: examples/chart_column.py
================
#######################################################################
#
# An example of creating Excel Column charts with Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_column.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Number", "Batch 1", "Batch 2"]
data = [
    [2, 3, 4, 5, 6, 7],
    [10, 40, 50, 20, 10, 50],
    [30, 60, 70, 50, 40, 30],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
worksheet.write_column("C2", data[2])
#######################################################################
#
# Create a new column chart.
#
chart1 = workbook.add_chart({"type": "column"})
# Configure the first series.
chart1.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure a second series. Note use of alternative syntax to define ranges.
chart1.add_series(
    {
        "name": ["Sheet1", 0, 2],
        "categories": ["Sheet1", 1, 0, 6, 0],
        "values": ["Sheet1", 1, 2, 6, 2],
    }
)
# Add a chart title and some axis labels.
chart1.set_title({"name": "Results of sample analysis"})
chart1.set_x_axis({"name": "Test number"})
chart1.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart1.set_style(11)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a stacked chart sub-type.
#
chart2 = workbook.add_chart({"type": "column", "subtype": "stacked"})
# Configure the first series.
chart2.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart2.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title and some axis labels.
chart2.set_title({"name": "Stacked Chart"})
chart2.set_x_axis({"name": "Test number"})
chart2.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart2.set_style(12)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a percentage stacked chart sub-type.
#
chart3 = workbook.add_chart({"type": "column", "subtype": "percent_stacked"})
# Configure the first series.
chart3.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart3.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title and some axis labels.
chart3.set_title({"name": "Percent Stacked Chart"})
chart3.set_x_axis({"name": "Test number"})
chart3.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart3.set_style(13)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
workbook.close()

================
File: examples/chart_combined.py
================
#######################################################################
#
# An example of a Combined chart in XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from xlsxwriter.workbook import Workbook
workbook = Workbook("chart_combined.xlsx")
worksheet = workbook.add_worksheet()
# Add a format for the headings.
bold = workbook.add_format({"bold": True})
# Add the worksheet data that the charts will refer to.
headings = ["Number", "Batch 1", "Batch 2"]
data = [
    [2, 3, 4, 5, 6, 7],
    [10, 40, 50, 20, 10, 50],
    [30, 60, 70, 50, 40, 30],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
worksheet.write_column("C2", data[2])
#
# In the first example we will create a combined column and line chart.
# They will share the same X and Y axes.
#
# Create a new column chart. This will use this as the primary chart.
column_chart1 = workbook.add_chart({"type": "column"})
# Configure the data series for the primary chart.
column_chart1.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Create a new line chart. This will use this as the secondary chart.
line_chart1 = workbook.add_chart({"type": "line"})
# Configure the data series for the secondary chart.
line_chart1.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Combine the charts.
column_chart1.combine(line_chart1)
# Add a chart title and some axis labels. Note, this is done via the
# primary chart.
column_chart1.set_title({"name": "Combined chart - same Y axis"})
column_chart1.set_x_axis({"name": "Test number"})
column_chart1.set_y_axis({"name": "Sample length (mm)"})
# Insert the chart into the worksheet
worksheet.insert_chart("E2", column_chart1)
#
# In the second example we will create a similar combined column and line
# chart except that the secondary chart will have a secondary Y axis.
#
# Create a new column chart. This will use this as the primary chart.
column_chart2 = workbook.add_chart({"type": "column"})
# Configure the data series for the primary chart.
column_chart2.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Create a new column chart. This will use this as the secondary chart.
line_chart2 = workbook.add_chart({"type": "line"})
# Configure the data series for the secondary chart. We also set a
# secondary Y axis via (y2_axis). This is the only difference between
# this and the first example, apart from the axis label below.
line_chart2.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
        "y2_axis": True,
    }
)
# Combine the charts.
column_chart2.combine(line_chart2)
# Add a chart title and some axis labels.
column_chart2.set_title({"name": "Combine chart - secondary Y axis"})
column_chart2.set_x_axis({"name": "Test number"})
column_chart2.set_y_axis({"name": "Sample length (mm)"})
# Note: the y2 properties are on the secondary chart.
line_chart2.set_y2_axis({"name": "Target length (mm)"})
# Insert the chart into the worksheet
worksheet.insert_chart("E18", column_chart2)
workbook.close()

================
File: examples/chart_data_labels.py
================
#######################################################################
#
# A demo of an various Excel chart data label features that are available
# via an XlsxWriter chart.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_data_labels.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Number", "Data", "Text"]
data = [
    [2, 3, 4, 5, 6, 7],
    [20, 10, 20, 30, 40, 30],
    ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
worksheet.write_column("C2", data[2])
#######################################################################
#
# Example with standard data labels.
#
# Create a Column chart.
chart1 = workbook.add_chart({"type": "column"})
# Configure the data series and add the data labels.
chart1.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
        "data_labels": {"value": True},
    }
)
# Add a chart title.
chart1.set_title({"name": "Chart with standard data labels"})
# Turn off the chart legend.
chart1.set_legend({"none": True})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Example with value and category data labels.
#
# Create a Column chart.
chart2 = workbook.add_chart({"type": "column"})
# Configure the data series and add the data labels.
chart2.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
        "data_labels": {"value": True, "category": True},
    }
)
# Add a chart title.
chart2.set_title({"name": "Category and Value data labels"})
# Turn off the chart legend.
chart2.set_legend({"none": True})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Example with standard data labels with different font.
#
# Create a Column chart.
chart3 = workbook.add_chart({"type": "column"})
# Configure the data series and add the data labels.
chart3.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
        "data_labels": {
            "value": True,
            "font": {"bold": True, "color": "red", "rotation": -30},
        },
    }
)
# Add a chart title.
chart3.set_title({"name": "Data labels with user defined font"})
# Turn off the chart legend.
chart3.set_legend({"none": True})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Example with standard data labels and formatting.
#
# Create a Column chart.
chart4 = workbook.add_chart({"type": "column"})
# Configure the data series and add the data labels.
chart4.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
        "data_labels": {
            "value": True,
            "border": {"color": "red"},
            "fill": {"color": "yellow"},
        },
    }
)
# Add a chart title.
chart4.set_title({"name": "Data labels with formatting"})
# Turn off the chart legend.
chart4.set_legend({"none": True})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D50", chart4, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Example with custom string data labels.
#
# Create a Column chart.
chart5 = workbook.add_chart({"type": "column"})
# Some custom labels.
custom_labels = [
    {"value": "Amy"},
    {"value": "Bea"},
    {"value": "Eva"},
    {"value": "Fay"},
    {"value": "Liv"},
    {"value": "Una"},
]
# Configure the data series and add the data labels.
chart5.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
        "data_labels": {"value": True, "custom": custom_labels},
    }
)
# Add a chart title.
chart5.set_title({"name": "Chart with custom string data labels"})
# Turn off the chart legend.
chart5.set_legend({"none": True})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D66", chart5, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Example with custom data labels from cells.
#
# Create a Column chart.
chart6 = workbook.add_chart({"type": "column"})
# Some custom labels.
custom_labels = [
    {"value": "=Sheet1!$C$2"},
    {"value": "=Sheet1!$C$3"},
    {"value": "=Sheet1!$C$4"},
    {"value": "=Sheet1!$C$5"},
    {"value": "=Sheet1!$C$6"},
    {"value": "=Sheet1!$C$7"},
]
# Configure the data series and add the data labels.
chart6.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
        "data_labels": {"value": True, "custom": custom_labels},
    }
)
# Add a chart title.
chart6.set_title({"name": "Chart with custom data labels from cells"})
# Turn off the chart legend.
chart6.set_legend({"none": True})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D82", chart6, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Example with custom and default data labels.
#
# Create a Column chart.
chart7 = workbook.add_chart({"type": "column"})
# The following is used to get a mix of default and custom labels. The 'None'
# items will get the default value. We also set a font for the custom items
# as an extra example.
custom_labels = [
    {"value": "=Sheet1!$C$2", "font": {"color": "red"}},
    None,
    {"value": "=Sheet1!$C$4", "font": {"color": "red"}},
    {"value": "=Sheet1!$C$5", "font": {"color": "red"}},
]
# Configure the data series and add the data labels.
chart7.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
        "data_labels": {"value": True, "custom": custom_labels},
    }
)
# Add a chart title.
chart7.set_title({"name": "Mixed custom and default data labels"})
# Turn off the chart legend.
chart7.set_legend({"none": True})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D98", chart7, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Example with deleted custom data labels.
#
# Create a Column chart.
chart8 = workbook.add_chart({"type": "column"})
# Some deleted custom labels and defaults (set with None values). This allows
# us to highlight certain values such as the minimum and maximum.
custom_labels = [
    {"delete": True},
    None,
    {"delete": True},
    {"delete": True},
    None,
    {"delete": True},
]
# Configure the data series and add the data labels.
chart8.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
        "data_labels": {"value": True, "custom": custom_labels},
    }
)
# Add a chart title.
chart8.set_title({"name": "Chart with deleted data labels"})
# Turn off the chart legend.
chart8.set_legend({"none": True})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D114", chart8, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Example with custom string data labels and formatting.
#
# Create a Column chart.
chart9 = workbook.add_chart({"type": "column"})
# Some custom labels.
custom_labels = [
    {"value": "Amy", "border": {"color": "blue"}},
    {"value": "Bea"},
    {"value": "Eva"},
    {"value": "Fay"},
    {"value": "Liv"},
    {"value": "Una", "fill": {"color": "green"}},
]
# Configure the data series and add the data labels.
chart9.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
        "data_labels": {
            "value": True,
            "custom": custom_labels,
            "border": {"color": "red"},
            "fill": {"color": "yellow"},
        },
    }
)
# Add a chart title.
chart9.set_title({"name": "Chart with custom labels and formatting"})
# Turn off the chart legend.
chart9.set_legend({"none": True})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D130", chart9, {"x_offset": 25, "y_offset": 10})
workbook.close()

================
File: examples/chart_data_table.py
================
#######################################################################
#
# An example of creating Excel Column charts with data tables using
# Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_data_table.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Number", "Batch 1", "Batch 2"]
data = [
    [2, 3, 4, 5, 6, 7],
    [10, 40, 50, 20, 10, 50],
    [30, 60, 70, 50, 40, 30],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
worksheet.write_column("C2", data[2])
#######################################################################
#
# Create a column chart with a data table.
#
chart1 = workbook.add_chart({"type": "column"})
# Configure the first series.
chart1.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series. Note use of alternative syntax to define ranges.
chart1.add_series(
    {
        "name": ["Sheet1", 0, 2],
        "categories": ["Sheet1", 1, 0, 6, 0],
        "values": ["Sheet1", 1, 2, 6, 2],
    }
)
# Add a chart title and some axis labels.
chart1.set_title({"name": "Chart with Data Table"})
chart1.set_x_axis({"name": "Test number"})
chart1.set_y_axis({"name": "Sample length (mm)"})
# Set a default data table on the X-Axis.
chart1.set_table()
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a column chart with a data table and legend keys.
#
chart2 = workbook.add_chart({"type": "column"})
# Configure the first series.
chart2.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart2.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title and some axis labels.
chart2.set_title({"name": "Data Table with legend keys"})
chart2.set_x_axis({"name": "Test number"})
chart2.set_y_axis({"name": "Sample length (mm)"})
# Set a data table on the X-Axis with the legend keys shown.
chart2.set_table({"show_keys": True})
# Hide the chart legend since the keys are shown on the data table.
chart2.set_legend({"position": "none"})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
workbook.close()

================
File: examples/chart_data_tools.py
================
#######################################################################
#
# A demo of an various Excel chart data tools that are available via
# an XlsxWriter chart.
#
# These include, Trendlines, Data Labels, Error Bars, Drop Lines,
# High-Low Lines and Up-Down Bars.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_data_tools.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Number", "Data 1", "Data 2"]
data = [
    [2, 3, 4, 5, 6, 7],
    [10, 40, 50, 20, 10, 50],
    [30, 60, 70, 50, 40, 30],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
worksheet.write_column("C2", data[2])
#######################################################################
#
# Trendline example.
#
# Create a Line chart.
chart1 = workbook.add_chart({"type": "line"})
# Configure the first series with a polynomial trendline.
chart1.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
        "trendline": {
            "type": "polynomial",
            "order": 3,
        },
    }
)
# Configure the second series with a moving average trendline.
chart1.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
        "trendline": {"type": "linear"},
    }
)
# Add a chart title.
chart1.set_title({"name": "Chart with Trendlines"})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Data Labels and Markers example.
#
# Create a Line chart.
chart2 = workbook.add_chart({"type": "line"})
# Configure the first series.
chart2.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
        "data_labels": {"value": 1},
        "marker": {"type": "automatic"},
    }
)
# Configure the second series.
chart2.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title.
chart2.set_title({"name": "Chart with Data Labels and Markers"})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Error Bars example.
#
# Create a Line chart.
chart3 = workbook.add_chart({"type": "line"})
# Configure the first series.
chart3.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
        "y_error_bars": {"type": "standard_error"},
    }
)
# Configure the second series.
chart3.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title.
chart3.set_title({"name": "Chart with Error Bars"})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Up-Down Bars example.
#
# Create a Line chart.
chart4 = workbook.add_chart({"type": "line"})
# Add the Up-Down Bars.
chart4.set_up_down_bars()
# Configure the first series.
chart4.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure the second series.
chart4.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title.
chart4.set_title({"name": "Chart with Up-Down Bars"})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D50", chart4, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# High-Low Lines example.
#
# Create a Line chart.
chart5 = workbook.add_chart({"type": "line"})
# Add the High-Low lines.
chart5.set_high_low_lines()
# Configure the first series.
chart5.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure the second series.
chart5.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title.
chart5.set_title({"name": "Chart with High-Low Lines"})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D66", chart5, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Drop Lines example.
#
# Create a Line chart.
chart6 = workbook.add_chart({"type": "line"})
# Add Drop Lines.
chart6.set_drop_lines()
# Configure the first series.
chart6.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure the second series.
chart6.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title.
chart6.set_title({"name": "Chart with Drop Lines"})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D82", chart6, {"x_offset": 25, "y_offset": 10})
workbook.close()

================
File: examples/chart_date_axis.py
================
#######################################################################
#
# An example of creating an Excel charts with a date axis using
# Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from datetime import date
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_date_axis.xlsx")
worksheet = workbook.add_worksheet()
chart = workbook.add_chart({"type": "line"})
date_format = workbook.add_format({"num_format": "dd/mm/yyyy"})
# Widen the first column to display the dates.
worksheet.set_column("A:A", 12)
# Some data to be plotted in the worksheet.
dates = [
    date(2013, 1, 1),
    date(2013, 1, 2),
    date(2013, 1, 3),
    date(2013, 1, 4),
    date(2013, 1, 5),
    date(2013, 1, 6),
    date(2013, 1, 7),
    date(2013, 1, 8),
    date(2013, 1, 9),
    date(2013, 1, 10),
]
values = [10, 30, 20, 40, 20, 60, 50, 40, 30, 30]
# Write the date to the worksheet.
worksheet.write_column("A1", dates, date_format)
worksheet.write_column("B1", values)
# Add a series to the chart.
chart.add_series(
    {
        "categories": "=Sheet1!$A$1:$A$10",
        "values": "=Sheet1!$B$1:$B$10",
    }
)
# Configure the X axis as a Date axis and set the max and min limits.
chart.set_x_axis(
    {
        "date_axis": True,
        "min": date(2013, 1, 2),
        "max": date(2013, 1, 9),
    }
)
# Turn off the legend.
chart.set_legend({"none": True})
# Insert the chart into the worksheet.
worksheet.insert_chart("D2", chart)
workbook.close()

================
File: examples/chart_doughnut.py
================
#######################################################################
#
# An example of creating Excel Doughnut charts with Python and XlsxWriter.
#
# The demo also shows how to set segment colors. It is possible to
# define chart colors for most types of XlsxWriter charts
# via the add_series() method. However, Pie/Doughnut charts are a special
# case since each segment is represented as a point so it is necessary to
# assign formatting to each point in the series.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_doughnut.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Category", "Values"]
data = [
    ["Glazed", "Chocolate", "Cream"],
    [50, 35, 15],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
#######################################################################
#
# Create a new chart object.
#
chart1 = workbook.add_chart({"type": "doughnut"})
# Configure the series. Note the use of the list syntax to define ranges:
chart1.add_series(
    {
        "name": "Doughnut sales data",
        "categories": ["Sheet1", 1, 0, 3, 0],
        "values": ["Sheet1", 1, 1, 3, 1],
    }
)
# Add a title.
chart1.set_title({"name": "Popular Doughnut Types"})
# Set an Excel chart style. Colors with white outline and shadow.
chart1.set_style(10)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("C2", chart1, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a Doughnut chart with user defined segment colors.
#
# Create an example Doughnut chart like above.
chart2 = workbook.add_chart({"type": "doughnut"})
# Configure the series and add user defined segment colors.
chart2.add_series(
    {
        "name": "Doughnut sales data",
        "categories": "=Sheet1!$A$2:$A$4",
        "values": "=Sheet1!$B$2:$B$4",
        "points": [
            {"fill": {"color": "#FA58D0"}},
            {"fill": {"color": "#61210B"}},
            {"fill": {"color": "#F5F6CE"}},
        ],
    }
)
# Add a title.
chart2.set_title({"name": "Doughnut Chart with user defined colors"})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("C18", chart2, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a Doughnut chart with rotation of the segments.
#
# Create an example Doughnut chart like above.
chart3 = workbook.add_chart({"type": "doughnut"})
# Configure the series.
chart3.add_series(
    {
        "name": "Doughnut sales data",
        "categories": "=Sheet1!$A$2:$A$4",
        "values": "=Sheet1!$B$2:$B$4",
    }
)
# Add a title.
chart3.set_title({"name": "Doughnut Chart with segment rotation"})
# Change the angle/rotation of the first segment.
chart3.set_rotation(90)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("C34", chart3, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a Doughnut chart with user defined hole size and other options.
#
# Create an example Doughnut chart like above.
chart4 = workbook.add_chart({"type": "doughnut"})
# Configure the series.
chart4.add_series(
    {
        "name": "Doughnut sales data",
        "categories": "=Sheet1!$A$2:$A$4",
        "values": "=Sheet1!$B$2:$B$4",
        "points": [
            {"fill": {"color": "#FA58D0"}},
            {"fill": {"color": "#61210B"}},
            {"fill": {"color": "#F5F6CE"}},
        ],
    }
)
# Set a 3D style.
chart4.set_style(26)
# Add a title.
chart4.set_title({"name": "Doughnut Chart with options applied"})
# Change the angle/rotation of the first segment.
chart4.set_rotation(28)
# Change the hole size.
chart4.set_hole_size(33)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("C50", chart4, {"x_offset": 25, "y_offset": 10})
workbook.close()

================
File: examples/chart_gauge.py
================
#######################################################################
#
# An example of creating a Gauge Chart in Excel with Python and XlsxWriter.
#
# A Gauge Chart isn't a native chart type in Excel. It is constructed by
# combining a doughnut chart and a pie chart and by using some non-filled
# elements. This example follows the following online example of how to create
# a Gauge Chart in Excel: https://www.excel-easy.com/examples/gauge-chart.html
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_gauge.xlsx")
worksheet = workbook.add_worksheet()
chart_doughnut = workbook.add_chart({"type": "doughnut"})
chart_pie = workbook.add_chart({"type": "pie"})
# Add some data for the Doughnut and Pie charts. This is set up so the
# gauge goes from 0-100. It is initially set at 75%.
worksheet.write_column("H2", ["Donut", 25, 50, 25, 100])
worksheet.write_column("I2", ["Pie", 75, 1, "=200-I4-I3"])
# Configure the doughnut chart as the background for the gauge.
chart_doughnut.add_series(
    {
        "name": "=Sheet1!$H$2",
        "values": "=Sheet1!$H$3:$H$6",
        "points": [
            {"fill": {"color": "green"}},
            {"fill": {"color": "yellow"}},
            {"fill": {"color": "red"}},
            {"fill": {"none": True}},
        ],
    }
)
# Rotate chart so the gauge parts are above the horizontal.
chart_doughnut.set_rotation(270)
# Turn off the chart legend.
chart_doughnut.set_legend({"none": True})
# Turn off the chart fill and border.
chart_doughnut.set_chartarea(
    {
        "border": {"none": True},
        "fill": {"none": True},
    }
)
# Configure the pie chart as the needle for the gauge.
chart_pie.add_series(
    {
        "name": "=Sheet1!$I$2",
        "values": "=Sheet1!$I$3:$I$6",
        "points": [
            {"fill": {"none": True}},
            {"fill": {"color": "black"}},
            {"fill": {"none": True}},
        ],
    }
)
# Rotate the pie chart/needle to align with the doughnut/gauge.
chart_pie.set_rotation(270)
# Combine the pie and doughnut charts.
chart_doughnut.combine(chart_pie)
# Insert the chart into the worksheet.
worksheet.insert_chart("A1", chart_doughnut)
workbook.close()

================
File: examples/chart_gradient.py
================
#######################################################################
#
# An example of creating an Excel charts with gradient fills using
# Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_gradient.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Number", "Batch 1", "Batch 2"]
data = [
    [2, 3, 4, 5, 6, 7],
    [10, 40, 50, 20, 10, 50],
    [30, 60, 70, 50, 40, 30],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
worksheet.write_column("C2", data[2])
# Create a new column chart.
chart = workbook.add_chart({"type": "column"})
# Configure the first series, including a gradient.
chart.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
        "gradient": {"colors": ["#963735", "#F1DCDB"]},
    }
)
# Configure the second series, including a gradient.
chart.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
        "gradient": {"colors": ["#E36C0A", "#FCEADA"]},
    }
)
# Set a gradient for the plotarea.
chart.set_plotarea({"gradient": {"colors": ["#FFEFD1", "#F0EBD5", "#B69F66"]}})
# Add some axis labels.
chart.set_x_axis({"name": "Test number"})
chart.set_y_axis({"name": "Sample length (mm)"})
# Turn off the chart legend.
chart.set_legend({"none": True})
# Insert the chart into the worksheet.
worksheet.insert_chart("E2", chart)
workbook.close()

================
File: examples/chart_line.py
================
#######################################################################
#
# An example of creating Excel Line charts with Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_line.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Number", "Batch 1", "Batch 2"]
data = [
    [2, 3, 4, 5, 6, 7],
    [10, 40, 50, 20, 10, 50],
    [30, 60, 70, 50, 40, 30],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
worksheet.write_column("C2", data[2])
# Create a new chart object. In this case an embedded chart.
chart1 = workbook.add_chart({"type": "line"})
# Configure the first series.
chart1.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure a second series. Note use of alternative syntax to define ranges.
chart1.add_series(
    {
        "name": ["Sheet1", 0, 2],
        "categories": ["Sheet1", 1, 0, 6, 0],
        "values": ["Sheet1", 1, 2, 6, 2],
    }
)
# Add a chart title and some axis labels.
chart1.set_title({"name": "Results of sample analysis"})
chart1.set_x_axis({"name": "Test number"})
chart1.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style. Colors with white outline and shadow.
chart1.set_style(10)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a stacked line chart sub-type.
#
chart2 = workbook.add_chart({"type": "line", "subtype": "stacked"})
# Configure the first series.
chart2.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart2.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title and some axis labels.
chart2.set_title({"name": "Stacked Chart"})
chart2.set_x_axis({"name": "Test number"})
chart2.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart2.set_style(12)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a percent stacked line chart sub-type.
#
chart3 = workbook.add_chart({"type": "line", "subtype": "percent_stacked"})
# Configure the first series.
chart3.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart3.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title and some axis labels.
chart3.set_title({"name": "Percent Stacked Chart"})
chart3.set_x_axis({"name": "Test number"})
chart3.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart3.set_style(13)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
workbook.close()

================
File: examples/chart_pareto.py
================
#######################################################################
#
# An example of creating of a Pareto chart with Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_pareto.xlsx")
worksheet = workbook.add_worksheet()
# Formats used in the workbook.
bold = workbook.add_format({"bold": True})
percent_format = workbook.add_format({"num_format": "0.0%"})
# Widen the columns for visibility.
worksheet.set_column("A:A", 15)
worksheet.set_column("B:C", 10)
# Add the worksheet data that the charts will refer to.
headings = ["Reason", "Number", "Percentage"]
reasons = [
    "Traffic",
    "Child care",
    "Public Transport",
    "Weather",
    "Overslept",
    "Emergency",
]
numbers = [60, 40, 20, 15, 10, 5]
percents = [0.44, 0.667, 0.8, 0.9, 0.967, 1]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", reasons)
worksheet.write_column("B2", numbers)
worksheet.write_column("C2", percents, percent_format)
# Create a new column chart. This will be the primary chart.
column_chart = workbook.add_chart({"type": "column"})
# Add a series.
column_chart.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Add a chart title.
column_chart.set_title({"name": "Reasons for lateness"})
# Turn off the chart legend.
column_chart.set_legend({"position": "none"})
# Set the title and scale of the Y axes. Note, the secondary axis is set from
# the primary chart.
column_chart.set_y_axis({"name": "Respondents (number)", "min": 0, "max": 120})
column_chart.set_y2_axis({"max": 1})
# Create a new line chart. This will be the secondary chart.
line_chart = workbook.add_chart({"type": "line"})
# Add a series, on the secondary axis.
line_chart.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
        "marker": {"type": "automatic"},
        "y2_axis": 1,
    }
)
# Combine the charts.
column_chart.combine(line_chart)
# Insert the chart into the worksheet.
worksheet.insert_chart("F2", column_chart)
workbook.close()

================
File: examples/chart_pattern.py
================
#######################################################################
#
# An example of an Excel chart with patterns using Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_pattern.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Shingle", "Brick"]
data = [
    [105, 150, 130, 90],
    [50, 120, 100, 110],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
# Create a new Chart object.
chart = workbook.add_chart({"type": "column"})
# Configure the charts. Add two series with patterns. The gap is used to make
# the patterns more visible.
chart.add_series(
    {
        "name": "=Sheet1!$A$1",
        "values": "=Sheet1!$A$2:$A$5",
        "pattern": {"pattern": "shingle", "fg_color": "#804000", "bg_color": "#c68c53"},
        "border": {"color": "#804000"},
        "gap": 70,
    }
)
chart.add_series(
    {
        "name": "=Sheet1!$B$1",
        "values": "=Sheet1!$B$2:$B$5",
        "pattern": {
            "pattern": "horizontal_brick",
            "fg_color": "#b30000",
            "bg_color": "#ff6666",
        },
        "border": {"color": "#b30000"},
    }
)
# Add a chart title and some axis labels.
chart.set_title({"name": "Cladding types"})
chart.set_x_axis({"name": "Region"})
chart.set_y_axis({"name": "Number of houses"})
# Insert the chart into the worksheet.
worksheet.insert_chart("D2", chart)
workbook.close()

================
File: examples/chart_pie.py
================
#######################################################################
#
# An example of creating Excel Pie charts with Python and XlsxWriter.
#
# The demo also shows how to set segment colors. It is possible to
# define chart colors for most types of XlsxWriter charts
# via the add_series() method. However, Pie/Doughnut charts are a special
# case since each segment is represented as a point so it is necessary to
# assign formatting to each point in the series.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_pie.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Category", "Values"]
data = [
    ["Apple", "Cherry", "Pecan"],
    [60, 30, 10],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
#######################################################################
#
# Create a new chart object.
#
chart1 = workbook.add_chart({"type": "pie"})
# Configure the series. Note the use of the list syntax to define ranges:
chart1.add_series(
    {
        "name": "Pie sales data",
        "categories": ["Sheet1", 1, 0, 3, 0],
        "values": ["Sheet1", 1, 1, 3, 1],
    }
)
# Add a title.
chart1.set_title({"name": "Popular Pie Types"})
# Set an Excel chart style. Colors with white outline and shadow.
chart1.set_style(10)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("C2", chart1, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a Pie chart with user defined segment colors.
#
# Create an example Pie chart like above.
chart2 = workbook.add_chart({"type": "pie"})
# Configure the series and add user defined segment colors.
chart2.add_series(
    {
        "name": "Pie sales data",
        "categories": "=Sheet1!$A$2:$A$4",
        "values": "=Sheet1!$B$2:$B$4",
        "points": [
            {"fill": {"color": "#5ABA10"}},
            {"fill": {"color": "#FE110E"}},
            {"fill": {"color": "#CA5C05"}},
        ],
    }
)
# Add a title.
chart2.set_title({"name": "Pie Chart with user defined colors"})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("C18", chart2, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a Pie chart with rotation of the segments.
#
# Create an example Pie chart like above.
chart3 = workbook.add_chart({"type": "pie"})
# Configure the series.
chart3.add_series(
    {
        "name": "Pie sales data",
        "categories": "=Sheet1!$A$2:$A$4",
        "values": "=Sheet1!$B$2:$B$4",
    }
)
# Add a title.
chart3.set_title({"name": "Pie Chart with segment rotation"})
# Change the angle/rotation of the first segment.
chart3.set_rotation(90)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("C34", chart3, {"x_offset": 25, "y_offset": 10})
workbook.close()

================
File: examples/chart_radar.py
================
#######################################################################
#
# An example of creating Excel Radar charts with Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_radar.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Number", "Batch 1", "Batch 2"]
data = [
    [2, 3, 4, 5, 6, 7],
    [30, 60, 70, 50, 40, 30],
    [25, 40, 50, 30, 50, 40],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
worksheet.write_column("C2", data[2])
#######################################################################
#
# Create a new radar chart.
#
chart1 = workbook.add_chart({"type": "radar"})
# Configure the first series.
chart1.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series. Note use of alternative syntax to define ranges.
chart1.add_series(
    {
        "name": ["Sheet1", 0, 2],
        "categories": ["Sheet1", 1, 0, 6, 0],
        "values": ["Sheet1", 1, 2, 6, 2],
    }
)
# Add a chart title.
chart1.set_title({"name": "Results of sample analysis"})
# Set an Excel chart style.
chart1.set_style(11)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a radar chart with markers chart sub-type.
#
chart2 = workbook.add_chart({"type": "radar", "subtype": "with_markers"})
# Configure the first series.
chart2.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart2.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title.
chart2.set_title({"name": "Radar Chart With Markers"})
# Set an Excel chart style.
chart2.set_style(12)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a filled radar chart sub-type.
#
chart3 = workbook.add_chart({"type": "radar", "subtype": "filled"})
# Configure the first series.
chart3.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart3.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title.
chart3.set_title({"name": "Filled Radar Chart"})
# Set an Excel chart style.
chart3.set_style(13)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
workbook.close()

================
File: examples/chart_scatter.py
================
#######################################################################
#
# An example of creating Excel Scatter charts with Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_scatter.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Number", "Batch 1", "Batch 2"]
data = [
    [2, 3, 4, 5, 6, 7],
    [10, 40, 50, 20, 10, 50],
    [30, 60, 70, 50, 40, 30],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
worksheet.write_column("C2", data[2])
#######################################################################
#
# Create a new scatter chart.
#
chart1 = workbook.add_chart({"type": "scatter"})
# Configure the first series.
chart1.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series. Note use of alternative syntax to define ranges.
chart1.add_series(
    {
        "name": ["Sheet1", 0, 2],
        "categories": ["Sheet1", 1, 0, 6, 0],
        "values": ["Sheet1", 1, 2, 6, 2],
    }
)
# Add a chart title and some axis labels.
chart1.set_title({"name": "Results of sample analysis"})
chart1.set_x_axis({"name": "Test number"})
chart1.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart1.set_style(11)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a scatter chart sub-type with straight lines and markers.
#
chart2 = workbook.add_chart({"type": "scatter", "subtype": "straight_with_markers"})
# Configure the first series.
chart2.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart2.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title and some axis labels.
chart2.set_title({"name": "Straight line with markers"})
chart2.set_x_axis({"name": "Test number"})
chart2.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart2.set_style(12)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a scatter chart sub-type with straight lines and no markers.
#
chart3 = workbook.add_chart({"type": "scatter", "subtype": "straight"})
# Configure the first series.
chart3.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart3.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title and some axis labels.
chart3.set_title({"name": "Straight line"})
chart3.set_x_axis({"name": "Test number"})
chart3.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart3.set_style(13)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a scatter chart sub-type with smooth lines and markers.
#
chart4 = workbook.add_chart({"type": "scatter", "subtype": "smooth_with_markers"})
# Configure the first series.
chart4.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart4.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title and some axis labels.
chart4.set_title({"name": "Smooth line with markers"})
chart4.set_x_axis({"name": "Test number"})
chart4.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart4.set_style(14)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D50", chart4, {"x_offset": 25, "y_offset": 10})
#######################################################################
#
# Create a scatter chart sub-type with smooth lines and no markers.
#
chart5 = workbook.add_chart({"type": "scatter", "subtype": "smooth"})
# Configure the first series.
chart5.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure second series.
chart5.add_series(
    {
        "name": "=Sheet1!$C$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$C$2:$C$7",
    }
)
# Add a chart title and some axis labels.
chart5.set_title({"name": "Smooth line"})
chart5.set_x_axis({"name": "Test number"})
chart5.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart5.set_style(15)
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D66", chart5, {"x_offset": 25, "y_offset": 10})
workbook.close()

================
File: examples/chart_secondary_axis.py
================
#######################################################################
#
# An example of creating an Excel Line chart with a secondary axis
# using Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_secondary_axis.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Aliens", "Humans"]
data = [
    [2, 3, 4, 5, 6, 7],
    [10, 40, 50, 20, 10, 50],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
# Create a new chart object. In this case an embedded chart.
chart = workbook.add_chart({"type": "line"})
# Configure a series with a secondary axis
chart.add_series(
    {
        "name": "=Sheet1!$A$1",
        "values": "=Sheet1!$A$2:$A$7",
        "y2_axis": 1,
    }
)
chart.add_series(
    {
        "name": "=Sheet1!$B$1",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
chart.set_legend({"position": "right"})
# Add a chart title and some axis labels.
chart.set_title({"name": "Survey results"})
chart.set_x_axis(
    {
        "name": "Days",
    }
)
chart.set_y_axis({"name": "Population", "major_gridlines": {"visible": 0}})
chart.set_y2_axis({"name": "Laser wounds"})
# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart("D2", chart, {"x_offset": 25, "y_offset": 10})
workbook.close()

================
File: examples/chart_stock.py
================
#######################################################################
#
# An example of creating Excel Stock charts with Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from datetime import datetime
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_stock.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": 1})
date_format = workbook.add_format({"num_format": "dd/mm/yyyy"})
chart = workbook.add_chart({"type": "stock"})
# Add the worksheet data that the charts will refer to.
headings = ["Date", "High", "Low", "Close"]
data = [
    ["2007-01-01", "2007-01-02", "2007-01-03", "2007-01-04", "2007-01-05"],
    [27.2, 25.03, 19.05, 20.34, 18.5],
    [23.49, 19.55, 15.12, 17.84, 16.34],
    [25.45, 23.05, 17.32, 20.45, 17.34],
]
worksheet.write_row("A1", headings, bold)
for row in range(5):
    date = datetime.strptime(data[0][row], "%Y-%m-%d")
    worksheet.write(row + 1, 0, date, date_format)
    worksheet.write(row + 1, 1, data[1][row])
    worksheet.write(row + 1, 2, data[2][row])
    worksheet.write(row + 1, 3, data[3][row])
worksheet.set_column("A:D", 11)
# Add a series for each of the High-Low-Close columns.
chart.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$6",
        "values": "=Sheet1!$B$2:$B$6",
    }
)
chart.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$6",
        "values": "=Sheet1!$C$2:$C$6",
    }
)
chart.add_series(
    {
        "categories": "=Sheet1!$A$2:$A$6",
        "values": "=Sheet1!$D$2:$D$6",
    }
)
# Add a chart title and some axis labels.
chart.set_title({"name": "High-Low-Close"})
chart.set_x_axis({"name": "Date"})
chart.set_y_axis({"name": "Share price"})
worksheet.insert_chart("E9", chart)
workbook.close()

================
File: examples/chart_styles.py
================
#######################################################################
#
# An example showing all 48 default chart styles available in Excel 2007
# using Python and XlsxWriter. Note, these styles are not the same as
# the styles available in Excel 2013.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart_styles.xlsx")
# Show the styles for all of these chart types.
chart_types = ["column", "area", "line", "pie"]
for chart_type in chart_types:
    # Add a worksheet for each chart type.
    worksheet = workbook.add_worksheet(chart_type.title())
    worksheet.set_zoom(30)
    style_number = 1
    # Create 48 charts, each with a different style.
    for row_num in range(0, 90, 15):
        for col_num in range(0, 64, 8):
            chart = workbook.add_chart({"type": chart_type})
            chart.add_series({"values": "=Data!$A$1:$A$6"})
            chart.set_title({"name": f"Style {style_number}"})
            chart.set_legend({"none": True})
            chart.set_style(style_number)
            worksheet.insert_chart(row_num, col_num, chart)
            style_number += 1
# Create a worksheet with data for the charts.
data_worksheet = workbook.add_worksheet("Data")
data = [10, 40, 50, 20, 10, 50]
data_worksheet.write_column("A1", data)
data_worksheet.hide()
workbook.close()

================
File: examples/chart.py
================
#######################################################################
#
# An example of a simple Excel chart with Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chart.xlsx")
worksheet = workbook.add_worksheet()
# Create a new Chart object.
chart = workbook.add_chart({"type": "column"})
# Write some data to add to plot on the chart.
data = [
    [1, 2, 3, 4, 5],
    [2, 4, 6, 8, 10],
    [3, 6, 9, 12, 15],
]
worksheet.write_column("A1", data[0])
worksheet.write_column("B1", data[1])
worksheet.write_column("C1", data[2])
# Configure the charts. In simplest case we just add some data series.
chart.add_series({"values": "=Sheet1!$A$1:$A$5"})
chart.add_series({"values": "=Sheet1!$B$1:$B$5"})
chart.add_series({"values": "=Sheet1!$C$1:$C$5"})
# Insert the chart into the worksheet.
worksheet.insert_chart("A7", chart)
workbook.close()

================
File: examples/chartsheet.py
================
#######################################################################
#
# An example of creating an Excel chart in a chartsheet with Python
# and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("chartsheet.xlsx")
# Add a worksheet to hold the data.
worksheet = workbook.add_worksheet()
# Add a chartsheet. A worksheet that only holds a chart.
chartsheet = workbook.add_chartsheet()
# Add a format for the headings.
bold = workbook.add_format({"bold": 1})
# Add the worksheet data that the charts will refer to.
headings = ["Number", "Batch 1", "Batch 2"]
data = [
    [2, 3, 4, 5, 6, 7],
    [10, 40, 50, 20, 10, 50],
    [30, 60, 70, 50, 40, 30],
]
worksheet.write_row("A1", headings, bold)
worksheet.write_column("A2", data[0])
worksheet.write_column("B2", data[1])
worksheet.write_column("C2", data[2])
# Create a new bar chart.
chart1 = workbook.add_chart({"type": "bar"})
# Configure the first series.
chart1.add_series(
    {
        "name": "=Sheet1!$B$1",
        "categories": "=Sheet1!$A$2:$A$7",
        "values": "=Sheet1!$B$2:$B$7",
    }
)
# Configure a second series. Note use of alternative syntax to define ranges.
chart1.add_series(
    {
        "name": ["Sheet1", 0, 2],
        "categories": ["Sheet1", 1, 0, 6, 0],
        "values": ["Sheet1", 1, 2, 6, 2],
    }
)
# Add a chart title and some axis labels.
chart1.set_title({"name": "Results of sample analysis"})
chart1.set_x_axis({"name": "Test number"})
chart1.set_y_axis({"name": "Sample length (mm)"})
# Set an Excel chart style.
chart1.set_style(11)
# Add the chart to the chartsheet.
chartsheet.set_chart(chart1)
# Display the chartsheet as the active sheet when the workbook is opened.
chartsheet.activate()
workbook.close()

================
File: examples/check_close.py
================
##############################################################################
#
# A simple program demonstrating a check for exceptions when closing the file.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("check_close.xlsx")
worksheet = workbook.add_worksheet()
worksheet.write("A1", "Hello world")
# Try to close() the file in a loop so that if there is an exception, such as
# if the file is open in Excel, we can ask the user to close the file, and
# try again to overwrite it.
while True:
    try:
        workbook.close()
    except xlsxwriter.exceptions.FileCreateError as e:
        decision = input(
            f"Exception caught in workbook.close(): {e}\n"
            f"Please close the file if it is open in Excel.\n"
            f"Try to write file again? [Y/n]: "
        )
        if decision != "n":
            continue
    break

================
File: examples/checkbox.py
================
##############################################################################
#
# An example of adding checkbox boolean values to a worksheet using the the
# XlsxWriter Python module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create a new Excel file object.
workbook = xlsxwriter.Workbook("checkbox.xlsx")
# Add a worksheet to the workbook.
worksheet = workbook.add_worksheet()
# Create some formats to use in the worksheet.
bold = workbook.add_format({"bold": True})
light_red = workbook.add_format({"bg_color": "#FFC7CE"})
light_green = workbook.add_format({"bg_color": "#C6EFCE"})
# Set the column width for clarity.
worksheet.set_column(0, 0, 30)
# Write some descriptions.
worksheet.write(1, 0, "Some simple checkboxes:", bold)
worksheet.write(4, 0, "Some checkboxes with cell formats:", bold)
# Insert some boolean checkboxes to the worksheet.
worksheet.insert_checkbox(1, 1, False)
worksheet.insert_checkbox(2, 1, True)
# Insert some checkboxes with cell formats.
worksheet.insert_checkbox(4, 1, False, light_red)
worksheet.insert_checkbox(5, 1, True, light_green)
# Close the workbook.
workbook.close()

================
File: examples/colors.py
================
##############################################################################
#
# A demonstration of the RGB and Theme colors palettes available in the
# XlsxWriter Python module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
from xlsxwriter.color import Color
# Create a new Excel file object.
workbook = xlsxwriter.Workbook("colors.xlsx")
# Add a worksheet for the RGB colors.
worksheet = workbook.add_worksheet("RGB Colors")
# Write some predefined colors to cells.
named_colors = [
    "Black",
    "Blue",
    "Brown",
    "Cyan",
    "Gray",
    "Green",
    "Lime",
    "Magenta",
    "Navy",
    "Orange",
    "Pink",
    "Purple",
    "Red",
    "Silver",
    "White",
    "Yellow",
]
# Write the named colors.
for row, name in enumerate(named_colors):
    color_format = workbook.add_format({"bg_color": Color(name)})
    worksheet.write_string(row, 0, name)
    worksheet.write_blank(row, 1, None, color_format)
# Write some user-defined RGB colors to cells.
user_defined_colors = [
    "#FF7F50",
    "#DCDCDC",
    "#6495ED",
    "#DAA520",
]
for row, name in enumerate(user_defined_colors, start=len(named_colors)):
    color_format = workbook.add_format({"bg_color": Color(name)})
    worksheet.write_string(row, 0, name)
    worksheet.write_blank(row, 1, None, color_format)
# Add a worksheet for the Theme colors.
worksheet = workbook.add_worksheet("Theme Colors")
# Add alternative colors for the cell text.
black_text = Color("#000000")
white_text = Color("#FFFFFF")
# Create a cell with each of the theme colors.
for row in range(6):
    for col in range(10):
        # Use the theme color for the background.
        theme_color = Color.theme(col, row)
        # Use white font color for better contrast on dark backgrounds.
        if col != 0:
            font_color = white_text
        else:
            font_color = black_text
        color_format = workbook.add_format(
            {
                "align": "center",
                "bg_color": theme_color,
                "font_color": font_color,
            }
        )
        worksheet.write_string(row, col, f"({col}, {row})", color_format)
# Save the file to disk.
workbook.close()

================
File: examples/comments1.py
================
###############################################################################
#
# An example of writing cell comments to a worksheet using Python and
# XlsxWriter.
#
# For more advanced comment options see comments2.py.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("comments1.xlsx")
worksheet = workbook.add_worksheet()
worksheet.write("A1", "Hello")
worksheet.write_comment("A1", "This is a comment")
workbook.close()

================
File: examples/comments2.py
================
###############################################################################
#
# An example of writing cell comments to a worksheet using Python and
# XlsxWriter.
#
# Each of the worksheets demonstrates different features of cell comments.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("comments.xlsx")
worksheet1 = workbook.add_worksheet()
worksheet2 = workbook.add_worksheet()
worksheet3 = workbook.add_worksheet()
worksheet4 = workbook.add_worksheet()
worksheet5 = workbook.add_worksheet()
worksheet6 = workbook.add_worksheet()
worksheet7 = workbook.add_worksheet()
worksheet8 = workbook.add_worksheet()
text_wrap = workbook.add_format({"text_wrap": 1, "valign": "top"})
###############################################################################
#
# Example 1. Demonstrates a simple cell comments without formatting.
#
# Set up some formatting.
worksheet1.set_column("C:C", 25)
worksheet1.set_row(2, 50)
# Simple ASCII string.
cell_text = "Hold the mouse over this cell to see the comment."
comment = "This is a comment."
worksheet1.write("C3", cell_text, text_wrap)
worksheet1.write_comment("C3", comment)
###############################################################################
#
# Example 2. Demonstrates visible and hidden comments.
#
# Set up some formatting.
worksheet2.set_column("C:C", 25)
worksheet2.set_row(2, 50)
worksheet2.set_row(5, 50)
cell_text = "This cell comment is visible."
comment = "Hello."
worksheet2.write("C3", cell_text, text_wrap)
worksheet2.write_comment("C3", comment, {"visible": True})
cell_text = "This cell comment isn't visible (the default)."
worksheet2.write("C6", cell_text, text_wrap)
worksheet2.write_comment("C6", comment)
###############################################################################
#
# Example 3. Demonstrates visible and hidden comments set at the worksheet
#            level.
#
# Set up some formatting.
worksheet3.set_column("C:C", 25)
worksheet3.set_row(2, 50)
worksheet3.set_row(5, 50)
worksheet3.set_row(8, 50)
# Make all comments on the worksheet visible.
worksheet3.show_comments()
cell_text = "This cell comment is visible, explicitly."
comment = "Hello."
worksheet3.write("C3", cell_text, text_wrap)
worksheet3.write_comment("C3", comment, {"visible": True})
cell_text = "This cell comment is also visible because of show_comments()."
worksheet3.write("C6", cell_text, text_wrap)
worksheet3.write_comment("C6", comment)
cell_text = "However, we can still override it locally."
worksheet3.write("C9", cell_text, text_wrap)
worksheet3.write_comment("C9", comment, {"visible": False})
###############################################################################
#
# Example 4. Demonstrates changes to the comment box dimensions.
#
# Set up some formatting.
worksheet4.set_column("C:C", 25)
worksheet4.set_row(2, 50)
worksheet4.set_row(5, 50)
worksheet4.set_row(8, 50)
worksheet4.set_row(15, 50)
worksheet4.set_row(18, 50)
worksheet4.show_comments()
cell_text = "This cell comment is default size."
comment = "Hello."
worksheet4.write("C3", cell_text, text_wrap)
worksheet4.write_comment("C3", comment)
cell_text = "This cell comment is twice as wide."
worksheet4.write("C6", cell_text, text_wrap)
worksheet4.write_comment("C6", comment, {"x_scale": 2})
cell_text = "This cell comment is twice as high."
worksheet4.write("C9", cell_text, text_wrap)
worksheet4.write_comment("C9", comment, {"y_scale": 2})
cell_text = "This cell comment is scaled in both directions."
worksheet4.write("C16", cell_text, text_wrap)
worksheet4.write_comment("C16", comment, {"x_scale": 1.2, "y_scale": 0.5})
cell_text = "This cell comment has width and height specified in pixels."
worksheet4.write("C19", cell_text, text_wrap)
worksheet4.write_comment("C19", comment, {"width": 200, "height": 50})
###############################################################################
#
# Example 5. Demonstrates changes to the cell comment position.
#
worksheet5.set_column("C:C", 25)
worksheet5.set_row(2, 50)
worksheet5.set_row(5, 50)
worksheet5.set_row(8, 50)
worksheet5.set_row(11, 50)
worksheet5.show_comments()
cell_text = "This cell comment is in the default position."
comment = "Hello."
worksheet5.write("C3", cell_text, text_wrap)
worksheet5.write_comment("C3", comment)
cell_text = "This cell comment has been moved to another cell."
worksheet5.write("C6", cell_text, text_wrap)
worksheet5.write_comment("C6", comment, {"start_cell": "E4"})
cell_text = "This cell comment has been moved to another cell."
worksheet5.write("C9", cell_text, text_wrap)
worksheet5.write_comment("C9", comment, {"start_row": 8, "start_col": 4})
cell_text = "This cell comment has been shifted within its default cell."
worksheet5.write("C12", cell_text, text_wrap)
worksheet5.write_comment("C12", comment, {"x_offset": 30, "y_offset": 12})
###############################################################################
#
# Example 6. Demonstrates changes to the comment background color.
#
worksheet6.set_column("C:C", 25)
worksheet6.set_row(2, 50)
worksheet6.set_row(5, 50)
worksheet6.set_row(8, 50)
worksheet6.show_comments()
cell_text = "This cell comment has a different color."
comment = "Hello."
worksheet6.write("C3", cell_text, text_wrap)
worksheet6.write_comment("C3", comment, {"color": "green"})
cell_text = "This cell comment has the default color."
worksheet6.write("C6", cell_text, text_wrap)
worksheet6.write_comment("C6", comment)
cell_text = "This cell comment has a different color."
worksheet6.write("C9", cell_text, text_wrap)
worksheet6.write_comment("C9", comment, {"color": "#CCFFCC"})
###############################################################################
#
# Example 7. Demonstrates how to set the cell comment author.
#
worksheet7.set_column("C:C", 30)
worksheet7.set_row(2, 50)
worksheet7.set_row(5, 50)
author = ""
cell = "C3"
cell_text = (
    "Move the mouse over this cell and you will see 'Cell commented "
    "by (blank)' in the status bar at the bottom"
)
comment = "Hello."
worksheet7.write(cell, cell_text, text_wrap)
worksheet7.write_comment(cell, comment)
author = "Python"
cell = "C6"
cell_text = (
    "Move the mouse over this cell and you will see 'Cell commented "
    "by Python' in the status bar at the bottom"
)
worksheet7.write(cell, cell_text, text_wrap)
worksheet7.write_comment(cell, comment, {"author": author})
###############################################################################
#
# Example 8. Demonstrates the need to explicitly set the row height.
#
# Set up some formatting.
worksheet8.set_column("C:C", 25)
worksheet8.set_row(2, 80)
worksheet8.show_comments()
cell_text = (
    "The height of this row has been adjusted explicitly using "
    "set_row(). The size of the comment box is adjusted "
    "accordingly by XlsxWriter."
)
comment = "Hello."
worksheet8.write("C3", cell_text, text_wrap)
worksheet8.write_comment("C3", comment)
cell_text = (
    "The height of this row has been adjusted by Excel due to the "
    "text wrap property being set. Unfortunately this means that "
    "the height of the row is unknown to XlsxWriter at run time "
    "and thus the comment box is stretched as well.\n\n"
    "Use set_row() to specify the row height explicitly to avoid "
    "this problem."
)
worksheet8.write("C6", cell_text, text_wrap)
worksheet8.write_comment("C6", comment)
workbook.close()

================
File: examples/conditional_format.py
================
###############################################################################
#
# Example of how to add conditional formatting to an XlsxWriter file.
#
# Conditional formatting allows you to apply a format to a cell or a
# range of cells based on certain criteria.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("conditional_format.xlsx")
worksheet1 = workbook.add_worksheet()
worksheet2 = workbook.add_worksheet()
worksheet3 = workbook.add_worksheet()
worksheet4 = workbook.add_worksheet()
worksheet5 = workbook.add_worksheet()
worksheet6 = workbook.add_worksheet()
worksheet7 = workbook.add_worksheet()
worksheet8 = workbook.add_worksheet()
worksheet9 = workbook.add_worksheet()
# Add a format. Light red fill with dark red text.
format1 = workbook.add_format({"bg_color": "#FFC7CE", "font_color": "#9C0006"})
# Add a format. Green fill with dark green text.
format2 = workbook.add_format({"bg_color": "#C6EFCE", "font_color": "#006100"})
# Some sample data to run the conditional formatting against.
data = [
    [34, 72, 38, 30, 75, 48, 75, 66, 84, 86],
    [6, 24, 1, 84, 54, 62, 60, 3, 26, 59],
    [28, 79, 97, 13, 85, 93, 93, 22, 5, 14],
    [27, 71, 40, 17, 18, 79, 90, 93, 29, 47],
    [88, 25, 33, 23, 67, 1, 59, 79, 47, 36],
    [24, 100, 20, 88, 29, 33, 38, 54, 54, 88],
    [6, 57, 88, 28, 10, 26, 37, 7, 41, 48],
    [52, 78, 1, 96, 26, 45, 47, 33, 96, 36],
    [60, 54, 81, 66, 81, 90, 80, 93, 12, 55],
    [70, 5, 46, 14, 71, 19, 66, 36, 41, 21],
]
###############################################################################
#
# Example 1.
#
caption = "Cells with values >= 50 are in light red. Values < 50 are in light green."
# Write the data.
worksheet1.write("A1", caption)
for row, row_data in enumerate(data):
    worksheet1.write_row(row + 2, 1, row_data)
# Write a conditional format over a range.
worksheet1.conditional_format(
    "B3:K12", {"type": "cell", "criteria": ">=", "value": 50, "format": format1}
)
# Write another conditional format over the same range.
worksheet1.conditional_format(
    "B3:K12", {"type": "cell", "criteria": "<", "value": 50, "format": format2}
)
###############################################################################
#
# Example 2.
#
caption = (
    "Values between 30 and 70 are in light red. "
    "Values outside that range are in light green."
)
worksheet2.write("A1", caption)
for row, row_data in enumerate(data):
    worksheet2.write_row(row + 2, 1, row_data)
worksheet2.conditional_format(
    "B3:K12",
    {
        "type": "cell",
        "criteria": "between",
        "minimum": 30,
        "maximum": 70,
        "format": format1,
    },
)
worksheet2.conditional_format(
    "B3:K12",
    {
        "type": "cell",
        "criteria": "not between",
        "minimum": 30,
        "maximum": 70,
        "format": format2,
    },
)
###############################################################################
#
# Example 3.
#
caption = "Duplicate values are in light red. Unique values are in light green."
worksheet3.write("A1", caption)
for row, row_data in enumerate(data):
    worksheet3.write_row(row + 2, 1, row_data)
worksheet3.conditional_format("B3:K12", {"type": "duplicate", "format": format1})
worksheet3.conditional_format("B3:K12", {"type": "unique", "format": format2})
###############################################################################
#
# Example 4.
#
caption = (
    "Above average values are in light red. Below average values are in light green."
)
worksheet4.write("A1", caption)
for row, row_data in enumerate(data):
    worksheet4.write_row(row + 2, 1, row_data)
worksheet4.conditional_format(
    "B3:K12", {"type": "average", "criteria": "above", "format": format1}
)
worksheet4.conditional_format(
    "B3:K12", {"type": "average", "criteria": "below", "format": format2}
)
###############################################################################
#
# Example 5.
#
caption = "Top 10 values are in light red. Bottom 10 values are in light green."
worksheet5.write("A1", caption)
for row, row_data in enumerate(data):
    worksheet5.write_row(row + 2, 1, row_data)
worksheet5.conditional_format(
    "B3:K12", {"type": "top", "value": "10", "format": format1}
)
worksheet5.conditional_format(
    "B3:K12", {"type": "bottom", "value": "10", "format": format2}
)
###############################################################################
#
# Example 6.
#
caption = (
    "Cells with values >= 50 are in light red. "
    "Values < 50 are in light green. Non-contiguous ranges."
)
# Write the data.
worksheet6.write("A1", caption)
for row, row_data in enumerate(data):
    worksheet6.write_row(row + 2, 1, row_data)
# Write a conditional format over a range.
worksheet6.conditional_format(
    "B3:K6",
    {
        "type": "cell",
        "criteria": ">=",
        "value": 50,
        "format": format1,
        "multi_range": "B3:K6 B9:K12",
    },
)
# Write another conditional format over the same range.
worksheet6.conditional_format(
    "B3:K6",
    {
        "type": "cell",
        "criteria": "<",
        "value": 50,
        "format": format2,
        "multi_range": "B3:K6 B9:K12",
    },
)
###############################################################################
#
# Example 7.
#
caption = "Examples of color scales with default and user colors."
data = range(1, 13)
worksheet7.write("A1", caption)
worksheet7.write("B2", "2 Color Scale")
worksheet7.write("D2", "2 Color Scale + user colors")
worksheet7.write("G2", "3 Color Scale")
worksheet7.write("I2", "3 Color Scale + user colors")
for row, row_data in enumerate(data):
    worksheet7.write(row + 2, 1, row_data)
    worksheet7.write(row + 2, 3, row_data)
    worksheet7.write(row + 2, 6, row_data)
    worksheet7.write(row + 2, 8, row_data)
worksheet7.conditional_format("B3:B14", {"type": "2_color_scale"})
worksheet7.conditional_format(
    "D3:D14", {"type": "2_color_scale", "min_color": "#FF0000", "max_color": "#00FF00"}
)
worksheet7.conditional_format("G3:G14", {"type": "3_color_scale"})
worksheet7.conditional_format(
    "I3:I14",
    {
        "type": "3_color_scale",
        "min_color": "#C5D9F1",
        "mid_color": "#8DB4E3",
        "max_color": "#538ED5",
    },
)
###############################################################################
#
# Example 8.
#
caption = "Examples of data bars."
worksheet8.write("A1", caption)
worksheet8.write("B2", "Default data bars")
worksheet8.write("D2", "Bars only")
worksheet8.write("F2", "With user color")
worksheet8.write("H2", "Solid bars")
worksheet8.write("J2", "Right to left")
worksheet8.write("L2", "Excel 2010 style")
worksheet8.write("N2", "Negative same as positive")
data = range(1, 13)
for row, row_data in enumerate(data):
    worksheet8.write(row + 2, 1, row_data)
    worksheet8.write(row + 2, 3, row_data)
    worksheet8.write(row + 2, 5, row_data)
    worksheet8.write(row + 2, 7, row_data)
    worksheet8.write(row + 2, 9, row_data)
data = [-1, -2, -3, -2, -1, 0, 1, 2, 3, 2, 1, 0]
for row, row_data in enumerate(data):
    worksheet8.write(row + 2, 11, row_data)
    worksheet8.write(row + 2, 13, row_data)
worksheet8.conditional_format("B3:B14", {"type": "data_bar"})
worksheet8.conditional_format("D3:D14", {"type": "data_bar", "bar_only": True})
worksheet8.conditional_format("F3:F14", {"type": "data_bar", "bar_color": "#63C384"})
worksheet8.conditional_format("H3:H14", {"type": "data_bar", "bar_solid": True})
worksheet8.conditional_format("J3:J14", {"type": "data_bar", "bar_direction": "right"})
worksheet8.conditional_format("L3:L14", {"type": "data_bar", "data_bar_2010": True})
worksheet8.conditional_format(
    "N3:N14",
    {
        "type": "data_bar",
        "bar_negative_color_same": True,
        "bar_negative_border_color_same": True,
    },
)
###############################################################################
#
# Example 9.
#
caption = "Examples of conditional formats with icon sets."
data = [
    [1, 2, 3],
    [1, 2, 3],
    [1, 2, 3],
    [1, 2, 3],
    [1, 2, 3, 4],
    [1, 2, 3, 4, 5],
    [1, 2, 3, 4, 5],
]
worksheet9.write("A1", caption)
for row, row_data in enumerate(data):
    worksheet9.write_row(row + 2, 1, row_data)
worksheet9.conditional_format(
    "B3:D3", {"type": "icon_set", "icon_style": "3_traffic_lights"}
)
worksheet9.conditional_format(
    "B4:D4",
    {"type": "icon_set", "icon_style": "3_traffic_lights", "reverse_icons": True},
)
worksheet9.conditional_format(
    "B5:D5", {"type": "icon_set", "icon_style": "3_traffic_lights", "icons_only": True}
)
worksheet9.conditional_format("B6:D6", {"type": "icon_set", "icon_style": "3_arrows"})
worksheet9.conditional_format("B7:E7", {"type": "icon_set", "icon_style": "4_arrows"})
worksheet9.conditional_format("B8:F8", {"type": "icon_set", "icon_style": "5_arrows"})
worksheet9.conditional_format("B9:F9", {"type": "icon_set", "icon_style": "5_ratings"})
workbook.close()

================
File: examples/context_manager.py
================
##############################################################################
#
# A simple example using the XlsxWriter Python module and the "with" context
# manager. This doesn't require an explicit close().
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
with xlsxwriter.Workbook("hello_world.xlsx") as workbook:
    worksheet = workbook.add_worksheet()
    worksheet.write("A1", "Hello world")

================
File: examples/data_validate.py
================
###############################################################################
#
# Example of how to add data validation and dropdown lists to an
# XlsxWriter file.
#
# Data validation is a feature of Excel which allows you to restrict
# the data that a user enters in a cell and to display help and
# warning messages. It also allows you to restrict input to values in
# a drop down list.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from datetime import date, time
import xlsxwriter
workbook = xlsxwriter.Workbook("data_validate.xlsx")
worksheet = workbook.add_worksheet()
# Add a format for the header cells.
header_format = workbook.add_format(
    {
        "border": 1,
        "bg_color": "#C6EFCE",
        "bold": True,
        "text_wrap": True,
        "valign": "vcenter",
        "indent": 1,
    }
)
# Set up layout of the worksheet.
worksheet.set_column("A:A", 68)
worksheet.set_column("B:B", 15)
worksheet.set_column("D:D", 15)
worksheet.set_row(0, 36)
# Write the header cells and some data that will be used in the examples.
heading1 = "Some examples of data validation in XlsxWriter"
heading2 = "Enter values in this column"
heading3 = "Sample Data"
worksheet.write("A1", heading1, header_format)
worksheet.write("B1", heading2, header_format)
worksheet.write("D1", heading3, header_format)
worksheet.write_row("D3", ["Integers", 1, 10])
worksheet.write_row("D4", ["List data", "open", "high", "close"])
worksheet.write_row("D5", ["Formula", "=AND(F5=50,G5=60)", 50, 60])
# Example 1. Limiting input to an integer in a fixed range.
#
txt = "Enter an integer between 1 and 10"
worksheet.write("A3", txt)
worksheet.data_validation(
    "B3", {"validate": "integer", "criteria": "between", "minimum": 1, "maximum": 10}
)
# Example 2. Limiting input to an integer outside a fixed range.
#
txt = "Enter an integer that is not between 1 and 10 (using cell references)"
worksheet.write("A5", txt)
worksheet.data_validation(
    "B5",
    {
        "validate": "integer",
        "criteria": "not between",
        "minimum": "=E3",
        "maximum": "=F3",
    },
)
# Example 3. Limiting input to an integer greater than a fixed value.
#
txt = "Enter an integer greater than 0"
worksheet.write("A7", txt)
worksheet.data_validation("B7", {"validate": "integer", "criteria": ">", "value": 0})
# Example 4. Limiting input to an integer less than a fixed value.
#
txt = "Enter an integer less than 10"
worksheet.write("A9", txt)
worksheet.data_validation("B9", {"validate": "integer", "criteria": "<", "value": 10})
# Example 5. Limiting input to a decimal in a fixed range.
#
txt = "Enter a decimal between 0.1 and 0.5"
worksheet.write("A11", txt)
worksheet.data_validation(
    "B11",
    {"validate": "decimal", "criteria": "between", "minimum": 0.1, "maximum": 0.5},
)
# Example 6. Limiting input to a value in a dropdown list.
#
txt = "Select a value from a drop down list"
worksheet.write("A13", txt)
worksheet.data_validation(
    "B13", {"validate": "list", "source": ["open", "high", "close"]}
)
# Example 7. Limiting input to a value in a dropdown list.
#
txt = "Select a value from a drop down list (using a cell range)"
worksheet.write("A15", txt)
worksheet.data_validation("B15", {"validate": "list", "source": "=$E$4:$G$4"})
# Example 8. Limiting input to a date in a fixed range.
#
txt = "Enter a date between 1/1/2013 and 12/12/2013"
worksheet.write("A17", txt)
worksheet.data_validation(
    "B17",
    {
        "validate": "date",
        "criteria": "between",
        "minimum": date(2013, 1, 1),
        "maximum": date(2013, 12, 12),
    },
)
# Example 9. Limiting input to a time in a fixed range.
#
txt = "Enter a time between 6:00 and 12:00"
worksheet.write("A19", txt)
worksheet.data_validation(
    "B19",
    {
        "validate": "time",
        "criteria": "between",
        "minimum": time(6, 0),
        "maximum": time(12, 0),
    },
)
# Example 10. Limiting input to a string greater than a fixed length.
#
txt = "Enter a string longer than 3 characters"
worksheet.write("A21", txt)
worksheet.data_validation("B21", {"validate": "length", "criteria": ">", "value": 3})
# Example 11. Limiting input based on a formula.
#
txt = 'Enter a value if the following is true "=AND(F5=50,G5=60)"'
worksheet.write("A23", txt)
worksheet.data_validation("B23", {"validate": "custom", "value": "=AND(F5=50,G5=60)"})
# Example 12. Displaying and modifying data validation messages.
#
txt = "Displays a message when you select the cell"
worksheet.write("A25", txt)
worksheet.data_validation(
    "B25",
    {
        "validate": "integer",
        "criteria": "between",
        "minimum": 1,
        "maximum": 100,
        "input_title": "Enter an integer:",
        "input_message": "between 1 and 100",
    },
)
# Example 13. Displaying and modifying data validation messages.
#
txt = "Display a custom error message when integer isn't between 1 and 100"
worksheet.write("A27", txt)
worksheet.data_validation(
    "B27",
    {
        "validate": "integer",
        "criteria": "between",
        "minimum": 1,
        "maximum": 100,
        "input_title": "Enter an integer:",
        "input_message": "between 1 and 100",
        "error_title": "Input value is not valid!",
        "error_message": "It should be an integer between 1 and 100",
    },
)
# Example 14. Displaying and modifying data validation messages.
#
txt = "Display a custom info message when integer isn't between 1 and 100"
worksheet.write("A29", txt)
worksheet.data_validation(
    "B29",
    {
        "validate": "integer",
        "criteria": "between",
        "minimum": 1,
        "maximum": 100,
        "input_title": "Enter an integer:",
        "input_message": "between 1 and 100",
        "error_title": "Input value is not valid!",
        "error_message": "It should be an integer between 1 and 100",
        "error_type": "information",
    },
)
workbook.close()

================
File: examples/datetimes.py
================
##############################################################################
#
# A simple program to write some dates and times to an Excel file
# using the XlsxWriter Python module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from datetime import datetime
import xlsxwriter
# Create a workbook and add a worksheet.
workbook = xlsxwriter.Workbook("datetimes.xlsx")
worksheet = workbook.add_worksheet()
bold = workbook.add_format({"bold": True})
# Expand the first columns so that the dates are visible.
worksheet.set_column("A:B", 30)
# Write the column headers.
worksheet.write("A1", "Formatted date", bold)
worksheet.write("B1", "Format", bold)
# Create a datetime object to use in the examples.
date_time = datetime.strptime("2013-01-23 12:30:05.123", "%Y-%m-%d %H:%M:%S.%f")
# Examples date and time formats. In the output file compare how changing
# the format codes change the appearance of the date.
date_formats = (
    "dd/mm/yy",
    "mm/dd/yy",
    "dd m yy",
    "d mm yy",
    "d mmm yy",
    "d mmmm yy",
    "d mmmm yyy",
    "d mmmm yyyy",
    "dd/mm/yy hh:mm",
    "dd/mm/yy hh:mm:ss",
    "dd/mm/yy hh:mm:ss.000",
    "hh:mm",
    "hh:mm:ss",
    "hh:mm:ss.000",
)
# Start from first row after headers.
row = 1
# Write the same date and time using each of the above formats.
for date_format_str in date_formats:
    # Create a format for the date or time.
    date_format = workbook.add_format({"num_format": date_format_str, "align": "left"})
    # Write the same date using different formats.
    worksheet.write_datetime(row, 0, date_time, date_format)
    # Also write the format string for comparison.
    worksheet.write_string(row, 1, date_format_str)
    row += 1
workbook.close()

================
File: examples/defined_name.py
================
##############################################################################
#
# Example of how to create defined names with the XlsxWriter Python module.
#
# This method is used to define a user friendly name to represent a value,
# a single cell or a range of cells in a workbook.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("defined_name.xlsx")
worksheet1 = workbook.add_worksheet()
worksheet2 = workbook.add_worksheet()
# Define some global/workbook names.
workbook.define_name("Exchange_rate", "=0.96")
workbook.define_name("Sales", "=Sheet1!$G$1:$H$10")
# Define a local/worksheet name. Over-rides the "Sales" name above.
workbook.define_name("Sheet2!Sales", "=Sheet2!$G$1:$G$10")
# Write some text in the file and one of the defined names in a formula.
for worksheet in workbook.worksheets():
    worksheet.set_column("A:A", 45)
    worksheet.write("A1", "This worksheet contains some defined names.")
    worksheet.write("A2", "See Formulas -> Name Manager above.")
    worksheet.write("A3", "Example formula in cell B3 ->")
    worksheet.write("B3", "=Exchange_rate")
workbook.close()

================
File: examples/demo.py
================
##############################################################################
#
# A simple example of some of the features of the XlsxWriter Python module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create an new Excel file and add a worksheet.
workbook = xlsxwriter.Workbook("demo.xlsx")
worksheet = workbook.add_worksheet()
# Widen the first column to make the text clearer.
worksheet.set_column("A:A", 20)
# Add a bold format to use to highlight cells.
bold = workbook.add_format({"bold": True})
# Write some simple text.
worksheet.write("A1", "Hello")
# Text with formatting.
worksheet.write("A2", "World", bold)
# Write some numbers, with row/column notation.
worksheet.write(2, 0, 123)
worksheet.write(3, 0, 123.456)
# Insert an image.
worksheet.insert_image("B5", "logo.png")
workbook.close()

================
File: examples/diagonal_border.py
================
##############################################################################
#
# A simple formatting example that demonstrates how to add diagonal cell
# borders with XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("diag_border.xlsx")
worksheet = workbook.add_worksheet()
format1 = workbook.add_format({"diag_type": 1})
format2 = workbook.add_format({"diag_type": 2})
format3 = workbook.add_format({"diag_type": 3})
format4 = workbook.add_format(
    {
        "diag_type": 3,
        "diag_border": 7,
        "diag_color": "red",
    }
)
worksheet.write("B3", "Text", format1)
worksheet.write("B6", "Text", format2)
worksheet.write("B9", "Text", format3)
worksheet.write("B12", "Text", format4)
workbook.close()

================
File: examples/django_simple.py
================
##############################################################################
#
# A simple Django view class to write an Excel file using the XlsxWriter
# module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
# pylint: skip-file
import io
from django.http import HttpResponse
from django.views.generic import View
import xlsxwriter
def get_simple_table_data():
    # Simulate a more complex table read.
    return [[1, 2, 3], [4, 5, 6], [7, 8, 9]]
class MyView(View):
    def get(self, request):
        # Create an in-memory output file for the new workbook.
        output = io.BytesIO()
        # Even though the final file will be in memory the module uses temp
        # files during assembly for efficiency. To avoid this on servers that
        # don't allow temp files, for example the Google APP Engine, set the
        # 'in_memory' Workbook() constructor option as shown in the docs.
        workbook = xlsxwriter.Workbook(output)
        worksheet = workbook.add_worksheet()
        # Get some data to write to the spreadsheet.
        data = get_simple_table_data()
        # Write some test data.
        for row_num, columns in enumerate(data):
            for col_num, cell_data in enumerate(columns):
                worksheet.write(row_num, col_num, cell_data)
        # Close the workbook before sending the data.
        workbook.close()
        # Rewind the buffer.
        output.seek(0)
        # Set up the Http response.
        filename = "django_simple.xlsx"
        response = HttpResponse(
            output,
            content_type="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
        )
        response["Content-Disposition"] = f"attachment; filename={filename}"
        return response

================
File: examples/doc_properties.py
================
##############################################################################
#
# An example of adding document properties to a XlsxWriter file.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("doc_properties.xlsx")
worksheet = workbook.add_worksheet()
workbook.set_properties(
    {
        "title": "This is an example spreadsheet",
        "subject": "With document properties",
        "author": "John McNamara",
        "manager": "Dr. Heinz Doofenshmirtz",
        "company": "of Wolves",
        "category": "Example spreadsheets",
        "keywords": "Sample, Example, Properties",
        "comments": "Created with Python and XlsxWriter",
        "status": "Quo",
    }
)
worksheet.set_column("A:A", 70)
worksheet.write("A1", "Select 'Workbook Properties' to see properties.")
workbook.close()

================
File: examples/dynamic_arrays.py
================
#######################################################################
#
# An example of how to use the XlsxWriter module to write formulas and
# functions that create dynamic arrays. These functions are new to Excel
# 365. The examples mirror the examples in the Excel documentation on these
# functions.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
def main():
    # Create a new workbook called simple.xls and add some worksheets.
    workbook = xlsxwriter.Workbook("dynamic_arrays.xlsx")
    worksheet1 = workbook.add_worksheet("Filter")
    worksheet2 = workbook.add_worksheet("Unique")
    worksheet3 = workbook.add_worksheet("Sort")
    worksheet4 = workbook.add_worksheet("Sortby")
    worksheet5 = workbook.add_worksheet("Xlookup")
    worksheet6 = workbook.add_worksheet("Xmatch")
    worksheet7 = workbook.add_worksheet("Randarray")
    worksheet8 = workbook.add_worksheet("Sequence")
    worksheet9 = workbook.add_worksheet("Spill ranges")
    worksheet10 = workbook.add_worksheet("Older functions")
    header1 = workbook.add_format({"fg_color": "#74AC4C", "font_color": "#FFFFFF"})
    header2 = workbook.add_format({"fg_color": "#528FD3", "font_color": "#FFFFFF"})
    #
    # Example of using the FILTER() function.
    #
    worksheet1.write("F2", "=FILTER(A1:D17,C1:C17=K2)")
    # Write the data the function will work on.
    worksheet1.write("K1", "Product", header2)
    worksheet1.write("K2", "Apple")
    worksheet1.write("F1", "Region", header2)
    worksheet1.write("G1", "Sales Rep", header2)
    worksheet1.write("H1", "Product", header2)
    worksheet1.write("I1", "Units", header2)
    write_worksheet_data(worksheet1, header1)
    worksheet1.set_column_pixels("E:E", 20)
    worksheet1.set_column_pixels("J:J", 20)
    #
    # Example of using the UNIQUE() function.
    #
    worksheet2.write("F2", "=UNIQUE(B2:B17)")
    # A more complex example combining SORT and UNIQUE.
    worksheet2.write("H2", "=SORT(UNIQUE(B2:B17))")
    # Write the data the function will work on.
    worksheet2.write("F1", "Sales Rep", header2)
    worksheet2.write("H1", "Sales Rep", header2)
    write_worksheet_data(worksheet2, header1)
    worksheet2.set_column_pixels("E:E", 20)
    worksheet2.set_column_pixels("G:G", 20)
    #
    # Example of using the SORT() function.
    #
    worksheet3.write("F2", "=SORT(B2:B17)")
    # A more complex example combining SORT and FILTER.
    worksheet3.write("H2", '=SORT(FILTER(C2:D17,D2:D17>5000,""),2,1)')
    # Write the data the function will work on.
    worksheet3.write("F1", "Sales Rep", header2)
    worksheet3.write("H1", "Product", header2)
    worksheet3.write("I1", "Units", header2)
    write_worksheet_data(worksheet3, header1)
    worksheet3.set_column_pixels("E:E", 20)
    worksheet3.set_column_pixels("G:G", 20)
    #
    # Example of using the SORTBY() function.
    #
    worksheet4.write("D2", "=SORTBY(A2:B9,B2:B9)")
    # Write the data the function will work on.
    worksheet4.write("A1", "Name", header1)
    worksheet4.write("B1", "Age", header1)
    worksheet4.write("A2", "Tom")
    worksheet4.write("A3", "Fred")
    worksheet4.write("A4", "Amy")
    worksheet4.write("A5", "Sal")
    worksheet4.write("A6", "Fritz")
    worksheet4.write("A7", "Srivan")
    worksheet4.write("A8", "Xi")
    worksheet4.write("A9", "Hector")
    worksheet4.write("B2", 52)
    worksheet4.write("B3", 65)
    worksheet4.write("B4", 22)
    worksheet4.write("B5", 73)
    worksheet4.write("B6", 19)
    worksheet4.write("B7", 39)
    worksheet4.write("B8", 19)
    worksheet4.write("B9", 66)
    worksheet4.write("D1", "Name", header2)
    worksheet4.write("E1", "Age", header2)
    worksheet4.set_column_pixels("C:C", 20)
    #
    # Example of using the XLOOKUP() function.
    #
    worksheet5.write("F1", "=XLOOKUP(E1,A2:A9,C2:C9)")
    # Write the data the function will work on.
    worksheet5.write("A1", "Country", header1)
    worksheet5.write("B1", "Abr", header1)
    worksheet5.write("C1", "Prefix", header1)
    worksheet5.write("A2", "China")
    worksheet5.write("A3", "India")
    worksheet5.write("A4", "United States")
    worksheet5.write("A5", "Indonesia")
    worksheet5.write("A6", "Brazil")
    worksheet5.write("A7", "Pakistan")
    worksheet5.write("A8", "Nigeria")
    worksheet5.write("A9", "Bangladesh")
    worksheet5.write("B2", "CN")
    worksheet5.write("B3", "IN")
    worksheet5.write("B4", "US")
    worksheet5.write("B5", "ID")
    worksheet5.write("B6", "BR")
    worksheet5.write("B7", "PK")
    worksheet5.write("B8", "NG")
    worksheet5.write("B9", "BD")
    worksheet5.write("C2", 86)
    worksheet5.write("C3", 91)
    worksheet5.write("C4", 1)
    worksheet5.write("C5", 62)
    worksheet5.write("C6", 55)
    worksheet5.write("C7", 92)
    worksheet5.write("C8", 234)
    worksheet5.write("C9", 880)
    worksheet5.write("E1", "Brazil", header2)
    worksheet5.set_column_pixels("A:A", 100)
    worksheet5.set_column_pixels("D:D", 20)
    #
    # Example of using the XMATCH() function.
    #
    worksheet6.write("D2", "=XMATCH(C2,A2:A6)")
    # Write the data the function will work on.
    worksheet6.write("A1", "Product", header1)
    worksheet6.write("A2", "Apple")
    worksheet6.write("A3", "Grape")
    worksheet6.write("A4", "Pear")
    worksheet6.write("A5", "Banana")
    worksheet6.write("A6", "Cherry")
    worksheet6.write("C1", "Product", header2)
    worksheet6.write("D1", "Position", header2)
    worksheet6.write("C2", "Grape")
    worksheet6.set_column_pixels("B:B", 20)
    #
    # Example of using the RANDARRAY() function.
    #
    worksheet7.write("A1", "=RANDARRAY(5,3,1,100, TRUE)")
    #
    # Example of using the SEQUENCE() function.
    #
    worksheet8.write("A1", "=SEQUENCE(4,5)")
    #
    # Example of using the Spill range operator.
    #
    worksheet9.write("H2", "=ANCHORARRAY(F2)")
    worksheet9.write("J2", "=COUNTA(ANCHORARRAY(F2))")
    # Write the data the to work on.
    worksheet9.write("F2", "=UNIQUE(B2:B17)")
    worksheet9.write("F1", "Unique", header2)
    worksheet9.write("H1", "Spill", header2)
    worksheet9.write("J1", "Spill", header2)
    write_worksheet_data(worksheet9, header1)
    worksheet9.set_column_pixels("E:E", 20)
    worksheet9.set_column_pixels("G:G", 20)
    worksheet9.set_column_pixels("I:I", 20)
    #
    # Example of using dynamic ranges with older Excel functions.
    #
    worksheet10.write_dynamic_array_formula("B1:B3", "=LEN(A1:A3)")
    # Write the data the to work on.
    worksheet10.write("A1", "Foo")
    worksheet10.write("A2", "Food")
    worksheet10.write("A3", "Frood")
    # Close the workbook.
    workbook.close()
# Utility function to write the data some of the functions work on.
def write_worksheet_data(worksheet, header):
    worksheet.write("A1", "Region", header)
    worksheet.write("B1", "Sales Rep", header)
    worksheet.write("C1", "Product", header)
    worksheet.write("D1", "Units", header)
    data = (
        ["East", "Tom", "Apple", 6380],
        ["West", "Fred", "Grape", 5619],
        ["North", "Amy", "Pear", 4565],
        ["South", "Sal", "Banana", 5323],
        ["East", "Fritz", "Apple", 4394],
        ["West", "Sravan", "Grape", 7195],
        ["North", "Xi", "Pear", 5231],
        ["South", "Hector", "Banana", 2427],
        ["East", "Tom", "Banana", 4213],
        ["West", "Fred", "Pear", 3239],
        ["North", "Amy", "Grape", 6520],
        ["South", "Sal", "Apple", 1310],
        ["East", "Fritz", "Banana", 6274],
        ["West", "Sravan", "Pear", 4894],
        ["North", "Xi", "Grape", 7580],
        ["South", "Hector", "Apple", 9814],
    )
    row_num = 1
    for row_data in data:
        worksheet.write_row(row_num, 0, row_data)
        row_num += 1
if __name__ == "__main__":
    main()

================
File: examples/embedded_images.py
================
##############################################################################
#
# An example of embedding images into a worksheet cells using the XlsxWriter
# Python module.
#
# This is the equivalent of Excel's menu option to insert an image using the
# option to "Place in Cell" which is only available in Excel 365 versions from
# 2023 onwards. For older versions of Excel a ``#VALUE!`` error is displayed.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create an new Excel file and add a worksheet.
workbook = xlsxwriter.Workbook("embedded_images.xlsx")
worksheet = workbook.add_worksheet()
# Widen the first column to make the caption clearer.
worksheet.set_column(0, 0, 30)
worksheet.write(0, 0, "Embed images that scale to cell size")
# Embed an images in cells of different widths/heights.
worksheet.set_column(1, 1, 14)
worksheet.set_row(1, 60)
worksheet.embed_image(1, 1, "python.png")
worksheet.set_row(3, 120)
worksheet.embed_image(3, 1, "python.png")
workbook.close()

================
File: examples/headers_footers.py
================
######################################################################
#
# This program shows several examples of how to set up headers and
# footers with XlsxWriter.
#
# The control characters used in the header/footer strings are:
#
#     Control             Category            Description
#     =======             ========            ===========
#     &L                  Justification       Left
#     &C                                      Center
#     &R                                      Right
#
#     &P                  Information         Page number
#     &N                                      Total number of pages
#     &D                                      Date
#     &T                                      Time
#     &F                                      File name
#     &A                                      Worksheet name
#
#     &fontsize           Font                Font size
#     &"font,style"                           Font name and style
#     &U                                      Single underline
#     &E                                      Double underline
#     &S                                      Strikethrough
#     &X                                      Superscript
#     &Y                                      Subscript
#
#     &[Picture]          Images              Image placeholder
#     &G                                      Same as &[Picture]
#
#     &&                  Miscellaneous       Literal ampersand &
#
# See the main XlsxWriter documentation for more information.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("headers_footers.xlsx")
preview = "Select Print Preview to see the header and footer"
######################################################################
#
# A simple example to start
#
worksheet1 = workbook.add_worksheet("Simple")
header1 = "&CHere is some centered text."
footer1 = "&LHere is some left aligned text."
worksheet1.set_header(header1)
worksheet1.set_footer(footer1)
worksheet1.set_column("A:A", 50)
worksheet1.write("A1", preview)
######################################################################
#
# Insert a header image.
#
worksheet2 = workbook.add_worksheet("Image")
header2 = "&L&G"
# Adjust the page top margin to allow space for the header image.
worksheet2.set_margins(top=1.3)
worksheet2.set_header(header2, {"image_left": "python-200x80.png"})
worksheet2.set_column("A:A", 50)
worksheet2.write("A1", preview)
######################################################################
#
# This is an example of some of the header/footer variables.
#
worksheet3 = workbook.add_worksheet("Variables")
header3 = "&LPage &P of &N" + "&CFilename: &F" + "&RSheetname: &A"
footer3 = "&LCurrent date: &D" + "&RCurrent time: &T"
worksheet3.set_header(header3)
worksheet3.set_footer(footer3)
worksheet3.set_column("A:A", 50)
worksheet3.write("A1", preview)
worksheet3.write("A21", "Next sheet")
worksheet3.set_h_pagebreaks([20])
######################################################################
#
# This example shows how to use more than one font
#
worksheet4 = workbook.add_worksheet("Mixed fonts")
header4 = '&C&"Courier New,Bold"Hello &"Arial,Italic"World'
footer4 = '&C&"Symbol"e&"Arial" = mc&X2'
worksheet4.set_header(header4)
worksheet4.set_footer(footer4)
worksheet4.set_column("A:A", 50)
worksheet4.write("A1", preview)
######################################################################
#
# Example of line wrapping
#
worksheet5 = workbook.add_worksheet("Word wrap")
header5 = "&CHeading 1\nHeading 2"
worksheet5.set_header(header5)
worksheet5.set_column("A:A", 50)
worksheet5.write("A1", preview)
######################################################################
#
# Example of inserting a literal ampersand &
#
worksheet6 = workbook.add_worksheet("Ampersand")
header6 = "&CCuriouser && Curiouser - Attorneys at Law"
worksheet6.set_header(header6)
worksheet6.set_column("A:A", 50)
worksheet6.write("A1", preview)
workbook.close()

================
File: examples/hello_world.py
================
##############################################################################
#
# A hello world spreadsheet using the XlsxWriter Python module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("hello_world.xlsx")
worksheet = workbook.add_worksheet()
worksheet.write("A1", "Hello world")
workbook.close()

================
File: examples/hide_row_col.py
================
###############################################################################
#
# Example of how to hide rows and columns in XlsxWriter. In order to
# hide rows without setting each one, (of approximately 1 million rows),
# Excel uses an optimizations to hide all rows that don't have data.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("hide_row_col.xlsx")
worksheet = workbook.add_worksheet()
# Write some data.
worksheet.write("D1", "Some hidden columns.")
worksheet.write("A8", "Some hidden rows.")
# Hide all rows without data.
worksheet.set_default_row(hide_unused_rows=True)
# Set the height of empty rows that we do want to display even if it is
# the default height.
for row in range(1, 7):
    worksheet.set_row(row, 15)
# Columns can be hidden explicitly. This doesn't increase the file size..
worksheet.set_column("G:XFD", None, None, {"hidden": True})
workbook.close()

================
File: examples/hide_sheet.py
================
#######################################################################
#
# Example of how to hide a worksheet with XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("hide_sheet.xlsx")
worksheet1 = workbook.add_worksheet()
worksheet2 = workbook.add_worksheet()
worksheet3 = workbook.add_worksheet()
worksheet1.set_column("A:A", 30)
worksheet2.set_column("A:A", 30)
worksheet3.set_column("A:A", 30)
# Hide Sheet2. It won't be visible until it is unhidden in Excel.
worksheet2.hide()
worksheet1.write("A1", "Sheet2 is hidden")
worksheet2.write("A1", "Now it's my turn to find you!")
worksheet3.write("A1", "Sheet2 is hidden")
# Note, you can't hide the "active" worksheet, which generally is the
# first worksheet, since this would cause an Excel error. So, in order to hide
# the first sheet you will need to activate another worksheet:
#
#    worksheet2.activate()
#    worksheet1.hide()
workbook.close()

================
File: examples/http_server.py
================
##############################################################################
#
# Example of using Python and XlsxWriter to create an Excel XLSX file in an in
# memory string suitable for serving via SimpleHTTPRequestHandler or Django or
# with the Google App Engine.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import http.server
import io
import socketserver
import xlsxwriter
class Handler(http.server.SimpleHTTPRequestHandler):
    def do_GET(self):
        # Create an in-memory output file for the new workbook.
        output = io.BytesIO()
        # Even though the final file will be in memory the module uses temp
        # files during assembly for efficiency. To avoid this on servers that
        # don't allow temp files set the 'in_memory' constructor option to True.
        #
        # Note: The Python 3 Runtime Environment in Google App Engine supports
        # a filesystem with read/write access to /tmp which means that the
        # 'in_memory' option isn't required there and can be omitted. See:
        #
        # https://cloud.google.com/appengine/docs/standard/python3/runtime#filesystem
        #
        workbook = xlsxwriter.Workbook(output, {"in_memory": True})
        worksheet = workbook.add_worksheet()
        # Write some test data.
        worksheet.write(0, 0, "Hello, world!")
        # Close the workbook before streaming the data.
        workbook.close()
        # Rewind the buffer.
        output.seek(0)
        # Construct a server response.
        self.send_response(200)
        self.send_header("Content-Disposition", "attachment; filename=test.xlsx")
        self.send_header(
            "Content-type",
            "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
        )
        self.end_headers()
        self.wfile.write(output.read())
        return
print("Server listening on port 8000...")
httpd = socketserver.TCPServer(("", 8000), Handler)
httpd.serve_forever()

================
File: examples/hyperlink.py
================
###############################################################################
#
# Example of how to use the XlsxWriter module to write hyperlinks
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create a new workbook and add a worksheet
workbook = xlsxwriter.Workbook("hyperlink.xlsx")
worksheet = workbook.add_worksheet("Hyperlinks")
# Format the first column
worksheet.set_column("A:A", 30)
# Add a sample alternative link format.
red_format = workbook.add_format(
    {
        "font_color": "red",
        "bold": 1,
        "underline": 1,
        "font_size": 12,
    }
)
# Write some hyperlinks
worksheet.write_url("A1", "http://www.python.org/")  # Implicit format.
worksheet.write_url("A3", "http://www.python.org/", string="Python Home")
worksheet.write_url("A5", "http://www.python.org/", tip="Click here")
worksheet.write_url("A7", "http://www.python.org/", red_format)
worksheet.write_url("A9", "mailto:jmcnamara@cpan.org", string="Mail me")
# Write a URL that isn't a hyperlink
worksheet.write_string("A11", "http://www.python.org/")
workbook.close()

================
File: examples/ignore_errors.py
================
##############################################################################
#
# An example of turning off worksheet cells errors/warnings using the
# XlsxWriter Python module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("ignore_errors.xlsx")
worksheet = workbook.add_worksheet()
# Write strings that looks like numbers. This will cause an Excel warning.
worksheet.write_string("C2", "123")
worksheet.write_string("C3", "123")
# Write a divide by zero formula. This will also cause an Excel warning.
worksheet.write_formula("C5", "=1/0")
worksheet.write_formula("C6", "=1/0")
# Turn off some of the warnings:
worksheet.ignore_errors({"number_stored_as_text": "C3", "eval_error": "C6"})
# Write some descriptions for the cells and make the column wider for clarity.
worksheet.set_column("B:B", 16, None)
worksheet.write("B2", "Warning:")
worksheet.write("B3", "Warning turned off:")
worksheet.write("B5", "Warning:")
worksheet.write("B6", "Warning turned off:")
workbook.close()

================
File: examples/images_bytesio.py
================
##############################################################################
#
# An example of inserting images from a Python BytesIO byte stream into a
# worksheet using the XlsxWriter module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from io import BytesIO
from urllib.request import urlopen
import xlsxwriter
# Create the workbook and add a worksheet.
workbook = xlsxwriter.Workbook("images_bytesio.xlsx")
worksheet = workbook.add_worksheet()
# Read an image from a remote url.
url = (
    "https://raw.githubusercontent.com/jmcnamara/XlsxWriter/"
    + "master/examples/logo.png"
)
image_data = BytesIO(urlopen(url).read())
# Write the byte stream image to a cell. Note, the filename must be
# specified. In this case it will be read from url string.
worksheet.insert_image("B2", url, {"image_data": image_data})
# Read a local image file into a a byte stream. Note, the insert_image()
# method can do this directly. This is for illustration purposes only.
filename = "python.png"
image_file = open(filename, "rb")
image_data = BytesIO(image_file.read())
image_file.close()
# Write the byte stream image to a cell. The filename must  be specified.
worksheet.insert_image("B8", filename, {"image_data": image_data})
workbook.close()

================
File: examples/images.py
================
##############################################################################
#
# An example of inserting images into a worksheet using the XlsxWriter
# Python module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create an new Excel file and add a worksheet.
workbook = xlsxwriter.Workbook("images.xlsx")
worksheet = workbook.add_worksheet()
# Widen the first column to make the text clearer.
worksheet.set_column("A:A", 30)
# Insert an image.
worksheet.write("A2", "Insert an image in a cell:")
worksheet.insert_image("B2", "python.png")
# Insert an image offset in the cell.
worksheet.write("A12", "Insert an image with an offset:")
worksheet.insert_image("B12", "python.png", {"x_offset": 15, "y_offset": 10})
# Insert an image with scaling.
worksheet.write("A23", "Insert a scaled image:")
worksheet.insert_image("B23", "python.png", {"x_scale": 0.5, "y_scale": 0.5})
workbook.close()

================
File: examples/inheritance1.py
================
##############################################################################
#
# Example of how to subclass the Workbook and Worksheet objects. We also
# override the default worksheet.write() method to show how that is done.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from xlsxwriter.workbook import Workbook
from xlsxwriter.worksheet import Worksheet, convert_cell_args
class MyWorksheet(Worksheet):
    """
    Subclass of the XlsxWriter Worksheet class to override the default
    write() method.
    """
    @convert_cell_args
    def write(self, row, col, *args):
        data = args[0]
        # Reverse strings to demonstrate the overridden method.
        if isinstance(data, str):
            data = data[::-1]
            return self.write_string(row, col, data)
        else:
            # Call the parent version of write() as usual for other data.
            return super().write(row, col, *args)
class MyWorkbook(Workbook):
    """
    Subclass of the XlsxWriter Workbook class to override the default
    Worksheet class with our custom class.
    """
    def add_worksheet(self, name=None):
        # Overwrite add_worksheet() to create a MyWorksheet object.
        worksheet = super().add_worksheet(name, MyWorksheet)
        return worksheet
# Create a new MyWorkbook object.
workbook = MyWorkbook("inheritance1.xlsx")
# The code from now on will be the same as a normal "Workbook" program.
worksheet = workbook.add_worksheet()
# Write some data to test the subclassing.
worksheet.write("A1", "Hello")
worksheet.write("A2", "World")
worksheet.write("A3", 123)
worksheet.write("A4", 345)
workbook.close()

================
File: examples/inheritance2.py
================
##############################################################################
#
# Example of how to subclass the Workbook and Worksheet objects. See also the
# simpler inheritance1.py example.
#
# In this example we see an approach to implementing a simulated autofit in a
# user application. This works by overriding the write_string() method to
# track the maximum width string in each column and then set the column
# widths.
#
# Note: THIS ISN'T A FULLY FUNCTIONAL AUTOFIT EXAMPLE. It is only a proof or
# concept or a framework to try out solutions.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from xlsxwriter.workbook import Workbook
from xlsxwriter.worksheet import Worksheet, convert_cell_args
def excel_string_width(string):
    """
    Calculate the length of the string in Excel character units. This is only
    an example and won't give accurate results. It will need to be replaced
    by something more rigorous.
    """
    string_width = len(string)
    if string_width == 0:
        return 0
    else:
        return string_width * 1.1
class MyWorksheet(Worksheet):
    """
    Subclass of the XlsxWriter Worksheet class to override the default
    write_string() method.
    """
    @convert_cell_args
    def write_string(self, row, col, string, cell_format=None):
        # Overridden write_string() method to store the maximum string width
        # seen in each column.
        # Check that row and col are valid and store max and min values.
        if self._check_dimensions(row, col):
            return -1
        # Set the min width for the cell. In some cases this might be the
        # default width of 8.43. In this case we use 0 and adjust for all
        # string widths.
        min_width = 0
        # Check if it the string is the largest we have seen for this column.
        string_width = excel_string_width(string)
        if string_width > min_width:
            max_width = self.max_column_widths.get(col, min_width)
            if string_width > max_width:
                self.max_column_widths[col] = string_width
        # Now call the parent version of write_string() as usual.
        return super().write_string(row, col, string, cell_format)
class MyWorkbook(Workbook):
    """
    Subclass of the XlsxWriter Workbook class to override the default
    Worksheet class with our custom class.
    """
    def add_worksheet(self, name=None):
        # Overwrite add_worksheet() to create a MyWorksheet object.
        # Also add an Worksheet attribute to store the column widths.
        worksheet = super().add_worksheet(name, MyWorksheet)
        worksheet.max_column_widths = {}
        return worksheet
    def close(self):
        # We apply the stored column widths for each worksheet when we close
        # the workbook. This will override any other set_column() values that
        # may have been applied. This could be handled in the application code
        # below, instead.
        for worksheet in self.worksheets():
            for column, width in worksheet.max_column_widths.items():
                worksheet.set_column(column, column, width)
        return super().close()
# Create a new MyWorkbook object.
workbook = MyWorkbook("inheritance2.xlsx")
# The code from now on will be the same as a normal "Workbook" program.
worksheet = workbook.add_worksheet()
# Write some data to test column fitting.
worksheet.write("A1", "F")
worksheet.write("B3", "Foo")
worksheet.write("C1", "F")
worksheet.write("C2", "Fo")
worksheet.write("C3", "Foo")
worksheet.write("C4", "Food")
worksheet.write("D1", "This is a longer string")
# Write a string in row-col notation.
worksheet.write(0, 4, "Hello World")
# Write a number.
worksheet.write(0, 5, 123456)
workbook.close()

================
File: examples/lambda.py
================
#######################################################################
#
# An example of using the new Excel LAMBDA() function with the XlsxWriter
# module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from xlsxwriter.workbook import Workbook
workbook = Workbook("lambda.xlsx")
worksheet = workbook.add_worksheet()
# Write a Lambda function to convert Fahrenheit to Celsius to a cell.
#
# Note that the lambda function parameters must be prefixed with
# "_xlpm.". These prefixes won't show up in Excel.
worksheet.write("A1", "=LAMBDA(_xlpm.temp, (5/9) * (_xlpm.temp-32))(32)")
# Create the same formula (without an argument) as a defined name and use that
# to calculate a value.
#
# Note that the formula name is prefixed with "_xlfn." (this is normally
# converted automatically by write_formula() but isn't for defined names)
# and note that the lambda function parameters are prefixed with
# "_xlpm.". These prefixes won't show up in Excel.
workbook.define_name("ToCelsius", "=_xlfn.LAMBDA(_xlpm.temp, (5/9) * (_xlpm.temp-32))")
# The user defined name needs to be written explicitly as a dynamic array
# formula.
worksheet.write_dynamic_array_formula("A2", "=ToCelsius(212)")
workbook.close()

================
File: examples/macros.py
================
#######################################################################
#
# An example of adding macros to an XlsxWriter file using a VBA project
# file extracted from an existing Excel xlsm file.
#
# The vba_extract.py utility supplied with XlsxWriter can be used to extract
# the vbaProject.bin file.
#
# An embedded macro is connected to a form button on the worksheet.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Note the file extension should be .xlsm.
workbook = xlsxwriter.Workbook("macros.xlsm")
worksheet = workbook.add_worksheet()
worksheet.set_column("A:A", 30)
# Add the VBA project binary.
workbook.add_vba_project("./vbaProject.bin")
# Show text for the end user.
worksheet.write("A3", "Press the button to say hello.")
# Add a button tied to a macro in the VBA project.
worksheet.insert_button(
    "B3", {"macro": "say_hello", "caption": "Press Me", "width": 80, "height": 30}
)
workbook.close()

================
File: examples/merge_rich_string.py
================
##############################################################################
#
# An  example of merging cells which contain a rich string using the
# XlsxWriter Python module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create an new Excel file and add a worksheet.
workbook = xlsxwriter.Workbook("merge_rich_string.xlsx")
worksheet = workbook.add_worksheet()
# Set up some formats to use.
red = workbook.add_format({"color": "red"})
blue = workbook.add_format({"color": "blue"})
cell_format = workbook.add_format({"align": "center", "valign": "vcenter", "border": 1})
# We can only write simple types to merged ranges so we write a blank string.
worksheet.merge_range("B2:E5", "", cell_format)
# We then overwrite the first merged cell with a rich string. Note that we
# must also pass the cell format used in the merged cells format at the end.
worksheet.write_rich_string(
    "B2", "This is ", red, "red", " and this is ", blue, "blue", cell_format
)
workbook.close()

================
File: examples/merge1.py
================
##############################################################################
#
# A simple example of merging cells with the XlsxWriter Python module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create an new Excel file and add a worksheet.
workbook = xlsxwriter.Workbook("merge1.xlsx")
worksheet = workbook.add_worksheet()
# Increase the cell size of the merged cells to highlight the formatting.
worksheet.set_column("B:D", 12)
worksheet.set_row(3, 30)
worksheet.set_row(6, 30)
worksheet.set_row(7, 30)
# Create a format to use in the merged range.
merge_format = workbook.add_format(
    {
        "bold": 1,
        "border": 1,
        "align": "center",
        "valign": "vcenter",
        "fg_color": "yellow",
    }
)
# Merge 3 cells.
worksheet.merge_range("B4:D4", "Merged Range", merge_format)
# Merge 3 cells over two rows.
worksheet.merge_range("B7:D8", "Merged Range", merge_format)
workbook.close()

================
File: examples/outline_collapsed.py
================
###############################################################################
#
# Example of how to use Python and XlsxWriter to generate Excel outlines and
# grouping.
#
# These examples focus mainly on collapsed outlines. See also the
# outlines.py example program for more general examples.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create a new workbook and add some worksheets
workbook = xlsxwriter.Workbook("outline_collapsed.xlsx")
worksheet1 = workbook.add_worksheet("Outlined Rows")
worksheet2 = workbook.add_worksheet("Collapsed Rows 1")
worksheet3 = workbook.add_worksheet("Collapsed Rows 2")
worksheet4 = workbook.add_worksheet("Collapsed Rows 3")
worksheet5 = workbook.add_worksheet("Outline Columns")
worksheet6 = workbook.add_worksheet("Collapsed Columns")
# Add a general format
bold = workbook.add_format({"bold": 1})
# This function will generate the same data and sub-totals on each worksheet.
# Used in the first 4 examples.
#
def create_sub_totals(worksheet):
    # Adjust the column width for clarity.
    worksheet.set_column("A:A", 20)
    # Add the data, labels and formulas.
    worksheet.write("A1", "Region", bold)
    worksheet.write("A2", "North")
    worksheet.write("A3", "North")
    worksheet.write("A4", "North")
    worksheet.write("A5", "North")
    worksheet.write("A6", "North Total", bold)
    worksheet.write("B1", "Sales", bold)
    worksheet.write("B2", 1000)
    worksheet.write("B3", 1200)
    worksheet.write("B4", 900)
    worksheet.write("B5", 1200)
    worksheet.write("B6", "=SUBTOTAL(9,B2:B5)", bold)
    worksheet.write("A7", "South")
    worksheet.write("A8", "South")
    worksheet.write("A9", "South")
    worksheet.write("A10", "South")
    worksheet.write("A11", "South Total", bold)
    worksheet.write("B7", 400)
    worksheet.write("B8", 600)
    worksheet.write("B9", 500)
    worksheet.write("B10", 600)
    worksheet.write("B11", "=SUBTOTAL(9,B7:B10)", bold)
    worksheet.write("A12", "Grand Total", bold)
    worksheet.write("B12", "=SUBTOTAL(9,B2:B10)", bold)
###############################################################################
#
# Example 1: A worksheet with outlined rows. It also includes SUBTOTAL()
# functions so that it looks like the type of automatic outlines that are
# generated when you use the Excel Data->SubTotals menu item.
#
worksheet1.set_row(1, None, None, {"level": 2})
worksheet1.set_row(2, None, None, {"level": 2})
worksheet1.set_row(3, None, None, {"level": 2})
worksheet1.set_row(4, None, None, {"level": 2})
worksheet1.set_row(5, None, None, {"level": 1})
worksheet1.set_row(6, None, None, {"level": 2})
worksheet1.set_row(7, None, None, {"level": 2})
worksheet1.set_row(8, None, None, {"level": 2})
worksheet1.set_row(9, None, None, {"level": 2})
worksheet1.set_row(10, None, None, {"level": 1})
# Write the sub-total data that is common to the row examples.
create_sub_totals(worksheet1)
###############################################################################
#
# Example 2: Create a worksheet with collapsed outlined rows.
# This is the same as the example 1  except that the all rows are collapsed.
# Note: We need to indicate the rows that contains the collapsed symbol '+'
# with the optional parameter, 'collapsed'.
#
worksheet2.set_row(1, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(2, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(3, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(4, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(5, None, None, {"level": 1, "hidden": True})
worksheet2.set_row(6, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(7, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(8, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(9, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(10, None, None, {"level": 1, "hidden": True})
worksheet2.set_row(11, None, None, {"collapsed": True})
# Write the sub-total data that is common to the row examples.
create_sub_totals(worksheet2)
###############################################################################
#
# Example 3: Create a worksheet with collapsed outlined rows.
# Same as the example 1  except that the two sub-totals are collapsed.
#
worksheet3.set_row(1, None, None, {"level": 2, "hidden": True})
worksheet3.set_row(2, None, None, {"level": 2, "hidden": True})
worksheet3.set_row(3, None, None, {"level": 2, "hidden": True})
worksheet3.set_row(4, None, None, {"level": 2, "hidden": True})
worksheet3.set_row(5, None, None, {"level": 1, "collapsed": True})
worksheet3.set_row(6, None, None, {"level": 2, "hidden": True})
worksheet3.set_row(7, None, None, {"level": 2, "hidden": True})
worksheet3.set_row(8, None, None, {"level": 2, "hidden": True})
worksheet3.set_row(9, None, None, {"level": 2, "hidden": True})
worksheet3.set_row(10, None, None, {"level": 1, "collapsed": True})
# Write the sub-total data that is common to the row examples.
create_sub_totals(worksheet3)
###############################################################################
#
# Example 4: Create a worksheet with outlined rows.
# Same as the example 1  except that the two sub-totals are collapsed.
#
worksheet4.set_row(1, None, None, {"level": 2, "hidden": True})
worksheet4.set_row(2, None, None, {"level": 2, "hidden": True})
worksheet4.set_row(3, None, None, {"level": 2, "hidden": True})
worksheet4.set_row(4, None, None, {"level": 2, "hidden": True})
worksheet4.set_row(5, None, None, {"level": 1, "hidden": True, "collapsed": True})
worksheet4.set_row(6, None, None, {"level": 2, "hidden": True})
worksheet4.set_row(7, None, None, {"level": 2, "hidden": True})
worksheet4.set_row(8, None, None, {"level": 2, "hidden": True})
worksheet4.set_row(9, None, None, {"level": 2, "hidden": True})
worksheet4.set_row(10, None, None, {"level": 1, "hidden": True, "collapsed": True})
worksheet4.set_row(11, None, None, {"collapsed": True})
# Write the sub-total data that is common to the row examples.
create_sub_totals(worksheet4)
###############################################################################
#
# Example 5: Create a worksheet with outlined columns.
#
data = [
    ["Month", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Total"],
    ["North", 50, 20, 15, 25, 65, 80, "=SUM(B2:G2)"],
    ["South", 10, 20, 30, 50, 50, 50, "=SUM(B3:G3)"],
    ["East", 45, 75, 50, 15, 75, 100, "=SUM(B4:G4)"],
    ["West", 15, 15, 55, 35, 20, 50, "=SUM(B5:G5)"],
]
# Add bold format to the first row.
worksheet5.set_row(0, None, bold)
# Set column formatting and the outline level.
worksheet5.set_column("A:A", 10, bold)
worksheet5.set_column("B:G", 5, None, {"level": 1})
worksheet5.set_column("H:H", 10)
# Write the data and a formula.
for row, data_row in enumerate(data):
    worksheet5.write_row(row, 0, data_row)
worksheet5.write("H6", "=SUM(H2:H5)", bold)
###############################################################################
#
# Example 6: Create a worksheet with collapsed outlined columns.
# This is the same as the previous example except with collapsed columns.
#
# Reuse the data from the previous example.
# Add bold format to the first row.
worksheet6.set_row(0, None, bold)
# Set column formatting and the outline level.
worksheet6.set_column("A:A", 10, bold)
worksheet6.set_column("B:G", 5, None, {"level": 1, "hidden": True})
worksheet6.set_column("H:H", 10, None, {"collapsed": True})
# Write the data and a formula.
for row, data_row in enumerate(data):
    worksheet6.write_row(row, 0, data_row)
worksheet6.write("H6", "=SUM(H2:H5)", bold)
workbook.close()

================
File: examples/outline.py
================
###############################################################################
#
# Example of how use Python and XlsxWriter to generate Excel outlines and
# grouping.
#
# Excel allows you to group rows or columns so that they can be hidden or
# displayed with a single mouse click. This feature is referred to as outlines.
#
# Outlines can reduce complex data down to a few salient sub-totals or
# summaries.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create a new workbook and add some worksheets
workbook = xlsxwriter.Workbook("outline.xlsx")
worksheet1 = workbook.add_worksheet("Outlined Rows")
worksheet2 = workbook.add_worksheet("Collapsed Rows")
worksheet3 = workbook.add_worksheet("Outline Columns")
worksheet4 = workbook.add_worksheet("Outline levels")
# Add a general format
bold = workbook.add_format({"bold": 1})
###############################################################################
#
# Example 1: A worksheet with outlined rows. It also includes SUBTOTAL()
# functions so that it looks like the type of automatic outlines that are
# generated when you use the Excel Data->SubTotals menu item.
#
# For outlines the important parameters are 'level' and 'hidden'. Rows with
# the same 'level' are grouped together. The group will be collapsed if
# 'hidden' is enabled. The parameters 'height' and 'cell_format' are assigned
# default values if they are None.
#
worksheet1.set_row(1, None, None, {"level": 2})
worksheet1.set_row(2, None, None, {"level": 2})
worksheet1.set_row(3, None, None, {"level": 2})
worksheet1.set_row(4, None, None, {"level": 2})
worksheet1.set_row(5, None, None, {"level": 1})
worksheet1.set_row(6, None, None, {"level": 2})
worksheet1.set_row(7, None, None, {"level": 2})
worksheet1.set_row(8, None, None, {"level": 2})
worksheet1.set_row(9, None, None, {"level": 2})
worksheet1.set_row(10, None, None, {"level": 1})
# Adjust the column width for clarity
worksheet1.set_column("A:A", 20)
# Add the data, labels and formulas
worksheet1.write("A1", "Region", bold)
worksheet1.write("A2", "North")
worksheet1.write("A3", "North")
worksheet1.write("A4", "North")
worksheet1.write("A5", "North")
worksheet1.write("A6", "North Total", bold)
worksheet1.write("B1", "Sales", bold)
worksheet1.write("B2", 1000)
worksheet1.write("B3", 1200)
worksheet1.write("B4", 900)
worksheet1.write("B5", 1200)
worksheet1.write("B6", "=SUBTOTAL(9,B2:B5)", bold)
worksheet1.write("A7", "South")
worksheet1.write("A8", "South")
worksheet1.write("A9", "South")
worksheet1.write("A10", "South")
worksheet1.write("A11", "South Total", bold)
worksheet1.write("B7", 400)
worksheet1.write("B8", 600)
worksheet1.write("B9", 500)
worksheet1.write("B10", 600)
worksheet1.write("B11", "=SUBTOTAL(9,B7:B10)", bold)
worksheet1.write("A12", "Grand Total", bold)
worksheet1.write("B12", "=SUBTOTAL(9,B2:B10)", bold)
###############################################################################
#
# Example 2: A worksheet with outlined rows. This is the same as the
# previous example except that the rows are collapsed.
# Note: We need to indicate the rows that contains the collapsed symbol '+'
# with the optional parameter, 'collapsed'. The group will be then be
# collapsed if 'hidden' is True.
#
worksheet2.set_row(1, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(2, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(3, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(4, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(5, None, None, {"level": 1, "hidden": True})
worksheet2.set_row(6, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(7, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(8, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(9, None, None, {"level": 2, "hidden": True})
worksheet2.set_row(10, None, None, {"level": 1, "hidden": True})
worksheet2.set_row(11, None, None, {"collapsed": True})
# Adjust the column width for clarity
worksheet2.set_column("A:A", 20)
# Add the data, labels and formulas
worksheet2.write("A1", "Region", bold)
worksheet2.write("A2", "North")
worksheet2.write("A3", "North")
worksheet2.write("A4", "North")
worksheet2.write("A5", "North")
worksheet2.write("A6", "North Total", bold)
worksheet2.write("B1", "Sales", bold)
worksheet2.write("B2", 1000)
worksheet2.write("B3", 1200)
worksheet2.write("B4", 900)
worksheet2.write("B5", 1200)
worksheet2.write("B6", "=SUBTOTAL(9,B2:B5)", bold)
worksheet2.write("A7", "South")
worksheet2.write("A8", "South")
worksheet2.write("A9", "South")
worksheet2.write("A10", "South")
worksheet2.write("A11", "South Total", bold)
worksheet2.write("B7", 400)
worksheet2.write("B8", 600)
worksheet2.write("B9", 500)
worksheet2.write("B10", 600)
worksheet2.write("B11", "=SUBTOTAL(9,B7:B10)", bold)
worksheet2.write("A12", "Grand Total", bold)
worksheet2.write("B12", "=SUBTOTAL(9,B2:B10)", bold)
###############################################################################
#
# Example 3: Create a worksheet with outlined columns.
#
data = [
    ["Month", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Total"],
    ["North", 50, 20, 15, 25, 65, 80, "=SUM(B2:G2)"],
    ["South", 10, 20, 30, 50, 50, 50, "=SUM(B3:G3)"],
    ["East", 45, 75, 50, 15, 75, 100, "=SUM(B4:G4)"],
    ["West", 15, 15, 55, 35, 20, 50, "=SUM(B5:G5)"],
]
# Add bold format to the first row.
worksheet3.set_row(0, None, bold)
# Set column formatting and the outline level.
worksheet3.set_column("A:A", 10, bold)
worksheet3.set_column("B:G", 5, None, {"level": 1})
worksheet3.set_column("H:H", 10)
# Write the data and a formula
for row, data_row in enumerate(data):
    worksheet3.write_row(row, 0, data_row)
worksheet3.write("H6", "=SUM(H2:H5)", bold)
###############################################################################
#
# Example 4: Show all possible outline levels.
#
levels = [
    "Level 1",
    "Level 2",
    "Level 3",
    "Level 4",
    "Level 5",
    "Level 6",
    "Level 7",
    "Level 6",
    "Level 5",
    "Level 4",
    "Level 3",
    "Level 2",
    "Level 1",
]
worksheet4.write_column("A1", levels)
worksheet4.set_row(0, None, None, {"level": 1})
worksheet4.set_row(1, None, None, {"level": 2})
worksheet4.set_row(2, None, None, {"level": 3})
worksheet4.set_row(3, None, None, {"level": 4})
worksheet4.set_row(4, None, None, {"level": 5})
worksheet4.set_row(5, None, None, {"level": 6})
worksheet4.set_row(6, None, None, {"level": 7})
worksheet4.set_row(7, None, None, {"level": 6})
worksheet4.set_row(8, None, None, {"level": 5})
worksheet4.set_row(9, None, None, {"level": 4})
worksheet4.set_row(10, None, None, {"level": 3})
worksheet4.set_row(11, None, None, {"level": 2})
worksheet4.set_row(12, None, None, {"level": 1})
workbook.close()

================
File: examples/pandas_autofilter.py
================
##############################################################################
#
# An example of converting a Pandas dataframe to an xlsx file with an
# autofilter and filtered data. See also autofilter.py.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import pandas as pd
# Create a Pandas dataframe by reading some data from a space-separated file.
df = pd.read_csv("autofilter_data.txt", sep=r"\s+")
# Create a Pandas Excel writer using XlsxWriter as the engine.
writer = pd.ExcelWriter("pandas_autofilter.xlsx", engine="xlsxwriter")
# Convert the dataframe to an XlsxWriter Excel object. We also turn off the
# index column at the left of the output dataframe.
df.to_excel(writer, sheet_name="Sheet1", index=False)
# Get the xlsxwriter workbook and worksheet objects.
workbook = writer.book
worksheet = writer.sheets["Sheet1"]
# Get the dimensions of the dataframe.
max_row, max_col = df.shape
# Make the columns wider for clarity.
worksheet.set_column(0, max_col - 1, 12)
# Set the autofilter.
worksheet.autofilter(0, 0, max_row, max_col - 1)
# Add an optional filter criteria. The placeholder "Region" in the filter
# is ignored and can be any string that adds clarity to the expression.
worksheet.filter_column(0, "Region == East")
# It isn't enough to just apply the criteria. The rows that don't match
# must also be hidden. We use Pandas to figure our which rows to hide.
for row_num in df.index[(df["Region"] != "East")].tolist():
    worksheet.set_row(row_num + 1, options={"hidden": True})
# Close the Pandas Excel writer and output the Excel file.
writer.close()

================
File: examples/pandas_chart_columns.py
================
##############################################################################
#
# An example of converting a Pandas dataframe to an xlsx file with a grouped
# column chart using Pandas and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import pandas as pd
# Some sample data to plot.
farm_1 = {"Apples": 10, "Berries": 32, "Squash": 21, "Melons": 13, "Corn": 18}
farm_2 = {"Apples": 15, "Berries": 43, "Squash": 17, "Melons": 10, "Corn": 22}
farm_3 = {"Apples": 6, "Berries": 24, "Squash": 22, "Melons": 16, "Corn": 30}
farm_4 = {"Apples": 12, "Berries": 30, "Squash": 15, "Melons": 9, "Corn": 15}
data = [farm_1, farm_2, farm_3, farm_4]
index = ["Farm 1", "Farm 2", "Farm 3", "Farm 4"]
# Create a Pandas dataframe from the data.
df = pd.DataFrame(data, index=index)
# Create a Pandas Excel writer using XlsxWriter as the engine.
sheet_name = "Sheet1"
writer = pd.ExcelWriter("pandas_chart_columns.xlsx", engine="xlsxwriter")
df.to_excel(writer, sheet_name=sheet_name)
# Access the XlsxWriter workbook and worksheet objects from the dataframe.
workbook = writer.book
worksheet = writer.sheets[sheet_name]
# Create a chart object.
chart = workbook.add_chart({"type": "column"})
# Some alternative colors for the chart.
colors = ["#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00"]
# Configure the series of the chart from the dataframe data.
for col_num in range(1, len(farm_1) + 1):
    chart.add_series(
        {
            "name": ["Sheet1", 0, col_num],
            "categories": ["Sheet1", 1, 0, 4, 0],
            "values": ["Sheet1", 1, col_num, 4, col_num],
            "fill": {"color": colors[col_num - 1]},
            "overlap": -10,
        }
    )
# Configure the chart axes.
chart.set_x_axis({"name": "Total Produce"})
chart.set_y_axis({"name": "Farms", "major_gridlines": {"visible": False}})
# Insert the chart into the worksheet.
worksheet.insert_chart(1, 5, chart)
# Close the Pandas Excel writer and output the Excel file.
writer.close()

================
File: examples/pandas_chart_line.py
================
##############################################################################
#
# An example of converting a Pandas dataframe to an xlsx file with a line
# chart using Pandas and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import random
import pandas as pd
# Create some sample data to plot.
categories = ["Node 1", "Node 2", "Node 3", "Node 4"]
index_1 = range(0, 21, 1)
multi_iter1 = {"index": index_1}
for category in categories:
    multi_iter1[category] = [random.randint(10, 100) for x in index_1]
# Create a Pandas dataframe from the data.
index_2 = multi_iter1.pop("index")
df = pd.DataFrame(multi_iter1, index=index_2)
df = df.reindex(columns=sorted(df.columns))
# Create a Pandas Excel writer using XlsxWriter as the engine.
sheet_name = "Sheet1"
writer = pd.ExcelWriter("pandas_chart_line.xlsx", engine="xlsxwriter")
df.to_excel(writer, sheet_name=sheet_name)
# Access the XlsxWriter workbook and worksheet objects from the dataframe.
workbook = writer.book
worksheet = writer.sheets[sheet_name]
# Get the dimensions of the dataframe.
max_row, max_col = df.shape
# Create a chart object.
chart = workbook.add_chart({"type": "line"})
# Configure the series of the chart from the dataframe data.
for i in range(len(categories)):
    col = i + 1
    chart.add_series(
        {
            "name": ["Sheet1", 0, col],
            "categories": ["Sheet1", 1, 0, max_row, 0],
            "values": ["Sheet1", 1, col, max_row, col],
        }
    )
# Configure the chart axes.
chart.set_x_axis({"name": "Index"})
chart.set_y_axis({"name": "Value", "major_gridlines": {"visible": False}})
# Insert the chart into the worksheet.
worksheet.insert_chart(1, 6, chart)
# Close the Pandas Excel writer and output the Excel file.
writer.close()

================
File: examples/pandas_chart.py
================
##############################################################################
#
# An example of converting a Pandas dataframe to an xlsx file with a chart
# using Pandas and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import pandas as pd
# Create a Pandas dataframe from some data.
df = pd.DataFrame({"Data": [10, 20, 30, 20, 15, 30, 45]})
# Create a Pandas Excel writer using XlsxWriter as the engine.
writer = pd.ExcelWriter("pandas_chart.xlsx", engine="xlsxwriter")
# Convert the dataframe to an XlsxWriter Excel object.
df.to_excel(writer, sheet_name="Sheet1")
# Get the xlsxwriter workbook and worksheet objects.
workbook = writer.book
worksheet = writer.sheets["Sheet1"]
# Create a chart object.
chart = workbook.add_chart({"type": "column"})
# Get the dimensions of the dataframe.
max_row, max_col = df.shape
# Configure the series of the chart from the dataframe data.
chart.add_series({"values": ["Sheet1", 1, 1, max_row, 1]})
# Insert the chart into the worksheet.
worksheet.insert_chart(1, 3, chart)
# Close the Pandas Excel writer and output the Excel file.
writer.close()

================
File: examples/pandas_column_formats.py
================
##############################################################################
#
# An example of converting a Pandas dataframe to an xlsx file
# with column formats using Pandas and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import pandas as pd
# Create a Pandas dataframe from some data.
df = pd.DataFrame(
    {
        "Numbers": [1010, 2020, 3030, 2020, 1515, 3030, 4545],
        "Percentage": [0.1, 0.2, 0.33, 0.25, 0.5, 0.75, 0.45],
    }
)
# Create a Pandas Excel writer using XlsxWriter as the engine.
writer = pd.ExcelWriter("pandas_column_formats.xlsx", engine="xlsxwriter")
# Convert the dataframe to an XlsxWriter Excel object.
df.to_excel(writer, sheet_name="Sheet1")
# Get the xlsxwriter workbook and worksheet objects.
workbook = writer.book
worksheet = writer.sheets["Sheet1"]
# Add some cell formats.
format1 = workbook.add_format({"num_format": "#,##0.00"})
format2 = workbook.add_format({"num_format": "0%"})
# Note: It isn't possible to format any cells that already have a format such
# as the index or headers or any cells that contain dates or datetimes.
# Set the column width and format.
worksheet.set_column(1, 1, 18, format1)
# Set the format but not the column width.
worksheet.set_column(2, 2, None, format2)
# Close the Pandas Excel writer and output the Excel file.
writer.close()

================
File: examples/pandas_conditional_format.py
================
##############################################################################
#
# An example of converting a Pandas dataframe to an xlsx file with a
# conditional formatting using Pandas and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import pandas as pd
# Create a Pandas dataframe from some data.
df = pd.DataFrame({"Data": [10, 20, 30, 20, 15, 30, 45]})
# Create a Pandas Excel writer using XlsxWriter as the engine.
writer = pd.ExcelWriter("pandas_conditional.xlsx", engine="xlsxwriter")
# Convert the dataframe to an XlsxWriter Excel object.
df.to_excel(writer, sheet_name="Sheet1")
# Get the xlsxwriter workbook and worksheet objects.
workbook = writer.book
worksheet = writer.sheets["Sheet1"]
# Get the dimensions of the dataframe.
max_row, max_col = df.shape
# Apply a conditional format to the required cell range.
worksheet.conditional_format(1, max_col, max_row, max_col, {"type": "3_color_scale"})
# Close the Pandas Excel writer and output the Excel file.
writer.close()

================
File: examples/pandas_datetime.py
================
##############################################################################
#
# An example of converting a Pandas dataframe with datetimes to an xlsx file
# with a default datetime and date format using Pandas and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from datetime import date, datetime
import pandas as pd
# Create a Pandas dataframe from some datetime data.
df = pd.DataFrame(
    {
        "Date and time": [
            datetime(2015, 1, 1, 11, 30, 55),
            datetime(2015, 1, 2, 1, 20, 33),
            datetime(2015, 1, 3, 11, 10),
            datetime(2015, 1, 4, 16, 45, 35),
            datetime(2015, 1, 5, 12, 10, 15),
        ],
        "Dates only": [
            date(2015, 2, 1),
            date(2015, 2, 2),
            date(2015, 2, 3),
            date(2015, 2, 4),
            date(2015, 2, 5),
        ],
    }
)
# Create a Pandas Excel writer using XlsxWriter as the engine.
# Also set the default datetime and date formats.
writer = pd.ExcelWriter(
    "pandas_datetime.xlsx",
    engine="xlsxwriter",
    datetime_format="mmm d yyyy hh:mm:ss",
    date_format="mmmm dd yyyy",
)
# Convert the dataframe to an XlsxWriter Excel object.
df.to_excel(writer, sheet_name="Sheet1")
# Get the xlsxwriter workbook and worksheet objects in order
# to set the column widths and make the dates clearer.
workbook = writer.book
worksheet = writer.sheets["Sheet1"]
# Get the dimensions of the dataframe.
max_row, max_col = df.shape
# Set the column widths, to make the dates clearer.
worksheet.set_column(1, max_col, 20)
# Close the Pandas Excel writer and output the Excel file.
writer.close()

================
File: examples/pandas_header_format.py
================
##############################################################################
#
# An example of converting a Pandas dataframe to an xlsx file
# with a user defined header format.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import pandas as pd
# Create a Pandas dataframe from some data.
data = [10, 20, 30, 40, 50, 60]
df = pd.DataFrame({"Heading": data, "Longer heading that should be wrapped": data})
# Create a Pandas Excel writer using XlsxWriter as the engine.
writer = pd.ExcelWriter("pandas_header_format.xlsx", engine="xlsxwriter")
# Convert the dataframe to an XlsxWriter Excel object. Note that we turn off
# the default header and skip one row to allow us to insert a user defined
# header.
df.to_excel(writer, sheet_name="Sheet1", startrow=1, header=False)
# Get the xlsxwriter workbook and worksheet objects.
workbook = writer.book
worksheet = writer.sheets["Sheet1"]
# Add a header format.
header_format = workbook.add_format(
    {
        "bold": True,
        "text_wrap": True,
        "valign": "top",
        "fg_color": "#D7E4BC",
        "border": 1,
    }
)
# Write the column headers with the defined format.
for col_num, value in enumerate(df.columns.values):
    worksheet.write(0, col_num + 1, value, header_format)
# Close the Pandas Excel writer and output the Excel file.
writer.close()

================
File: examples/pandas_multiple.py
================
##############################################################################
#
# An example of writing multiple dataframes to worksheets using Pandas and
# XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import pandas as pd
# Create some Pandas dataframes from some data.
df1 = pd.DataFrame({"Data": [11, 12, 13, 14]})
df2 = pd.DataFrame({"Data": [21, 22, 23, 24]})
df3 = pd.DataFrame({"Data": [31, 32, 33, 34]})
# Create a Pandas Excel writer using XlsxWriter as the engine.
writer = pd.ExcelWriter("pandas_multiple.xlsx", engine="xlsxwriter")
# Write each dataframe to a different worksheet.
df1.to_excel(writer, sheet_name="Sheet1")
df2.to_excel(writer, sheet_name="Sheet2")
df3.to_excel(writer, sheet_name="Sheet3")
# Close the Pandas Excel writer and output the Excel file.
writer.close()

================
File: examples/pandas_percentage.py
================
##############################################################################
#
# An example of converting some string percentage data in a Pandas dataframe
# to percentage numbers in an xlsx file with using XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import pandas as pd
# Create a Pandas dataframe from some data.
df = pd.DataFrame({"Names": ["Anna", "Arek", "Arun"], "Grade": ["100%", "70%", "85%"]})
# Convert the percentage strings to percentage numbers.
df["Grade"] = df["Grade"].str.replace("%", "")
df["Grade"] = df["Grade"].astype(float)
df["Grade"] = df["Grade"].div(100)
# Create a Pandas Excel writer using XlsxWriter as the engine.
writer = pd.ExcelWriter("pandas_percent.xlsx", engine="xlsxwriter")
# Convert the dataframe to an XlsxWriter Excel object.
df.to_excel(writer, sheet_name="Sheet1")
# Get the xlsxwriter workbook and worksheet objects.
workbook = writer.book
worksheet = writer.sheets["Sheet1"]
# Add a percent number format.
percent_format = workbook.add_format({"num_format": "0%"})
# Apply the number format to Grade column.
worksheet.set_column(2, 2, None, percent_format)
# Close the Pandas Excel writer and output the Excel file.
writer.close()

================
File: examples/pandas_positioning.py
================
##############################################################################
#
# An example of positioning dataframes in a worksheet using Pandas and
# XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import pandas as pd
# Create some Pandas dataframes from some data.
df1 = pd.DataFrame({"Data": [11, 12, 13, 14]})
df2 = pd.DataFrame({"Data": [21, 22, 23, 24]})
df3 = pd.DataFrame({"Data": [31, 32, 33, 34]})
df4 = pd.DataFrame({"Data": [41, 42, 43, 44]})
# Create a Pandas Excel writer using XlsxWriter as the engine.
writer = pd.ExcelWriter("pandas_positioning.xlsx", engine="xlsxwriter")
# Position the dataframes in the worksheet.
df1.to_excel(writer, sheet_name="Sheet1")  # Default position, cell A1.
df2.to_excel(writer, sheet_name="Sheet1", startcol=3)
df3.to_excel(writer, sheet_name="Sheet1", startrow=6)
# It is also possible to write the dataframe without the header and index.
df4.to_excel(
    writer, sheet_name="Sheet1", startrow=7, startcol=4, header=False, index=False
)
# Close the Pandas Excel writer and output the Excel file.
writer.close()

================
File: examples/pandas_simple.py
================
##############################################################################
#
# A simple example of converting a Pandas dataframe to an xlsx file using
# Pandas and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import pandas as pd
# Create a Pandas dataframe from some data.
df = pd.DataFrame({"Data": [10, 20, 30, 20, 15, 30, 45]})
# Create a Pandas Excel writer using XlsxWriter as the engine.
writer = pd.ExcelWriter("pandas_simple.xlsx", engine="xlsxwriter")
# Convert the dataframe to an XlsxWriter Excel object.
df.to_excel(writer, sheet_name="Sheet1")
# Close the Pandas Excel writer and output the Excel file.
writer.close()

================
File: examples/pandas_table.py
================
##############################################################################
#
# An example of adding a dataframe to an worksheet table in an xlsx file
# using Pandas and XlsxWriter.
#
# Tables in Excel are used to group rows and columns of data into a single
# structure that can be referenced in a formula or formatted collectively.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import pandas as pd
# Create a Pandas dataframe from some data.
df = pd.DataFrame(
    {
        "Country": ["China", "India", "United States", "Indonesia"],
        "Population": [1404338840, 1366938189, 330267887, 269603400],
        "Rank": [1, 2, 3, 4],
    }
)
# Order the columns if necessary.
df = df[["Rank", "Country", "Population"]]
# Create a Pandas Excel writer using XlsxWriter as the engine.
writer = pd.ExcelWriter("pandas_table.xlsx", engine="xlsxwriter")
# Write the dataframe data to XlsxWriter. Turn off the default header and
# index and skip one row to allow us to insert a user defined header.
df.to_excel(writer, sheet_name="Sheet1", startrow=1, header=False, index=False)
# Get the xlsxwriter workbook and worksheet objects.
workbook = writer.book
worksheet = writer.sheets["Sheet1"]
# Get the dimensions of the dataframe.
max_row, max_col = df.shape
# Create a list of column headers, to use in add_table().
column_settings = [{"header": column} for column in df.columns]
# Add the Excel table structure. Pandas will add the data.
worksheet.add_table(0, 0, max_row, max_col - 1, {"columns": column_settings})
# Make the columns wider for clarity.
worksheet.set_column(0, max_col - 1, 12)
# Close the Pandas Excel writer and output the Excel file.
writer.close()

================
File: examples/panes.py
================
#######################################################################
#
# Example of using Python and the XlsxWriter module to create
# worksheet panes.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("panes.xlsx")
worksheet1 = workbook.add_worksheet("Panes 1")
worksheet2 = workbook.add_worksheet("Panes 2")
worksheet3 = workbook.add_worksheet("Panes 3")
worksheet4 = workbook.add_worksheet("Panes 4")
#######################################################################
#
# Set up some formatting and text to highlight the panes.
#
header_format = workbook.add_format(
    {
        "bold": True,
        "align": "center",
        "valign": "vcenter",
        "fg_color": "#D7E4BC",
        "border": 1,
    }
)
center_format = workbook.add_format({"align": "center"})
#######################################################################
#
# Example 1. Freeze pane on the top row.
#
worksheet1.freeze_panes(1, 0)
# Other sheet formatting.
worksheet1.set_column("A:I", 16)
worksheet1.set_row(0, 20)
worksheet1.set_selection("C3")
# Some text to demonstrate scrolling.
for col in range(0, 9):
    worksheet1.write(0, col, "Scroll down", header_format)
for row in range(1, 100):
    for col in range(0, 9):
        worksheet1.write(row, col, row + 1, center_format)
#######################################################################
#
# Example 2. Freeze pane on the left column.
#
worksheet2.freeze_panes(0, 1)
# Other sheet formatting.
worksheet2.set_column("A:A", 16)
worksheet2.set_selection("C3")
# Some text to demonstrate scrolling.
for row in range(0, 50):
    worksheet2.write(row, 0, "Scroll right", header_format)
    for col in range(1, 26):
        worksheet2.write(row, col, col, center_format)
#######################################################################
#
# Example 3. Freeze pane on the top row and left column.
#
worksheet3.freeze_panes(1, 1)
# Other sheet formatting.
worksheet3.set_column("A:Z", 16)
worksheet3.set_row(0, 20)
worksheet3.set_selection("C3")
worksheet3.write(0, 0, "", header_format)
# Some text to demonstrate scrolling.
for col in range(1, 26):
    worksheet3.write(0, col, "Scroll down", header_format)
for row in range(1, 50):
    worksheet3.write(row, 0, "Scroll right", header_format)
    for col in range(1, 26):
        worksheet3.write(row, col, col, center_format)
#######################################################################
#
# Example 4. Split pane on the top row and left column.
#
# The divisions must be specified in terms of row and column dimensions.
# The default row height is 15 and the default column width is 8.43
#
worksheet4.split_panes(15, 8.43)
# Other sheet formatting.
worksheet4.set_selection("C3")
# Some text to demonstrate scrolling.
for col in range(1, 26):
    worksheet4.write(0, col, "Scroll", center_format)
for row in range(1, 50):
    worksheet4.write(row, 0, "Scroll", center_format)
    for col in range(1, 26):
        worksheet4.write(row, col, col, center_format)
workbook.close()

================
File: examples/polars_chart.py
================
##############################################################################
#
# An example of adding a Polars dataframe to a worksheet created by XlsxWriter
# and then adding a chart of the data.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import polars as pl
import xlsxwriter
df = pl.DataFrame({"Data": [10, 20, 30, 20, 15, 30, 45]})
with xlsxwriter.Workbook("polars_chart.xlsx") as workbook:
    # Create the worksheet so we can reuse it later.
    worksheet = workbook.add_worksheet()
    # Write the Polars data to the worksheet created above.
    df.write_excel(workbook=workbook, worksheet="Sheet1")
    # Create a chart object.
    chart = workbook.add_chart({"type": "column"})
    # Get the dimensions of the dataframe.
    max_row, max_col = df.shape
    # Configure the series of the chart from the dataframe data.
    chart.add_series({"values": ["Sheet1", 1, max_col - 1, max_row, max_col - 1]})
    # Insert the chart into the worksheet.
    worksheet.insert_chart(1, 3, chart)

================
File: examples/polars_checkbox.py
================
##############################################################################
#
# A example of displaying the boolean values in a Polars dataframe as checkboxes
# in an output xlsx file.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import polars as pl
# Create a Pandas dataframe with some sample data.
df = pl.DataFrame(
    {
        "Region": ["North", "South", "East", "West"],
        "Target": [100, 70, 90, 120],
        "On-track": [False, True, True, False],
    }
)
# Write the dataframe to a new Excel file with formatting options.
df.write_excel(
    workbook="polars_checkbox.xlsx",
    # Set the checkbox format for the "On-track" boolean column.
    column_formats={"On-track": {"checkbox": True}},
    # Set an alternative table style.
    table_style="Table Style Light 9",
    # Autofit the column widths.
    autofit=True,
)

================
File: examples/polars_conditional_format.py
================
##############################################################################
#
# An example of adding a Polars dataframe to a worksheet with a conditional
# format.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import polars as pl
df = pl.DataFrame({"Data": [10, 20, 30, 20, 15, 30, 45]})
df.write_excel(
    workbook="pandas_conditional.xlsx",
    conditional_formats={"Data": {"type": "3_color_scale"}},
)

================
File: examples/polars_format_custom.py
================
##############################################################################
#
# A simple example of converting a Polars dataframe to an xlsx file with
# custom formatting of the worksheet table.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from datetime import date
import polars as pl
# Create a Pandas dataframe with some sample data.
df = pl.DataFrame(
    {
        "Dates": [date(2023, 1, 1), date(2023, 1, 2), date(2023, 1, 3)],
        "Strings": ["Alice", "Bob", "Carol"],
        "Numbers": [0.12345, 100, -99.523],
    }
)
# Write the dataframe to a new Excel file with formatting options.
df.write_excel(
    workbook="polars_format_custom.xlsx",
    # Set an alternative table style.
    table_style="Table Style Medium 4",
    # See the floating point precision for reals.
    float_precision=6,
    # Set an alternative number/date format for Polar Date types.
    dtype_formats={pl.Date: "yyyy mm dd;@"},
    # Add totals to the numeric columns.
    column_totals=True,
    # Autofit the column widths.
    autofit=True,
)

================
File: examples/polars_format_default.py
================
##############################################################################
#
# A simple example of converting a Polars dataframe to an xlsx file with
# default formatting.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from datetime import date
import polars as pl
# Create a Pandas dataframe with some sample data.
df = pl.DataFrame(
    {
        "Dates": [date(2023, 1, 1), date(2023, 1, 2), date(2023, 1, 3)],
        "Strings": ["Alice", "Bob", "Carol"],
        "Numbers": [0.12345, 100, -99.523],
    }
)
# Write the dataframe to a new Excel file with autofit on.
df.write_excel(workbook="polars_format_default.xlsx", autofit=True)

================
File: examples/polars_multiple.py
================
##############################################################################
#
# An example of writing multiple dataframes to worksheets using Polars and
# XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import polars as pl
import xlsxwriter
# Create some Polars dataframes from some data.
df1 = pl.DataFrame({"Data": [11, 12, 13, 14]})
df2 = pl.DataFrame({"Data": [21, 22, 23, 24]})
df3 = pl.DataFrame({"Data": [31, 32, 33, 34]})
with xlsxwriter.Workbook("polars_multiple.xlsx") as workbook:
    df1.write_excel(workbook=workbook)
    df2.write_excel(workbook=workbook)
    df3.write_excel(workbook=workbook)

================
File: examples/polars_positioning.py
================
##############################################################################
#
# An example of positioning dataframes in a worksheet using Polars and
# XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import polars as pl
import xlsxwriter
# Create some Polars dataframes from some data.
df1 = pl.DataFrame({"Data": [11, 12, 13, 14]})
df2 = pl.DataFrame({"Data": [21, 22, 23, 24]})
df3 = pl.DataFrame({"Data": [31, 32, 33, 34]})
df4 = pl.DataFrame({"Data": [41, 42, 43, 44]})
with xlsxwriter.Workbook("polars_positioning.xlsx") as workbook:
    # Write the dataframe to the default worksheet and position: Sheet1!A1.
    df1.write_excel(workbook=workbook)
    # Write the dataframe using a cell string position.
    df2.write_excel(workbook=workbook, worksheet="Sheet1", position="C1")
    # Write the dataframe using a (row, col) tuple position.
    df3.write_excel(workbook=workbook, worksheet="Sheet1", position=(6, 0))
    # Write the dataframe without the header.
    df4.write_excel(
        workbook=workbook, worksheet="Sheet1", position="C8", include_header=False
    )

================
File: examples/polars_simple.py
================
##############################################################################
#
# A simple example of converting a Polars dataframe to an xlsx file using
# Polars and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import polars as pl
# Create a Pandas dataframe from some data.
df = pl.DataFrame({"Data": [10, 20, 30, 20, 15, 30, 45]})
# Write the dataframe to a new Excel file.
df.write_excel(workbook="polars_simple.xlsx")

================
File: examples/polars_sparklines.py
================
##############################################################################
#
# An example of writing multiple dataframes to worksheets using Polars and
# XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import polars as pl
df = pl.DataFrame(
    {
        "Zone": ["North", "South", "East", "West", "Central"],
        "Q1": [100, 55, -20, 0, 35],
        "Q2": [30, -10, 15, 60, 20],
        "Q3": [-50, 0, 40, 80, 80],
        "Q4": [75, 55, 25, -10, -55],
    }
)
# Write the dataframe with sparklines and some additional formatting.
df.write_excel(
    workbook="polars_sparklines.xlsx",
    # Set an alternative table style.
    table_style="Table Style Light 2",
    # Specify an Excel number format for integer types.
    dtype_formats={pl.Int32: "#,##0_);(#,##0)"},
    # Configure sparklines to the dataframe.
    sparklines={
        # We use the default options with just  the source columns.
        "Trend": ["Q1", "Q2", "Q3", "Q4"],
        # We also add a customized sparkline type, with a positioning directive.
        "Change": {
            "columns": ["Q1", "Q2", "Q3", "Q4"],
            "insert_after": "Zone",
            "type": "win_loss",
        },
    },
    column_totals=["Q1", "Q2", "Q3", "Q4"],
    # Hide the default gridlines on the worksheet.
    hide_gridlines=True,
)

================
File: examples/polars_xlsxwriter.py
================
##############################################################################
#
# An example of adding a Polars dataframe to a worksheet created by XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import polars as pl
import xlsxwriter
with xlsxwriter.Workbook("polars_xlsxwriter.xlsx") as workbook:
    # Create a new worksheet.
    worksheet = workbook.add_worksheet()
    # Do something with the worksheet.
    worksheet.write("A1", "The data below is added by Polars")
    df = pl.DataFrame({"Data": [10, 20, 30, 20, 15, 30, 45]})
    # Write the Polars data to the worksheet created above, at an offset to
    # avoid overwriting the previous text.
    df.write_excel(workbook=workbook, worksheet="Sheet1", position="A2")

================
File: examples/rich_strings.py
================
#######################################################################
#
# An example of using Python and XlsxWriter to write some "rich strings",
# i.e., strings with multiple formats.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("rich_strings.xlsx")
worksheet = workbook.add_worksheet()
worksheet.set_column("A:A", 30)
# Set up some formats to use.
bold = workbook.add_format({"bold": True})
italic = workbook.add_format({"italic": True})
red = workbook.add_format({"font_color": "red"})
blue = workbook.add_format({"font_color": "blue"})
center = workbook.add_format({"align": "center"})
superscript = workbook.add_format({"font_script": 1})
# Write some strings with multiple formats.
worksheet.write_rich_string(
    "A1", "This is ", bold, "bold", " and this is ", italic, "italic"
)
worksheet.write_rich_string("A3", "This is ", red, "red", " and this is ", blue, "blue")
worksheet.write_rich_string("A5", "Some ", bold, "bold text", " centered", center)
worksheet.write_rich_string("A7", italic, "j = k", superscript, "(n-1)", center)
# If you have formats and segments in a list you can add them like this:
segments = ["This is ", bold, "bold", " and this is ", blue, "blue"]
worksheet.write_rich_string("A9", *segments)
workbook.close()

================
File: examples/right_to_left.py
================
#######################################################################
#
# Example of how to use Python and the XlsxWriter module to change the default
# worksheet and cell text direction from left-to-right to right-to-left as
# required by some middle eastern versions of Excel.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("right_to_left.xlsx")
# Add two worksheets.
worksheet1 = workbook.add_worksheet()
worksheet2 = workbook.add_worksheet()
# Add the cell formats.
format_left_to_right = workbook.add_format({"reading_order": 1})
format_right_to_left = workbook.add_format({"reading_order": 2})
# Make the columns wider for clarity.
worksheet1.set_column("A:A", 25)
worksheet2.set_column("A:A", 25)
# Change the direction for worksheet2.
worksheet2.right_to_left()
# Write some data to show the difference.
# Standard direction:         | A1 | B1 | C1 | ...
worksheet1.write("A1", "  / English text")  # Default direction.
worksheet1.write("A2", "  / English text", format_left_to_right)
worksheet1.write("A3", "  / English text", format_right_to_left)
# Right to left direction:    ... | C1 | B1 | A1 |
worksheet2.write("A1", "  / English text")  # Default direction.
worksheet2.write("A2", "  / English text", format_left_to_right)
worksheet2.write("A3", "  / English text", format_right_to_left)
workbook.close()

================
File: examples/sensitivity_label.py
================
##############################################################################
#
# An example of adding a Sensitivity Label to an XlsxWriter file.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("sensitivity_label.xlsx")
worksheet = workbook.add_worksheet()
# Metadata extracted from a company specific file.
company_guid = "2096f6a2-d2f7-48be-b329-b73aaa526e5d"
site_id = "cb46c030-1825-4e81-a295-151c039dbf02"
action_id = "88124cf5-1340-457d-90e1-0000a9427c99"
# Add the document properties. Note that these should all be in text format.
workbook.set_custom_property(f"MSIP_Label_{company_guid}_Enabled", "true", "text")
workbook.set_custom_property(
    f"MSIP_Label_{company_guid}_SetDate", "2024-01-01T12:00:00Z", "text"
)
workbook.set_custom_property(f"MSIP_Label_{company_guid}_Method", "Privileged", "text")
workbook.set_custom_property(f"MSIP_Label_{company_guid}_Name", "Confidential", "text")
workbook.set_custom_property(f"MSIP_Label_{company_guid}_SiteId", site_id, "text")
workbook.set_custom_property(f"MSIP_Label_{company_guid}_ActionId", action_id, "text")
workbook.set_custom_property(f"MSIP_Label_{company_guid}_ContentBits", "2", "text")
workbook.close()

================
File: examples/sparklines1.py
================
###############################################################################
#
# Example of how to add sparklines to a Python XlsxWriter file.
#
# Sparklines are small charts that fit in a single cell and are
# used to show trends in data.
#
# See sparklines2.py for examples of more complex sparkline formatting.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("sparklines1.xlsx")
worksheet = workbook.add_worksheet()
# Some sample data to plot.
data = [
    [-2, 2, 3, -1, 0],
    [30, 20, 33, 20, 15],
    [1, -1, -1, 1, -1],
]
# Write the sample data to the worksheet.
worksheet.write_row("A1", data[0])
worksheet.write_row("A2", data[1])
worksheet.write_row("A3", data[2])
# Add a line sparkline (the default) with markers.
worksheet.add_sparkline("F1", {"range": "Sheet1!A1:E1", "markers": True})
# Add a column sparkline with non-default style.
worksheet.add_sparkline("F2", {"range": "Sheet1!A2:E2", "type": "column", "style": 12})
# Add a win/loss sparkline with negative values highlighted.
worksheet.add_sparkline(
    "F3", {"range": "Sheet1!A3:E3", "type": "win_loss", "negative_points": True}
)
workbook.close()

================
File: examples/sparklines2.py
================
###############################################################################
#
# Example of how to add sparklines to an XlsxWriter file with Python.
#
# Sparklines are small charts that fit in a single cell and are
# used to show trends in data. This example shows the majority of
# options that can be applied to sparklines.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("sparklines2.xlsx")
worksheet1 = workbook.add_worksheet()
worksheet2 = workbook.add_worksheet()
bold = workbook.add_format({"bold": True})
row = 1
# Set the columns widths to make the output clearer.
worksheet1.set_column("A:A", 14)
worksheet1.set_column("B:B", 50)
worksheet1.set_zoom(150)
# Headings.
worksheet1.write("A1", "Sparkline", bold)
worksheet1.write("B1", "Description", bold)
###############################################################################
#
text = 'A default "line" sparkline.'
worksheet1.add_sparkline("A2", {"range": "Sheet2!A1:J1"})
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = 'A default "column" sparkline.'
worksheet1.add_sparkline("A3", {"range": "Sheet2!A2:J2", "type": "column"})
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = 'A default "win/loss" sparkline.'
worksheet1.add_sparkline("A4", {"range": "Sheet2!A3:J3", "type": "win_loss"})
worksheet1.write(row, 1, text)
row += 2
###############################################################################
#
text = "Line with markers."
worksheet1.add_sparkline("A6", {"range": "Sheet2!A1:J1", "markers": True})
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = "Line with high and low points."
worksheet1.add_sparkline(
    "A7", {"range": "Sheet2!A1:J1", "high_point": True, "low_point": True}
)
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = "Line with first and last point markers."
worksheet1.add_sparkline(
    "A8", {"range": "Sheet2!A1:J1", "first_point": True, "last_point": True}
)
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = "Line with negative point markers."
worksheet1.add_sparkline("A9", {"range": "Sheet2!A1:J1", "negative_points": True})
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = "Line with axis."
worksheet1.add_sparkline("A10", {"range": "Sheet2!A1:J1", "axis": True})
worksheet1.write(row, 1, text)
row += 2
###############################################################################
#
text = "Column with default style (1)."
worksheet1.add_sparkline("A12", {"range": "Sheet2!A2:J2", "type": "column"})
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = "Column with style 2."
worksheet1.add_sparkline("A13", {"range": "Sheet2!A2:J2", "type": "column", "style": 2})
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = "Column with style 3."
worksheet1.add_sparkline("A14", {"range": "Sheet2!A2:J2", "type": "column", "style": 3})
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = "Column with style 4."
worksheet1.add_sparkline("A15", {"range": "Sheet2!A2:J2", "type": "column", "style": 4})
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = "Column with style 5."
worksheet1.add_sparkline("A16", {"range": "Sheet2!A2:J2", "type": "column", "style": 5})
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = "Column with style 6."
worksheet1.add_sparkline("A17", {"range": "Sheet2!A2:J2", "type": "column", "style": 6})
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = "Column with a user defined color."
worksheet1.add_sparkline(
    "A18", {"range": "Sheet2!A2:J2", "type": "column", "series_color": "#E965E0"}
)
worksheet1.write(row, 1, text)
row += 2
###############################################################################
#
text = "A win/loss sparkline."
worksheet1.add_sparkline("A20", {"range": "Sheet2!A3:J3", "type": "win_loss"})
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = "A win/loss sparkline with negative points highlighted."
worksheet1.add_sparkline(
    "A21", {"range": "Sheet2!A3:J3", "type": "win_loss", "negative_points": True}
)
worksheet1.write(row, 1, text)
row += 2
###############################################################################
#
text = "A left to right column (the default)."
worksheet1.add_sparkline(
    "A23", {"range": "Sheet2!A4:J4", "type": "column", "style": 20}
)
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = "A right to left column."
worksheet1.add_sparkline(
    "A24", {"range": "Sheet2!A4:J4", "type": "column", "style": 20, "reverse": True}
)
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
text = "Sparkline and text in one cell."
worksheet1.add_sparkline(
    "A25", {"range": "Sheet2!A4:J4", "type": "column", "style": 20}
)
worksheet1.write(row, 0, "Growth")
worksheet1.write(row, 1, text)
row += 2
###############################################################################
#
text = "A grouped sparkline. Changes are applied to all three."
worksheet1.add_sparkline(
    "A27",
    {
        "location": ["A27", "A28", "A29"],
        "range": ["Sheet2!A5:J5", "Sheet2!A6:J6", "Sheet2!A7:J7"],
        "markers": True,
    },
)
worksheet1.write(row, 1, text)
row += 1
###############################################################################
#
# Create a second worksheet with data to plot.
#
worksheet2.set_column("A:J", 11)
data = [
    # Simple line data.
    [-2, 2, 3, -1, 0, -2, 3, 2, 1, 0],
    # Simple column data.
    [30, 20, 33, 20, 15, 5, 5, 15, 10, 15],
    # Simple win/loss data.
    [1, 1, -1, -1, 1, -1, 1, 1, 1, -1],
    # Unbalanced histogram.
    [5, 6, 7, 10, 15, 20, 30, 50, 70, 100],
    # Data for the grouped sparkline example.
    [-2, 2, 3, -1, 0, -2, 3, 2, 1, 0],
    [3, -1, 0, -2, 3, 2, 1, 0, 2, 1],
    [0, -2, 3, 2, 1, 0, 1, 2, 3, 1],
]
# Write the sample data to the worksheet.
worksheet2.write_row("A1", data[0])
worksheet2.write_row("A2", data[1])
worksheet2.write_row("A3", data[2])
worksheet2.write_row("A4", data[3])
worksheet2.write_row("A5", data[4])
worksheet2.write_row("A6", data[5])
worksheet2.write_row("A7", data[6])
workbook.close()

================
File: examples/tab_colors.py
================
#######################################################################
#
# Example of how to set Excel worksheet tab colors using Python
# and the XlsxWriter module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("tab_colors.xlsx")
# Set up some worksheets.
worksheet1 = workbook.add_worksheet()
worksheet2 = workbook.add_worksheet()
worksheet3 = workbook.add_worksheet()
worksheet4 = workbook.add_worksheet()
# Set tab colors
worksheet1.set_tab_color("red")
worksheet2.set_tab_color("green")
worksheet3.set_tab_color("#FF9900")  # Orange
# worksheet4 will have the default color.
workbook.close()

================
File: examples/tables.py
================
###############################################################################
#
# Example of how to add tables to an XlsxWriter worksheet.
#
# Tables in Excel are used to group rows and columns of data into a single
# structure that can be referenced in a formula or formatted collectively.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("tables.xlsx")
worksheet1 = workbook.add_worksheet()
worksheet2 = workbook.add_worksheet()
worksheet3 = workbook.add_worksheet()
worksheet4 = workbook.add_worksheet()
worksheet5 = workbook.add_worksheet()
worksheet6 = workbook.add_worksheet()
worksheet7 = workbook.add_worksheet()
worksheet8 = workbook.add_worksheet()
worksheet9 = workbook.add_worksheet()
worksheet10 = workbook.add_worksheet()
worksheet11 = workbook.add_worksheet()
worksheet12 = workbook.add_worksheet()
worksheet13 = workbook.add_worksheet()
currency_format = workbook.add_format({"num_format": "$#,##0"})
# Some sample data for the table.
data = [
    ["Apples", 10000, 5000, 8000, 6000],
    ["Pears", 2000, 3000, 4000, 5000],
    ["Bananas", 6000, 6000, 6500, 6000],
    ["Oranges", 500, 300, 200, 700],
]
###############################################################################
#
# Example 1.
#
caption = "Default table with no data."
# Set the columns widths.
worksheet1.set_column("B:G", 12)
# Write the caption.
worksheet1.write("B1", caption)
# Add a table to the worksheet.
worksheet1.add_table("B3:F7")
###############################################################################
#
# Example 2.
#
caption = "Default table with data."
# Set the columns widths.
worksheet2.set_column("B:G", 12)
# Write the caption.
worksheet2.write("B1", caption)
# Add a table to the worksheet.
worksheet2.add_table("B3:F7", {"data": data})
###############################################################################
#
# Example 3.
#
caption = "Table without default autofilter."
# Set the columns widths.
worksheet3.set_column("B:G", 12)
# Write the caption.
worksheet3.write("B1", caption)
# Add a table to the worksheet.
worksheet3.add_table("B3:F7", {"autofilter": 0})
# Table data can also be written separately, as an array or individual cells.
worksheet3.write_row("B4", data[0])
worksheet3.write_row("B5", data[1])
worksheet3.write_row("B6", data[2])
worksheet3.write_row("B7", data[3])
###############################################################################
#
# Example 4.
#
caption = "Table without default header row."
# Set the columns widths.
worksheet4.set_column("B:G", 12)
# Write the caption.
worksheet4.write("B1", caption)
# Add a table to the worksheet.
worksheet4.add_table("B4:F7", {"header_row": 0})
# Table data can also be written separately, as an array or individual cells.
worksheet4.write_row("B4", data[0])
worksheet4.write_row("B5", data[1])
worksheet4.write_row("B6", data[2])
worksheet4.write_row("B7", data[3])
###############################################################################
#
# Example 5.
#
caption = 'Default table with "First Column" and "Last Column" options.'
# Set the columns widths.
worksheet5.set_column("B:G", 12)
# Write the caption.
worksheet5.write("B1", caption)
# Add a table to the worksheet.
worksheet5.add_table("B3:F7", {"first_column": 1, "last_column": 1})
# Table data can also be written separately, as an array or individual cells.
worksheet5.write_row("B4", data[0])
worksheet5.write_row("B5", data[1])
worksheet5.write_row("B6", data[2])
worksheet5.write_row("B7", data[3])
###############################################################################
#
# Example 6.
#
caption = "Table with banded columns but without default banded rows."
# Set the columns widths.
worksheet6.set_column("B:G", 12)
# Write the caption.
worksheet6.write("B1", caption)
# Add a table to the worksheet.
worksheet6.add_table("B3:F7", {"banded_rows": 0, "banded_columns": 1})
# Table data can also be written separately, as an array or individual cells.
worksheet6.write_row("B4", data[0])
worksheet6.write_row("B5", data[1])
worksheet6.write_row("B6", data[2])
worksheet6.write_row("B7", data[3])
###############################################################################
#
# Example 7.
#
caption = "Table with user defined column headers."
# Set the columns widths.
worksheet7.set_column("B:G", 12)
# Write the caption.
worksheet7.write("B1", caption)
# Add a table to the worksheet.
worksheet7.add_table(
    "B3:F7",
    {
        "data": data,
        "columns": [
            {"header": "Product"},
            {"header": "Quarter 1"},
            {"header": "Quarter 2"},
            {"header": "Quarter 3"},
            {"header": "Quarter 4"},
        ],
    },
)
###############################################################################
#
# Example 8.
#
caption = "Table with user defined column headers."
# Set the columns widths.
worksheet8.set_column("B:G", 12)
# Write the caption.
worksheet8.write("B1", caption)
# Formula to use in the table.
formula = "=SUM(Table8[@[Quarter 1]:[Quarter 4]])"
# Add a table to the worksheet.
worksheet8.add_table(
    "B3:G7",
    {
        "data": data,
        "columns": [
            {"header": "Product"},
            {"header": "Quarter 1"},
            {"header": "Quarter 2"},
            {"header": "Quarter 3"},
            {"header": "Quarter 4"},
            {"header": "Year", "formula": formula},
        ],
    },
)
###############################################################################
#
# Example 9.
#
caption = "Table with totals row (but no caption or totals)."
# Set the columns widths.
worksheet9.set_column("B:G", 12)
# Write the caption.
worksheet9.write("B1", caption)
# Formula to use in the table.
formula = "=SUM(Table9[@[Quarter 1]:[Quarter 4]])"
# Add a table to the worksheet.
worksheet9.add_table(
    "B3:G8",
    {
        "data": data,
        "total_row": 1,
        "columns": [
            {"header": "Product"},
            {"header": "Quarter 1"},
            {"header": "Quarter 2"},
            {"header": "Quarter 3"},
            {"header": "Quarter 4"},
            {"header": "Year", "formula": formula},
        ],
    },
)
###############################################################################
#
# Example 10.
#
caption = "Table with totals row with user captions and functions."
# Set the columns widths.
worksheet10.set_column("B:G", 12)
# Write the caption.
worksheet10.write("B1", caption)
# Options to use in the table.
options = {
    "data": data,
    "total_row": 1,
    "columns": [
        {"header": "Product", "total_string": "Totals"},
        {"header": "Quarter 1", "total_function": "sum"},
        {"header": "Quarter 2", "total_function": "sum"},
        {"header": "Quarter 3", "total_function": "sum"},
        {"header": "Quarter 4", "total_function": "sum"},
        {
            "header": "Year",
            "formula": "=SUM(Table10[@[Quarter 1]:[Quarter 4]])",
            "total_function": "sum",
        },
    ],
}
# Add a table to the worksheet.
worksheet10.add_table("B3:G8", options)
###############################################################################
#
# Example 11.
#
caption = "Table with alternative Excel style."
# Set the columns widths.
worksheet11.set_column("B:G", 12)
# Write the caption.
worksheet11.write("B1", caption)
# Options to use in the table.
options = {
    "data": data,
    "style": "Table Style Light 11",
    "total_row": 1,
    "columns": [
        {"header": "Product", "total_string": "Totals"},
        {"header": "Quarter 1", "total_function": "sum"},
        {"header": "Quarter 2", "total_function": "sum"},
        {"header": "Quarter 3", "total_function": "sum"},
        {"header": "Quarter 4", "total_function": "sum"},
        {
            "header": "Year",
            "formula": "=SUM(Table11[@[Quarter 1]:[Quarter 4]])",
            "total_function": "sum",
        },
    ],
}
# Add a table to the worksheet.
worksheet11.add_table("B3:G8", options)
###############################################################################
#
# Example 12.
#
caption = "Table with Excel style removed."
# Set the columns widths.
worksheet12.set_column("B:G", 12)
# Write the caption.
worksheet12.write("B1", caption)
# Options to use in the table.
options = {
    "data": data,
    "style": None,
    "total_row": 1,
    "columns": [
        {"header": "Product", "total_string": "Totals"},
        {"header": "Quarter 1", "total_function": "sum"},
        {"header": "Quarter 2", "total_function": "sum"},
        {"header": "Quarter 3", "total_function": "sum"},
        {"header": "Quarter 4", "total_function": "sum"},
        {
            "header": "Year",
            "formula": "=SUM(Table12[@[Quarter 1]:[Quarter 4]])",
            "total_function": "sum",
        },
    ],
}
# Add a table to the worksheet.
worksheet12.add_table("B3:G8", options)
###############################################################################
#
# Example 13.
#
caption = "Table with column formats."
# Set the columns widths.
worksheet13.set_column("B:G", 12)
# Write the caption.
worksheet13.write("B1", caption)
# Options to use in the table.
options = {
    "data": data,
    "total_row": 1,
    "columns": [
        {"header": "Product", "total_string": "Totals"},
        {
            "header": "Quarter 1",
            "total_function": "sum",
            "format": currency_format,
        },
        {
            "header": "Quarter 2",
            "total_function": "sum",
            "format": currency_format,
        },
        {
            "header": "Quarter 3",
            "total_function": "sum",
            "format": currency_format,
        },
        {
            "header": "Quarter 4",
            "total_function": "sum",
            "format": currency_format,
        },
        {
            "header": "Year",
            "formula": "=SUM(Table13[@[Quarter 1]:[Quarter 4]])",
            "total_function": "sum",
            "format": currency_format,
        },
    ],
}
# Add a table to the worksheet.
worksheet13.add_table("B3:G8", options)
workbook.close()

================
File: examples/text_indent.py
================
##############################################################################
#
# A simple formatting example using XlsxWriter.
#
# This program demonstrates the indentation cell format.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("text_indent.xlsx")
worksheet = workbook.add_worksheet()
indent1 = workbook.add_format({"indent": 1})
indent2 = workbook.add_format({"indent": 2})
worksheet.set_column("A:A", 40)
worksheet.write("A1", "This text is indented 1 level", indent1)
worksheet.write("A2", "This text is indented 2 levels", indent2)
workbook.close()

================
File: examples/textbox.py
================
#######################################################################
#
# An example of inserting textboxes into an Excel worksheet using
# Python and XlsxWriter.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("textbox.xlsx")
worksheet = workbook.add_worksheet()
row = 4
col = 1
# The examples below show different textbox options and formatting. In each
# example the text describes the formatting.
# Example
text = "A simple textbox with some text"
worksheet.insert_textbox(row, col, text)
row += 10
# Example
text = "A textbox with changed dimensions"
options = {
    "width": 256,
    "height": 100,
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "A textbox with an offset in the cell"
options = {
    "x_offset": 10,
    "y_offset": 10,
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "A textbox with scaling"
options = {
    "x_scale": 1.5,
    "y_scale": 0.8,
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "A textbox with some long text that wraps around onto several lines"
worksheet.insert_textbox(row, col, text)
row += 10
# Example
text = "A textbox\nwith some\nnewlines\n\nand paragraphs"
worksheet.insert_textbox(row, col, text)
row += 10
# Example
text = "A textbox with a solid fill background"
options = {
    "fill": {"color": "red"},
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "A textbox with a no fill background"
options = {
    "fill": {"none": True},
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "A textbox with a gradient fill background"
options = {
    "gradient": {"colors": ["#DDEBCF", "#9CB86E", "#156B13"]},
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "A textbox with a user defined border line"
options = {
    "border": {"color": "red", "width": 3, "dash_type": "round_dot"},
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "A textbox with no border line"
options = {
    "border": {"none": True},
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "Default alignment: top - left"
worksheet.insert_textbox(row, col, text)
row += 10
# Example
text = "Alignment: top - center"
options = {
    "align": {"horizontal": "center"},
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "Alignment: middle - center"
options = {
    "align": {"vertical": "middle", "horizontal": "center"},
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "Alignment: long text line that wraps and is centered"
options = {
    "align": {"vertical": "middle", "horizontal": "center", "text": "center"},
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "Font properties: bold"
options = {
    "font": {"bold": True},
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "Font properties: various"
options = {
    "font": {"bold": True},
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "Font properties: various"
options = {
    "font": {
        "bold": True,
        "italic": True,
        "underline": True,
        "name": "Arial",
        "color": "red",
        "size": 12,
    }
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "Some text in a textbox with formatting"
options = {
    "font": {"color": "white"},
    "align": {"vertical": "middle", "horizontal": "center"},
    "gradient": {"colors": ["red", "blue"]},
}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = ""
options = {
    "textlink": "=$F$185",
}
worksheet.write("F185", "Text in a cell")
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "Text rotated up"
options = {"text_rotation": 90}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "Text rotated down"
options = {"text_rotation": -90}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "Text rotated vertically"
options = {"text_rotation": 270}
worksheet.insert_textbox(row, col, text, options)
row += 10
# Example
text = "Textbox with hyperlink"
options = {"url": "https://github.com/jmcnamara", "tip": "GitHub"}
worksheet.insert_textbox(row, col, text, options)
row += 10
workbook.close()

================
File: examples/tutorial1.py
================
##############################################################################
#
# A simple program to write some data to an Excel file using the XlsxWriter
# Python module.
#
# This program is shown, with explanations, in Tutorial 1 of the XlsxWriter
# documentation.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create a workbook and add a worksheet.
workbook = xlsxwriter.Workbook("Expenses01.xlsx")
worksheet = workbook.add_worksheet()
# Some data we want to write to the worksheet.
expenses = (
    ["Rent", 1000],
    ["Gas", 100],
    ["Food", 300],
    ["Gym", 50],
)
# Start from the first cell. Rows and columns are zero indexed.
row = 0
col = 0
# Iterate over the data and write it out row by row.
for item, cost in expenses:
    worksheet.write(row, col, item)
    worksheet.write(row, col + 1, cost)
    row += 1
# Write a total using a formula.
worksheet.write(row, 0, "Total")
worksheet.write(row, 1, "=SUM(B1:B4)")
workbook.close()

================
File: examples/tutorial2.py
================
##############################################################################
#
# A simple program to write some data to an Excel file using the XlsxWriter
# Python module.
#
# This program is shown, with explanations, in Tutorial 2 of the XlsxWriter
# documentation.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create a workbook and add a worksheet.
workbook = xlsxwriter.Workbook("Expenses02.xlsx")
worksheet = workbook.add_worksheet()
# Add a bold format to use to highlight cells.
bold = workbook.add_format({"bold": True})
# Add a number format for cells with money.
money = workbook.add_format({"num_format": "$#,##0"})
# Write some data header.
worksheet.write("A1", "Item", bold)
worksheet.write("B1", "Cost", bold)
# Some data we want to write to the worksheet.
expenses = (
    ["Rent", 1000],
    ["Gas", 100],
    ["Food", 300],
    ["Gym", 50],
)
# Start from the first cell below the headers.
row = 1
col = 0
# Iterate over the data and write it out row by row.
for item, cost in expenses:
    worksheet.write(row, col, item)
    worksheet.write(row, col + 1, cost, money)
    row += 1
# Write a total using a formula.
worksheet.write(row, 0, "Total", bold)
worksheet.write(row, 1, "=SUM(B2:B5)", money)
workbook.close()

================
File: examples/tutorial3.py
================
##############################################################################
#
# A simple program to write some data to an Excel file using the XlsxWriter
# Python module.
#
# This program is shown, with explanations, in Tutorial 3 of the XlsxWriter
# documentation.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
from datetime import datetime
import xlsxwriter
# Create a workbook and add a worksheet.
workbook = xlsxwriter.Workbook("Expenses03.xlsx")
worksheet = workbook.add_worksheet()
# Add a bold format to use to highlight cells.
bold = workbook.add_format({"bold": 1})
# Add a number format for cells with money.
money_format = workbook.add_format({"num_format": "$#,##0"})
# Add an Excel date format.
date_format = workbook.add_format({"num_format": "mmmm d yyyy"})
# Adjust the column width.
worksheet.set_column(1, 1, 15)
# Write some data headers.
worksheet.write("A1", "Item", bold)
worksheet.write("B1", "Date", bold)
worksheet.write("C1", "Cost", bold)
# Some data we want to write to the worksheet.
expenses = (
    ["Rent", "2013-01-13", 1000],
    ["Gas", "2013-01-14", 100],
    ["Food", "2013-01-16", 300],
    ["Gym", "2013-01-20", 50],
)
# Start from the first cell below the headers.
row = 1
col = 0
for item, date_str, cost in expenses:
    # Convert the date string into a datetime object.
    date = datetime.strptime(date_str, "%Y-%m-%d")
    worksheet.write_string(row, col, item)
    worksheet.write_datetime(row, col + 1, date, date_format)
    worksheet.write_number(row, col + 2, cost, money_format)
    row += 1
# Write a total using a formula.
worksheet.write(row, 0, "Total", bold)
worksheet.write(row, 2, "=SUM(C2:C5)", money_format)
workbook.close()

================
File: examples/unicode_polish_utf8.py
================
##############################################################################
#
# A simple example of converting some Unicode text to an Excel file using
# the XlsxWriter Python module.
#
# This example generates a spreadsheet with some Polish text from a file
# with UTF8 encoded text.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Open the input file with the correct encoding.
with open("unicode_polish_utf8.txt", mode="r", encoding="utf-8") as textfile:
    # Create an new Excel file and convert the text data.
    workbook = xlsxwriter.Workbook("unicode_polish_utf8.xlsx")
    worksheet = workbook.add_worksheet()
    # Widen the first column to make the text clearer.
    worksheet.set_column("A:A", 50)
    # Start from the first cell.
    row = 0
    col = 0
    # Read the text file and write it to the worksheet.
    for line in textfile:
        # Ignore the comments in the text file.
        if line.startswith("#"):
            continue
        # Write any other lines to the worksheet.
        worksheet.write(row, col, line.rstrip("\n"))
        row += 1
    workbook.close()

================
File: examples/unicode_shift_jis.py
================
##############################################################################
#
# A simple example of converting some Unicode text to an Excel file using
# the XlsxWriter Python module.
#
# This example generates a spreadsheet with some Japanese text from a file
# with Shift-JIS encoded text.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Open the input file with the correct encoding.
with open("unicode_shift_jis.txt", mode="r", encoding="shift_jis") as textfile:
    # Create an new Excel file and convert the text data.
    workbook = xlsxwriter.Workbook("unicode_shift_jis.xlsx")
    worksheet = workbook.add_worksheet()
    # Widen the first column to make the text clearer.
    worksheet.set_column("A:A", 50)
    # Start from the first cell.
    row = 0
    col = 0
    # Read the text file and write it to the worksheet.
    for line in textfile:
        # Ignore the comments in the text file.
        if line.startswith("#"):
            continue
        # Write any other lines to the worksheet.
        worksheet.write(row, col, line.rstrip("\n"))
        row += 1
    workbook.close()

================
File: examples/unicode.py
================
###############################################################################
#
# A simple Unicode spreadsheet in Python 3 using the XlsxWriter Python module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
# To write Unicode text in UTF-8 to a xlsxwriter file in Python 3 you just
# need to encode the file as UTF-8.
import xlsxwriter
workbook = xlsxwriter.Workbook("unicode_python3.xlsx")
worksheet = workbook.add_worksheet()
worksheet.write("B3", "   !")
workbook.close()

================
File: examples/user_types1.py
================
##############################################################################
#
# An example of adding support for user defined types to the XlsxWriter write()
# method.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import uuid
import xlsxwriter
# Create a function that will behave like a worksheet write() method.
#
# This function takes a UUID and writes it as as string. It should take the
# parameters shown below and return the return value from the called worksheet
# write_*() method. In this case it changes the UUID to a string and calls
# write_string() to write it.
#
def write_uuid(worksheet, row, col, token, cell_format=None):
    return worksheet.write_string(row, col, str(token), cell_format)
# Set up the workbook as usual.
workbook = xlsxwriter.Workbook("user_types1.xlsx")
worksheet = workbook.add_worksheet()
# Make the first column wider for clarity.
worksheet.set_column("A:A", 40)
# Add the write() handler/callback to the worksheet.
worksheet.add_write_handler(uuid.UUID, write_uuid)
# Create a UUID.
my_uuid = uuid.uuid3(uuid.NAMESPACE_DNS, "python.org")
# Write the UUID. This would raise a TypeError without the handler.
worksheet.write("A1", my_uuid)
workbook.close()

================
File: examples/user_types2.py
================
##############################################################################
#
# An example of adding support for user defined types to the XlsxWriter write()
# method.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import math
import xlsxwriter
# Create a function that will behave like a worksheet write() method.
#
# This function takes a float and if it is NaN then it writes a blank cell
# instead. It should take the parameters shown below and return the return
# value from the called worksheet write_*() method.
#
def ignore_nan(worksheet, row, col, number, cell_format=None):
    if math.isnan(number):
        return worksheet.write_blank(row, col, None, cell_format)
    else:
        # Return control to the calling write() method for any other number.
        return None
# Set up the workbook as usual.
workbook = xlsxwriter.Workbook("user_types2.xlsx")
worksheet = workbook.add_worksheet()
# Add the write() handler/callback to the worksheet.
worksheet.add_write_handler(float, ignore_nan)
# Create some data to write.
my_data = [1, 2, float("nan"), 4, 5]
# Write the data. Note that write_row() calls write() so this will work as
# expected. Writing NaN values would raise a TypeError without the handler.
worksheet.write_row("A1", my_data)
workbook.close()

================
File: examples/user_types3.py
================
##############################################################################
#
# An example of adding support for user defined types to the XlsxWriter write()
# method.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
# Create a function that changes the worksheet write() method so that it
# hides/replaces user passwords when writing string data. The password data,
# based on the sample data structure, will be data in the second column, apart
# from the header row.
def hide_password(worksheet, row, col, string, cell_format=None):
    if col == 1 and row > 0:
        return worksheet.write_string(row, col, "****", cell_format)
    else:
        return worksheet.write_string(row, col, string, cell_format)
# Set up the workbook as usual.
workbook = xlsxwriter.Workbook("user_types3.xlsx")
worksheet = workbook.add_worksheet()
# Make the headings in the first row bold.
bold = workbook.add_format({"bold": True})
worksheet.set_row(0, None, bold)
# Add the write() handler/callback to the worksheet.
worksheet.add_write_handler(str, hide_password)
# Create some data to write.
my_data = [
    ["Name", "Password", "City"],
    ["Sara", "$5%^6&", "Rome"],
    ["Michele", "123abc", "Milano"],
    ["Maria", "juvexme", "Torino"],
    ["Paolo", "qwerty", "Fano"],
]
# Write the data. Note that write_row() calls write() so this will work as
# expected.
for row_num, row_data in enumerate(my_data):
    worksheet.write_row(row_num, 0, row_data)
workbook.close()

================
File: examples/vba_extract.py
================
#!python
##############################################################################
#
# vba_extract - A simple utility to extract a vbaProject.bin binary from an
# Excel 2007+ xlsm file for insertion into an XlsxWriter file.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import sys
from zipfile import BadZipFile, ZipFile
def extract_file(xlsm_zip, filename):
    # Extract a single file from an Excel xlsm macro file.
    data = xlsm_zip.read("xl/" + filename)
    # Write the data to a local file.
    file = open(filename, "wb")
    file.write(data)
    file.close()
# The VBA project file and project signature file we want to extract.
vba_filename = "vbaProject.bin"
vba_signature_filename = "vbaProjectSignature.bin"
# Get the xlsm file name from the commandline.
if len(sys.argv) > 1:
    xlsm_file = sys.argv[1]
else:
    print(
        "\nUtility to extract a vbaProject.bin binary from an Excel 2007+ "
        "xlsm macro file for insertion into an XlsxWriter file.\n"
        "If the macros are digitally signed, extracts also a vbaProjectSignature.bin "
        "file.\n"
        "\n"
        "See: https://xlsxwriter.readthedocs.io/working_with_macros.html\n"
        "\n"
        "Usage: vba_extract file.xlsm\n"
    )
    sys.exit()
try:
    # Open the Excel xlsm file as a zip file.
    xlsm_zip = ZipFile(xlsm_file, "r")
    # Read the xl/vbaProject.bin file.
    extract_file(xlsm_zip, vba_filename)
    print(f"Extracted: {vba_filename}")
    if "xl/" + vba_signature_filename in xlsm_zip.namelist():
        extract_file(xlsm_zip, vba_signature_filename)
        print(f"Extracted: {vba_signature_filename}")
except IOError as e:
    print(f"File error: {str(e)}")
    sys.exit()
except KeyError as e:
    # Usually when there isn't a xl/vbaProject.bin member in the file.
    print(f"File error: {str(e)}")
    print(f"File may not be an Excel xlsm macro file: '{xlsm_file}'")
    sys.exit()
except BadZipFile as e:
    # Usually if the file is an xls file and not an xlsm file.
    print(f"File error: {str(e)}: '{xlsm_file}'")
    print("File may not be an Excel xlsm macro file.")
    sys.exit()
except Exception as e:
    # Catch any other exceptions.
    print(f"File error: {str(e)}")
    sys.exit()

================
File: examples/watermark.py
================
##############################################################################
#
# An example of adding a worksheet watermark image using the XlsxWriter Python
# module. This is based on the method of putting an image in the worksheet
# header as suggested in the Microsoft documentation:
# https://support.microsoft.com/en-us/office/add-a-watermark-in-excel-a372182a-d733-484e-825c-18ddf3edf009
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("watermark.xlsx")
worksheet = workbook.add_worksheet()
# Set a worksheet header with the watermark image.
worksheet.set_header("&C&[Picture]", {"image_center": "watermark.png"})
workbook.close()

================
File: examples/worksheet_protection.py
================
########################################################################
#
# Example of cell locking and formula hiding in an Excel worksheet
# using Python and the XlsxWriter module.
#
# SPDX-License-Identifier: BSD-2-Clause
#
# Copyright (c) 2013-2025, John McNamara, jmcnamara@cpan.org
#
import xlsxwriter
workbook = xlsxwriter.Workbook("protection.xlsx")
worksheet = workbook.add_worksheet()
# Create some cell formats with protection properties.
unlocked = workbook.add_format({"locked": False})
hidden = workbook.add_format({"hidden": True})
# Format the columns to make the text more visible.
worksheet.set_column("A:A", 40)
# Turn worksheet protection on.
worksheet.protect()
# Write a locked, unlocked and hidden cell.
worksheet.write("A1", "Cell B1 is locked. It cannot be edited.")
worksheet.write("A2", "Cell B2 is unlocked. It can be edited.")
worksheet.write("A3", "Cell B3 is hidden. The formula isn't visible.")
worksheet.write_formula("B1", "=1+2")  # Locked by default.
worksheet.write_formula("B2", "=1+2", unlocked)
worksheet.write_formula("B3", "=1+2", hidden)
workbook.close()





================================================================
End of Codebase
================================================================
