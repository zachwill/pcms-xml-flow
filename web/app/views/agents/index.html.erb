<% directory_scope = @directory_kind.to_s == "agencies" ? "agencies" : "agents" %>
<% content_for :title, directory_scope == "agencies" ? "Agencies" : "Agents" %>

<div
  id="agents-workspace"
  class="h-screen w-screen flex flex-col overflow-hidden bg-background"
  data-signals="{
    agentquery: <%= @query.to_json %>,
    entitykind: '<%= @directory_kind %>',
    activeonly: <%= @active_only ? 'true' : 'false' %>,
    certifiedonly: <%= @certified_only ? 'true' : 'false' %>,
    withclients: <%= @with_clients ? 'true' : 'false' %>,
    withbook: <%= @with_book ? 'true' : 'false' %>,
    withrestrictions: <%= @with_restrictions ? 'true' : 'false' %>,
    withexpiring: <%= @with_expiring ? 'true' : 'false' %>,
    agencyscopeactive: <%= @agency_scope_active ? 'true' : 'false' %>,
    agencyscopeid: '<%= @agency_scope_id %>',
    bookyear: '<%= @book_year %>',
    sortkey: '<%= @sort_key %>',
    sortdir: '<%= @sort_dir %>',
    overlaytype: 'none',
    overlayid: ''
  }"
>
  <%= render partial: "agents/commandbar" %>

  <div id="viewport" class="flex flex-1 overflow-hidden relative">
    <main id="maincanvas" class="flex-1 min-w-0 overflow-y-auto overflow-x-hidden bg-background">
      <%= render partial: "agents/workspace_main" %>
    </main>

    <aside
      id="rightpanel"
      class="w-[30%] min-w-[320px] max-w-[480px] border-l border-border bg-background overflow-hidden relative"
    >
      <div
        id="rightpanel-base-layer"
        class="absolute inset-0 overflow-y-auto overflow-x-hidden overscroll-y-contain scroll-touch pt-2 px-4 pb-4"
      >
        <%= render partial: "agents/rightpanel_base" %>
      </div>

      <div id="rightpanel-overlay"></div>
    </aside>
  </div>
</div>
