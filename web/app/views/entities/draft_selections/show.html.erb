<% content_for :title, "Draft selection" %>

<% ds = @draft_selection %>
<% pick_label = "#{ds['draft_year']} — R#{ds['draft_round']} P#{ds['pick_number']}" %>
<% player_name = ds["player_name"].to_s %>
<% drafting_team_code = ds["drafting_team_code"].to_s %>

<main class="max-w-5xl mx-auto px-4 py-6 space-y-6">
  <%= render partial: "entities/shared/entity_header", locals: {
    title: pick_label,
    subtitle: ((player_name.present? ? "#{player_name} · " : "") + "transaction_id: #{@draft_selection_id} · slug: #{@draft_selection_slug}" + (ds["transaction_date"].present? ? " · date: #{ds['transaction_date']}" : "")),
    breadcrumbs: [["Draft selections", "/draft-selections"], [pick_label, nil]],
    search_scope: "players",
    search_query: "",
    search_placeholder: "Search players/teams/agents/agencies…",
    salary_book_label: "Open Salary Book",
    right_links: [["Find player", "/players"]]
  } %>

  <section class="space-y-3">
    <h2 class="text-xs font-medium uppercase tracking-wide text-muted-foreground">Connections</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <div class="p-4 rounded-lg border border-border bg-background">
        <div class="text-xs text-muted-foreground">Player</div>
        <div class="mt-1">
          <a href="<%= player_href(ds['player_id']) %>" class="font-medium hover:underline"><%= player_name.presence || ds['player_id'] %></a>
        </div>
      </div>

      <div class="p-4 rounded-lg border border-border bg-background">
        <div class="text-xs text-muted-foreground">Drafting team</div>
        <% if ds["drafting_team_id"].present? %>
          <div class="mt-1">
            <a href="<%= team_href(team_code: drafting_team_code, team_id: ds['drafting_team_id']) %>" class="font-medium hover:underline"><%= drafting_team_code.presence || "—" %></a>
            <% if ds["team_name"].present? %>
              <div class="text-sm text-muted-foreground"><%= ds["team_name"] %></div>
            <% end %>
          </div>
        <% else %>
          <div class="mt-1 text-sm text-muted-foreground italic">Unknown</div>
        <% end %>
      </div>
    </div>
  </section>

  <section class="space-y-3">
    <h2 class="text-xs font-medium uppercase tracking-wide text-muted-foreground">Raw fields</h2>

    <div class="p-4 rounded-lg border border-border bg-background text-sm text-muted-foreground space-y-1">
      <div>draft_amount: <code><%= ds["draft_amount"] || "—" %></code></div>
      <div>drafting_team_id: <code><%= ds["drafting_team_id"] || "—" %></code></div>
      <div>drafting_team_code: <code><%= drafting_team_code.presence || "—" %></code></div>
    </div>
  </section>

  <%= render partial: "entities/shared/known_slugs", locals: { entity_type: "draft_selection", entity_id: @draft_selection_id, path_prefix: "draft-selections" } %>
</main>
