# Design Evolution Backlog (`web/`)

North star:
- Salary Book + Noah are the interaction/taste references.
- Non-Salary surfaces should converge toward dense explorer workbenches.
- Optimize for scan speed, predictable interaction, and low-friction pivots.
- Work in **logical chunks** (cohesive flow bundles), not myopic one-class edits.

Guardrails:
- Default: do **not** modify Salary Book files.
- Allowed exception only: `web/app/views/salary_book/_maincanvas_tankathon_frame.html.erb`.
- Do not modify Salary Book controllers/helpers/tests.
- Keep this file active-only: unchecked tasks only.

---

- [ ] [P1] [PROCESS] Tankathon redesign playbook codification — capture directional pick-impact UX rules + evidence workflow
  - Problem: Recent Tankathon redesign succeeded only after multiple directional corrections from user intent; those learnings are easy to lose.
  - Hypothesis: Codifying the flow rules (what users care about, what to highlight, what to suppress) will reduce future churn and improve first-pass quality.
  - Scope (files):
    - `.ralph/DESIGN.md`
    - `agents/design.ts` (prompt/process guidance + artifact path preference)
    - `web/docs/agent_browser_playbook.md` (optional small note on artifact path convention)
  - Acceptance criteria:
    - Process notes capture this sequence explicitly: evidence-first baseline → diagnosis → options → approval → implementation.
    - Tankathon UX rules captured: non-clickable standings rows; no hover affordance for non-actions; directional highlight semantics from selected team perspective; team-column-first pick context.
    - Include explicit artifact path convention: prefer `/tmp/agent-browser/...` over repo-local `tmp/agent-browser/...`.
    - Include a reminder to validate conveyance direction via DB evidence (`pcms.draft_pick_summary_assets` / `pcms.draft_pick_shorthand_assets`) before changing implication UI.
  - Rubric (before → target):
    - Interaction predictability: 3 → 5
    - Navigation/pivots: 3 → 4
    - Process repeatability: 2 → 5
  - Guardrails:
    - Do not modify Salary Book files (except Tankathon exception when task explicitly requires it).

- [ ] [P1] [PROCESS] /web multi-surface baseline audit — establish agent-browser evidence + gap matrix
  - Problem: We do not have a current, shared visual/interaction baseline tied to Salary Book + Noah references, so design work drifts or overfits to tiny edits.
  - Hypothesis: A single baseline pass (before-state snapshots/screenshots + explicit gaps) will anchor taste and enable larger, coherent chunks.
  - Scope (files):
    - `.ralph/DESIGN.md`
    - `web/docs/agent_browser_playbook.md`
    - `web/docs/design_guide.md`
    - `/tmp/agent-browser/design-baseline/*` (artifacts)
  - Acceptance criteria:
    - Baseline captured for routes: `/`, `/ripcity/noah`, `/team-summary`, `/system-values`, `/two-way-utility`, `/players`, `/teams`, `/drafts`.
    - Each baseline route has: fresh `snapshot -i -C -c` output + annotated screenshot.
    - Gap matrix identifies top 5 chunk opportunities (surface, user-flow impact, confidence).
  - Rubric (before → target):
    - Scan speed: 2 → 4
    - Information hierarchy: 3 → 4
    - Interaction predictability: 3 → 4
    - Density/readability: 3 → 4
    - Navigation/pivots: 3 → 4
  - Guardrails:
    - Do not modify Salary Book files.

- [ ] [P1] [TOOL] /team-summary selection-to-sidebar workflow — stabilize row focus, compare context, and overlay return behavior
  - Problem: Team row selection, sidebar drill-in, and return-to-scan behavior can feel fragmented when filters/sorts change mid-analysis.
  - Hypothesis: Tightening the selection → sidebar → back-to-scan loop as one chunk will improve confidence and reduce rescanning.
  - Scope (files):
    - `web/app/views/team_summary/show.html.erb`
    - `web/app/views/team_summary/_workspace_main.html.erb`
    - `web/app/views/team_summary/_rightpanel_base.html.erb`
    - `web/app/views/team_summary/_rightpanel_overlay_team.html.erb`
    - `web/app/controllers/team_summary_controller.rb`
    - `web/app/javascript/team_summary.js`
    - `web/test/integration/tools_team_summary_test.rb`
  - Acceptance criteria:
    - Selected team context survives sort/filter changes when row remains in scope.
    - Sidebar clear/close behavior always returns users to an obvious active row context.
    - Commandbar + maincanvas + sidebar updates keep one-response semantics and stable patch boundaries.
    - agent-browser before/after artifacts show improved predictability for select → drill-in → close loop.
  - Rubric (before → target):
    - Scan speed: 3 → 4
    - Information hierarchy: 4 → 4
    - Interaction predictability: 3 → 5
    - Density/readability: 4 → 4
    - Navigation/pivots: 3 → 4
  - Guardrails:
    - Do not modify Salary Book files.

- [ ] [P1] [TOOL] /system-values metric discovery workflow — unify finder intent, section wayfinding, and overlay continuity
  - Problem: Metric finder, section anchors, and overlay state are strong individually but can desync during rapid query/section changes.
  - Hypothesis: One chunk focused on finder → section jump → overlay continuity will improve trust in exploratory workflows.
  - Scope (files):
    - `web/app/views/system_values/show.html.erb`
    - `web/app/views/system_values/_commandbar.html.erb`
    - `web/app/views/system_values/_workspace_main.html.erb`
    - `web/app/views/system_values/_rightpanel_base.html.erb`
    - `web/app/views/system_values/_rightpanel_overlay_metric.html.erb`
    - `web/app/controllers/system_values_controller.rb`
    - `web/test/integration/tools_system_values_test.rb`
  - Acceptance criteria:
    - Finder query/cursor, active section, and overlay state remain coherent through refresh interactions.
    - Wayfinding cues make active section + selected metric explicit without adding card-heavy UI.
    - Multi-region updates preserve canonical boundaries and deterministic ordering.
    - agent-browser before/after artifacts demonstrate smoother finder-to-overlay flow.
  - Rubric (before → target):
    - Scan speed: 4 → 5
    - Information hierarchy: 4 → 5
    - Interaction predictability: 3 → 5
    - Density/readability: 4 → 4
    - Navigation/pivots: 4 → 5
  - Guardrails:
    - Do not modify Salary Book files.

- [ ] [P2] [TOOL] /two-way-utility intent shortlist to compare loop — reinforce deterministic cursor, pin, and clear semantics
  - Problem: Shortlist intent/cursor, compare pins, and overlay actions are powerful but still vulnerable to subtle state-loss perceptions during rapid iteration.
  - Hypothesis: A coherent chunk focused on shortlist → compare slots → overlay clear/pin behavior will reduce “did the tool lose my place?” moments.
  - Scope (files):
    - `web/app/views/two_way_utility/show.html.erb`
    - `web/app/views/two_way_utility/_commandbar.html.erb`
    - `web/app/views/two_way_utility/_workspace_main.html.erb`
    - `web/app/views/two_way_utility/_rightpanel_base.html.erb`
    - `web/app/views/two_way_utility/_rightpanel_overlay_player.html.erb`
    - `web/app/controllers/two_way_utility_controller.rb`
    - `web/test/integration/tools_two_way_utility_test.rb`
  - Acceptance criteria:
    - Cursor and shortlist intent survive pin/clear actions and overlay transitions when candidate remains valid.
    - Compare slot actions preserve explicit user intent with no hidden resets.
    - Keyboard and click paths produce equivalent outcomes for shortlist/open/pin/clear flows.
    - agent-browser before/after artifacts validate deterministic flow behavior.
  - Rubric (before → target):
    - Scan speed: 4 → 5
    - Information hierarchy: 4 → 4
    - Interaction predictability: 4 → 5
    - Density/readability: 4 → 4
    - Navigation/pivots: 4 → 5
  - Guardrails:
    - Do not modify Salary Book files.

- [ ] [P2] [INDEX] /players commandbar-to-lane triage workflow — improve urgency lens clarity and preserve sidebar drill context
  - Problem: Players index has deep filtering power, but multi-lens triage can still force extra rescans before a confident drill-in.
  - Hypothesis: A chunk that sharpens lens visibility + lane context + drill preservation will speed high-volume triage.
  - Scope (files):
    - `web/app/views/players/index.html.erb`
    - `web/app/views/players/_workspace_main.html.erb`
    - `web/app/views/players/_rightpanel_base.html.erb`
    - `web/app/views/players/_rightpanel_overlay_player.html.erb`
    - `web/app/controllers/players_controller.rb`
    - `web/app/controllers/players_sse_controller.rb`
    - `web/test/integration/entities_players_index_test.rb`
  - Acceptance criteria:
    - Active urgency lenses/sub-lenses are always visible and interpretable while scanning lanes.
    - Sidebar drill-in remains stable across filter changes when selected row is still in scope.
    - Clearing/invalidating selection is explicit and predictable when rows fall out of scope.
    - agent-browser before/after artifacts show faster lane triage with fewer context losses.
  - Rubric (before → target):
    - Scan speed: 4 → 5
    - Information hierarchy: 4 → 5
    - Interaction predictability: 4 → 5
    - Density/readability: 4 → 4
    - Navigation/pivots: 4 → 5
  - Guardrails:
    - Do not modify Salary Book files.

- [ ] [P2] [INDEX] /teams cap-pressure board workflow — strengthen filter discoverability, row comparison cadence, and sidebar persistence
  - Problem: Teams index is dense but long-session comparison can still lose rhythm when toggling between pressure lenses and team drill-ins.
  - Hypothesis: A chunk focused on pressure filter discoverability + comparison cadence + sidebar persistence will improve board-style decision speed.
  - Scope (files):
    - `web/app/views/teams/index.html.erb`
    - `web/app/views/teams/_commandbar.html.erb`
    - `web/app/views/teams/_workspace_main.html.erb`
    - `web/app/views/teams/_rightpanel_base.html.erb`
    - `web/app/views/teams/_rightpanel_overlay_team.html.erb`
    - `web/app/controllers/teams_controller.rb`
    - `web/app/controllers/teams_sse_controller.rb`
    - `web/test/integration/entities_teams_index_test.rb`
  - Acceptance criteria:
    - Pressure/conference controls remain obvious and stateful during dense board scanning.
    - Row-to-sidebar drill loop preserves active comparison context where valid.
    - Keyboard and pointer interactions produce equivalent row selection behavior.
    - agent-browser before/after artifacts confirm improved comparison cadence.
  - Rubric (before → target):
    - Scan speed: 4 → 5
    - Information hierarchy: 4 → 5
    - Interaction predictability: 4 → 5
    - Density/readability: 4 → 4
    - Navigation/pivots: 4 → 5
  - Guardrails:
    - Do not modify Salary Book files.
