<%#
  Local scrollspy nav for entity workspaces.

  locals:
  - sections: Array of [id, label] pairs (or hashes: {id:, label:})
%>

<%
  sections = Array(local_assigns[:sections]).filter_map do |entry|
    if entry.is_a?(Array)
      id = entry[0].to_s.strip
      label = entry[1].to_s.strip
      next if id.blank? || label.blank?
      [id, label]
    elsif entry.is_a?(Hash)
      id = entry[:id].to_s.strip
      label = entry[:label].to_s.strip
      next if id.blank? || label.blank?
      [id, label]
    end
  end
%>

<% if sections.any? %>
  <nav class="hidden lg:block w-48 shrink-0" aria-label="On this page">
    <div class="sticky top-32">
      <ul class="space-y-1 text-xs" data-entity-scrollspy-nav>
        <% sections.each_with_index do |(id, label), idx| %>
          <li>
            <a
              href="#<%= id %>"
              data-entity-scrollspy-link
              data-active="<%= idx.zero? ? 'true' : 'false' %>"
              class="block rounded px-3 py-1.5 text-muted-foreground hover:text-foreground hover:bg-muted/40 transition-colors"
            ><%= label %></a>
          </li>
        <% end %>
      </ul>
    </div>
  </nav>
<% end %>
