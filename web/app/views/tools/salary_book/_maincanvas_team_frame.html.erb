<% boot_error = local_assigns.fetch(:boot_error, nil) %>
<% team_code = local_assigns.fetch(:team_code, nil) %>
<% players = local_assigns.fetch(:players, []) %>
<% cap_holds = local_assigns.fetch(:cap_holds, []) %>
<% exceptions = local_assigns.fetch(:exceptions, []) %>
<% dead_money = local_assigns.fetch(:dead_money, []) %>
<% picks = local_assigns.fetch(:picks, []) %>
<% team_summaries = local_assigns.fetch(:team_summaries, {}) %>
<% team_meta = local_assigns.fetch(:team_meta, {}) %>
<% year = local_assigns.fetch(:year, SalaryBookHelper::SALARY_YEARS.first) %>
<% salary_years = local_assigns.fetch(:salary_years, SalaryBookHelper::SALARY_YEARS) %>
<% empty_message = local_assigns.fetch(:empty_message, "Select a team to view salaries.") %>

<div id="salarybook-team-frame" class="min-h-full">
  <% if boot_error.present? %>
    <div class="p-6">
      <div class="text-sm font-medium text-destructive">Warehouse not available</div>
      <div class="mt-2 text-xs text-muted-foreground">
        Booted Rails, but querying <code>pcms.*</code> failed:
      </div>
      <pre class="mt-3 p-3 rounded-lg bg-muted/30 border border-border/50 text-xs overflow-auto"><%= boot_error %></pre>
    </div>
  <% elsif team_code.blank? %>
    <div class="flex items-center justify-center h-96 text-muted-foreground text-sm px-6 text-center">
      <%= empty_message %>
    </div>
  <% else %>
    <%= render partial: "tools/salary_book/team_section", locals: {
      team_code:,
      players:,
      cap_holds:,
      exceptions:,
      dead_money:,
      picks:,
      team_summaries:,
      team_meta:,
      year:,
      salary_years:
    } %>
  <% end %>
</div>
