summary: Ralph import PCMS data
description: ''
value:
  modules:
    - id: a
      summary: PCMS XML to JSON
      value:
        type: rawscript
        content: '!inline pcms_xml_to_json.inline_script.py'
        input_transforms:
          dry_run:
            type: javascript
            expr: flow_input.dry_run
          s3_key:
            type: javascript
            expr: flow_input.s3_key
        lock: '!inline pcms_xml_to_json.inline_script.lock'
        language: python3
    - id: b
      summary: Lookups
      value:
        type: rawscript
        content: '!inline lookups.inline_script.py'
        input_transforms:
          dry_run:
            type: javascript
            expr: flow_input.dry_run
          extract_dir:
            type: javascript
            expr: '''./shared/pcms'''
        lock: '!inline lookups.inline_script.lock'
        language: python3
    - id: c
      summary: People
      value:
        type: rawscript
        content: '!inline people.inline_script.py'
        input_transforms:
          dry_run:
            type: javascript
            expr: flow_input.dry_run
          extract_dir:
            type: javascript
            expr: '''./shared/pcms'''
        lock: '!inline people.inline_script.lock'
        language: python3
    - id: d
      summary: Contracts
      value:
        type: rawscript
        content: '!inline contracts.inline_script.py'
        input_transforms:
          dry_run:
            type: javascript
            expr: flow_input.dry_run
          extract_dir:
            type: javascript
            expr: '''./shared/pcms'''
        lock: '!inline contracts.inline_script.lock'
        language: python3
    - id: e
      summary: Transactions
      value:
        type: rawscript
        content: '!inline transactions.inline_script.py'
        input_transforms:
          dry_run:
            type: javascript
            expr: flow_input.dry_run
          extract_dir:
            type: javascript
            expr: '''./shared/pcms'''
        lock: '!inline transactions.inline_script.lock'
        language: python3
    - id: f
      summary: League Config
      value:
        type: rawscript
        content: '!inline league_config.inline_script.py'
        input_transforms:
          dry_run:
            type: javascript
            expr: flow_input.dry_run
          extract_dir:
            type: javascript
            expr: '''./shared/pcms'''
        lock: '!inline league_config.inline_script.lock'
        language: python3
    - id: g
      summary: Team Financials
      value:
        type: rawscript
        content: '!inline team_financials.inline_script.py'
        input_transforms:
          dry_run:
            type: javascript
            expr: flow_input.dry_run
          extract_dir:
            type: javascript
            expr: '''./shared/pcms'''
        lock: '!inline team_financials.inline_script.lock'
        language: python3

  same_worker: true
schema:
  $schema: 'https://json-schema.org/draft/2020-12/schema'
  type: object
  order:
    - dry_run
    - s3_key
  properties:
    dry_run:
      type: boolean
      description: Preview changes without writing to DB
      default: false
    s3_key:
      type: string
      description: S3 key for PCMS extract ZIP
      default: pcms/nba_pcms_full_extract.zip
